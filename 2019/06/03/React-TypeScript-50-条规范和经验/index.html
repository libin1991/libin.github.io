<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="React,TypeScript,">










<meta name="description" content="TypeScript 代码整洁之道注释(1) 文件顶部的注释，包括描述、作者、日期12345/** * @description xxxxxx * @author chengfeng * @since 19/05/21 */ (2) 模块的注释123456/** * 拷贝数据 * @param  &amp;#123;*&amp;#125;  data   要拷贝的源数据 * @param  &amp;#123;boole">
<meta name="keywords" content="React,TypeScript">
<meta property="og:type" content="article">
<meta property="og:title" content="React + TypeScript 50 条规范和经验">
<meta property="og:url" content="http://yoursite.com/2019/06/03/React-TypeScript-50-条规范和经验/index.html">
<meta property="og:site_name" content="Zero Days">
<meta property="og:description" content="TypeScript 代码整洁之道注释(1) 文件顶部的注释，包括描述、作者、日期12345/** * @description xxxxxx * @author chengfeng * @since 19/05/21 */ (2) 模块的注释123456/** * 拷贝数据 * @param  &amp;#123;*&amp;#125;  data   要拷贝的源数据 * @param  &amp;#123;boole">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-07-17T16:09:33.287Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="React + TypeScript 50 条规范和经验">
<meta name="twitter:description" content="TypeScript 代码整洁之道注释(1) 文件顶部的注释，包括描述、作者、日期12345/** * @description xxxxxx * @author chengfeng * @since 19/05/21 */ (2) 模块的注释123456/** * 拷贝数据 * @param  &amp;#123;*&amp;#125;  data   要拷贝的源数据 * @param  &amp;#123;boole">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/06/03/React-TypeScript-50-条规范和经验/">





  <title>React + TypeScript 50 条规范和经验 | Zero Days</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband">
    	<div class="eevee"><div class="body"><div class="head"><div class="ears"><div class="ear"><div class="lobe"></div></div><div class="ear"><div class="lobe"></div></div></div><div class="face"><div class="eyes"><div class="eye"><div class="eyelid"></div></div><div class="eye"><div class="eyelid"></div></div></div><div class="nose"></div><div class="mouth"></div></div></div><div class="chest"><div class="fur"><div class="patch"></div></div><div class="fur"><div class="patch"></div></div><div class="fur"><div class="patch"></div></div></div><div class="legs"><div class="leg"><div class="inner-leg"></div></div><div class="leg"><div class="inner-leg"></div></div><div class="leg"><div class="inner-leg"></div></div><div class="leg"><div class="inner-leg"></div></div></div><div class="tail"><div class="tail"><div class="tail"><div class="tail"><div class="tail"><div class="tail -end"></div></div></div></div></div></div></div></div>
    </div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
    	<div id="sky">
				<div id="background" class="container">
			<!-- svg file -->
			<svg id="svgout" height="100%" width="100%" viewbox="0 0 550 400">
				<defs>
					<g id="bottomShadow">
						<path fill="#000000" stroke="none" d="
		M 270.5 225.95
		L 127.35 316.65 266.8 400 409.6 309.25 270.5 225.95 Z"/>
					</g>
					<g id="Layer52_0_FILL">
						<path class="topGrass" fill="#B9D668" stroke="none" d="
	M 397.85 229.3
	L 397.85 225.6 269.85 152 135.75 228.6 135.75 233.65 262.1 306.55 397.85 229.3 Z"/>
					</g>
					<g id="Layer51_0_FILL">
						<path class="leftSideGrass" fill="#6E9E4F" stroke="none" d="
	M 135.1 229.95
	L 135.1 256.85 262.1 328.4 262.1 301.85 135.1 229.95 Z"/>
					</g>
					<g id="Layer50_0_FILL">
						<path class="rightGrassTop" fill="#8CB154" stroke="none" d="
	M 397.85 225.95
	L 395.8 225.95 261.75 301.55 261.75 328.4 397.85 251.15 397.85 225.95 Z"/>
					</g>
					<g id="Layer48_0_FILL">
						<path class="crustLeftTop" fill="#955541" stroke="none" d="
	M 135.45 282.4
	L 135.75 298.15 262.1 372.1 261.75 355.65 135.45 282.4 Z"/>
					</g>
					<g id="Layer47_0_FILL">
						<path class="middleLeftCrust" fill="#C77E61" stroke="none" d="
	M 135.1 270.3
	L 135.1 283.05 275.9 364.35 271.85 348.9 135.1 270.3 Z"/>
					</g>
					<g id="Layer46_0_FILL">
						<path class="crustLeftTop" fill="#955541" stroke="none" d="
	M 135.1 255.15
	L 135.1 270.3 262.1 343.55 262.1 328.05 135.1 255.15 Z"/>
					</g>
					<g id="Layer45_0_FILL">
						<path class="topRightCrust" fill="#A47237" stroke="none" d="
	M 397.5 294.5
	L 397.5 277 261.75 355.3 261.75 372.75 397.5 294.5 Z"/>
					</g>
					<g id="Layer44_0_FILL">
						<path class="middleRightCrust" fill="#C89451" stroke="none" d="
	M 397.5 269.95
	L 397.15 266.6 262.1 343.2 262.1 355.95 397.5 279.7 397.5 269.95 Z"/>
					</g>
					<g id="Layer43_0_FILL">
						<path class="topRightCrust" fill="#A47237" stroke="none" d="
	M 397.5 266.6
	L 397.5 250.45 261.75 328.4 261.75 343.85 397.5 266.6 Z"/>
					</g>
					<g id="Layer41_0_FILL">
						<path class="greyRoad" fill="#B2B2B1" stroke="none" d="
	M 295.05 283.05
	Q 299.05 280.35 308.45 275.3 317.85 269.95 323.6 266.9
	L 268.8 233.65 338.05 191.35 309.15 174.55 177.75 254.5
	Q 191.55 262.2 198.25 266.25 204.65 269.95 209.7 271.95
	L 241.6 250.45 295.05 283.05 Z"/>
					</g>
					<g id="Layer40_0_FILL">
						<path fill="#FFFFFF" stroke="none" d="
	M 199.95 256.85
	Q 194.55 261.2 191.9 262.2
	L 194.9 263.9 200.95 259.2 199.95 256.85
	M 225.8 243.75
	L 224.8 241.75 211.05 250.8 212.05 252.8 225.8 243.75
	M 308.15 275.65
	L 296.7 266.6 295.35 268.6 306.8 277.7 308.15 275.65
	M 275.9 253.5
	L 274.55 255.5 285.95 264.55 287.3 262.55 275.9 253.5
	M 251.7 227.3
	L 250.7 225.25 236.9 234.35 237.9 236.35 251.7 227.3
	M 257.05 240.7
	L 254.05 240.7 268.8 249.8 269.5 247.75 257.05 240.7
	M 277.2 207.8
	L 263.45 216.85 264.45 218.9 278.25 209.8 277.2 207.8
	M 305.1 192.65
	L 304.1 190.65 290.3 199.75 291.35 201.75 305.1 192.65 Z"/>
					</g>
					<g id="Layer38_0_FILL">
						<path class="frontFascia" fill="#ECB27B" stroke="none" d="
	M 359.25 187.95
	L 346.4 174.95 333.85 202.9 359.25 187.95 Z"/>
					</g>
					<g id="Layer37_0_FILL">
						<path class="frontWall" fill="#EFA258" stroke="none" d="
	M 334 201.05
	L 334.35 232 359.2 217.55 359.25 187.95 334 201.05 Z"/>
					</g>
					<g id="Layer36_0_FILL">
						<path class="leftWall" fill="#C57F42" stroke="none" d="
	M 334.35 232.3
	L 334.35 205.1 305.1 191.35 305.1 216.85 334.35 232.3 Z"/>
					</g>
					<g id="Layer35_0_FILL">
						<path class="rightRoof" fill="#EF4427" stroke="none" d="
	M 329.7 167.9
	L 331.05 167.9 344.55 176.7 347.85 176.7 363 192.25 363.15 189.55 350.65 176.7 350.55 176.7 334.25 167.5 334.25 159.1 329.7 159.1 329.7 164.9 322.65 160.95 322.3 162.15 329.7 167 329.7 167.9 Z"/>
					</g>
					<g id="Layer34_0_FILL">
						<path class="leftRoof" fill="#F2563B" stroke="none" d="
	M 334.05 207.05
	L 350.65 176.7 322.1 160.45 302.1 192.05 334.05 207.05 Z"/>
					</g>
					<g id="Layer30_0_FILL">
						<path id="windowFour" class="windows" stroke="none" fill="#975A42" d="
	M 341.35 203.3
	Q 340.9 203.45 340.5 203.8 340.1 204.2 339.85 204.75 339.7 205 339.7 205.3 339.6 205.75 339.7 206.1 339.7 206.15 339.7 206.2 339.8 206.5 340 206.8 340.55 207.4 341.45 207.4 342.35 207.4 343 206.8 343.4 206.5 343.65 206.1 343.85 205.75 343.95 205.3 344.05 204.4 343.55 203.8 343.3 203.45 343 203.3 342.65 203.15 342.2 203.15 341.8 203.15 341.35 203.3
	M 355.85 198.45
	Q 355.8 198.2 355.6 198 355.1 197.4 354.2 197.4 353.35 197.4 352.6 198 351.85 198.65 351.7 199.55 351.7 199.7 351.7 199.85 351.6 200.5 352 201.05 352.55 201.65 353.45 201.65 354.3 201.65 355.05 201.05 355.45 200.7 355.7 200.25 355.8 200.05 355.9 199.85 355.95 199.7 355.95 199.55 356.05 198.95 355.85 198.45 Z"/>
						<path class="door" fill="#B65041" stroke="none" d="
	M 351.95 211.2
	L 351.8 211.2 346.05 215.1 346.05 225.2 351.95 221.6 351.95 211.2
	M 351.2 211.2
	L 351.35 211.2 351.35 211.1 351.2 211.2 Z"/>
					</g>
					<g>
						<path id="Layer30_0_FILL" fill="#000000" fill-opacity="1" stroke="none" d="
	M 183.7 215.3
	L 183.7 215.6
	Q 187.25 231.75 212.25 234.35
	L 183.7 215.3 Z"/>
					</g>
					<g id="Layer29_0_FILL">
						<path fill="#000000" fill-opacity="0.4" stroke="none" d="
	M 305.1 216.85
	L 305.15 217.2
	Q 309.45 233.2 334.35 232.3
	L 305.1 216.85 Z"/>
					</g>
					<g id="Layer27_0_FILL">
						<path class="vegetation" fill="#78A950" stroke="none" d="
	M 177.45 231.65
	Q 175.75 235.35 181.8 239.35 185.5 235.7 185.15 231.3 182.8 230.65 181.45 234 179.45 231.3 177.45 231.65
	M 236.9 266.6
	Q 235.2 270.3 241.25 274.3 244.95 270.6 244.65 266.25 242.3 265.6 240.95 268.95 238.9 266.25 236.9 266.6
	M 254.7 277
	Q 253.05 280.7 259.1 284.75 262.75 281.05 262.45 276.65 260.1 276 258.75 279.35 256.7 276.65 254.7 277
	M 315.5 245.75
	Q 313.5 243.05 311.5 243.4 309.8 247.1 315.85 251.15 319.55 247.45 319.2 243.05 316.85 242.4 315.5 245.75
	M 295.35 232.65
	Q 293.7 236.35 299.75 240.4 303.45 236.7 303.1 232.3 300.75 231.65 299.4 235 297.4 232.3 295.35 232.65
	M 277.2 171.85
	Q 275.55 175.55 281.6 179.55 285.3 175.85 284.95 171.5 282.6 170.85 281.25 174.2 279.25 171.5 277.2 171.85 Z"/>
					</g>
					<g id="Layer26_0_FILL">
						<path class="treeWood" fill="#AE663D" stroke="none" d="
	M 175.1 177.55
	L 172.05 177.55 172.05 191.1 159.3 172.85
	Q 154.6 171.5 172.05 195.7
	L 172.05 212.5 175.1 212.5 175.1 177.55
	M 252.7 151.35
	L 249 151.35 249 176.9 252.7 176.9 252.7 151.35 Z"/>
					</g>
					<g id="Layer25_0_FILL">
						<path class="vegetation" fill="#77A951" stroke="none" d="
	M 192.55 179.55
	Q 200.95 173.5 200.95 165.1 200.95 156.4 192.55 150 184.15 144.3 172.05 144.3 160.3 144.3 151.9 150 143.15 156.4 143.15 165.1 143.15 173.5 151.9 179.55 160.3 185.95 172.05 185.95 184.15 185.95 192.55 179.55
	M 236.25 106.65
	Q 230.2 116.05 230.2 129.15 230.2 142.25 236.25 151.35 242.3 160.75 250.7 160.75 258.75 160.75 264.8 151.35 270.85 142.25 270.85 129.15 270.85 116.05 264.8 106.65 258.75 97.6 250.7 97.6 242.3 97.6 236.25 106.65 Z"/>
					</g>
					<g id="Layer24_0_FILL">
						<path class="vegetation" fill="#77A951" stroke="none" d="
	M 158.3 221.9
	Q 160.65 221.9 161.95 220.2 163 219.55 163.3 218.55 164.65 218.9 166.35 218.9 170.05 218.9 172.4 216.2 175.1 213.85 175.1 210.15 175.1 206.45 172.4 203.75 170.05 201.4 166.35 201.4 162.65 201.4 159.95 203.75 157.6 206.45 157.6 210.15 157.6 210.8 157.6 211.15 155.95 211.5 154.6 212.5 152.9 214.15 152.9 216.55 152.9 218.9 154.6 220.2 156.25 221.9 158.3 221.9
	M 338.35 240.05
	Q 341.05 237.7 341.05 234 341.05 230.3 338.35 227.6 336 225.25 332.3 225.25 328.65 225.25 325.95 227.6 323.6 230.3 323.6 234 323.6 237.7 325.95 240.05 328.65 242.75 332.3 242.75 336 242.75 338.35 240.05 Z"/>
					</g>
					<g id="Layer22_0_FILL">
						<path class="rightRoof" fill="#D05041" stroke="none" d="
	M 220 173.85
	L 236.8 186.7 264.35 171.15 244.5 159.55 220 173.85 Z"/>
					</g>
					<g id="Layer21_0_FILL">
						<path class="leftWall" fill="#C57F42" stroke="none" d="
	M 212.25 191.35
	L 183.35 172.3 183.7 215.3 212.25 234.35 212.25 191.35 Z"/>
					</g>
					<g id="Layer20_0_FILL">
						<path class="rightRoof" fill="#EF4427" stroke="none" d="
	M 192.1 149.85
	L 236.45 174.8 243.1 171.4
	Q 220.05 150.55 196.3 139.95
	L 192.1 149.85 Z"/>
					</g>
					<g id="Layer19_0_FILL">
						<path class="frontFascia" fill="#EBB17B" stroke="none" d="
	M 226.85 160.95
	L 212 190.6 229.75 192.6 239.75 172.85 226.85 160.95 Z"/>
					</g>
					<g id="Layer18_0_FILL">
						<path class="frontWall" fill="#EFA258" stroke="none" d="
	M 240.15 172.65
	L 211.9 191.6 212.25 233.65 264.35 201.7 264.35 170.8 240.8 184.45 240.15 172.65 Z"/>
					</g>
					<g id="Layer17_0_FILL">
						<path class="rightRoof" fill="#EF4427" stroke="none" d="
	M 210.9 142.2
	L 205.9 142.2 205.9 152.65 210.9 152.65 210.9 142.2 Z"/>
					</g>
					<g>
						<path id="Layer16_0_FILL" class="leftRoof" fill="#F2563B" stroke="none" d="
	M 210.25 195.5
	L 227.4 160.95 195.45 141.35 177.65 175.85 210.25 195.5 Z"/>
					</g>
					<g>
						<path id="sun" fill="#E3BD0E" stroke="none" d="
	M 257.05 15.95
	Q 251.7 15.95 248 19.65 244.3 23.35 244.3 28.7 244.3 34.1 248 37.8 251.7 41.5 257.05 41.5 262.45 41.5 266.15 37.8 269.85 34.1 269.85 28.7 269.85 23.35 266.15 19.65 262.45 15.95 257.05 15.95 Z"/>
					</g>
					<g id="Layer8_0_FILL">
						<path fill="#975A42" stroke="none" d="
	M 238.45 189.65
	Q 238.295703125 189.362109375 238.05 189.1 237.35 188.3 236.2 188.3 235.05 188.3 234.15 189.1 233.3 189.9 233.2 191.05 233.1 192.2 233.8 193 234.55 193.8 235.7 193.8 236.85 193.8 237.7 193 238.1970703125 192.558203125 238.45 192 238.6552734375 191.56484375 238.7 191.05 238.7671875 190.276953125 238.45 189.65
	M 220.55 197.55
	Q 220 197.55 219.5 197.75 218.95 197.95 218.5 198.35 217.933203125 198.8833984375 217.7 199.55 217.5833984375 199.916796875 217.55 200.3 217.4923828125 200.96171875 217.7 201.5 217.852734375 201.9103515625 218.15 202.25 218.95 203.05 220.1 203.05 221.25 203.05 222.05 202.25 222.95 201.45 223.05 200.3 223.15 199.15 222.4 198.35 222.05 197.95 221.65 197.75 221.15 197.55 220.55 197.55 Z"/>
					</g>
					<g id="Layer7_0_FILL">
						<path class="door" fill="#B65041" stroke="none" d="
	M 233.55 206.75
	L 225.9 211.95 226.25 225.5 233.95 220.35 233.55 206.75 Z"/>
					</g>
					<g>
						<path id="windowOne" class="windows" fill="#975A42" stroke="none" d="
	M 188.65 198.4
	L 188.8 204.1 198.65 210.45 198.55 204.75 188.65 198.4
	M 208.45 216.8
	L 208.35 211.1 198.55 204.75 198.65 210.45 208.45 216.8
	M 188.8 204.1
	L 188.95 209.8 198.8 216.15 198.65 210.45 188.8 204.1
	M 208.6 222.5
	L 208.45 216.8 198.65 210.45 198.8 216.15 208.6 222.5 Z"/>
					</g>
					<g>
						<path id="windowThree" class="windows" fill="#975A42" stroke="none" d="
	M 311.7 214.1
	L 318.55 217.55 318.45 211.9 311.6 208.45 311.7 214.1
	M 325.4 221
	L 325.25 215.35 318.45 211.9 318.55 217.55 325.4 221
	M 318.4 206.2
	L 311.5 202.75 311.6 208.45 318.45 211.9 318.4 206.2
	M 325.25 215.35
	L 325.2 209.7 318.4 206.2 318.45 211.9 325.25 215.35 Z"/>
					</g>
					<g id="Layer2_0_FILL">
						<path class="door" fill="#B65041" stroke="none" d="
	M 259.7 183.25
	L 244.6 191.9 244.6 213.8 259.7 204.55 259.7 183.25 Z"/>
					</g>
					<path id="windowTwo" fill="#975A42" class="windows" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" d="
	M 223.05 200.3
	Q 222.95 201.45 222.05 202.25 221.25 203.05 220.1 203.05 218.95 203.05 218.15 202.25 217.852734375 201.9103515625 217.7 201.5 217.4923828125 200.96171875 217.55 200.3 217.5833984375 199.916796875 217.7 199.575 217.933203125 198.8833984375 218.5 198.35 218.95 197.95 219.5 197.75 220 197.55 220.55 197.55 221.15 197.55 221.65 197.75 222.05 197.95 222.4 198.35 223.15 199.15 223.05 200.3 Z
	M 238.7 191.05
	Q 238.6552734375 191.56484375 238.45 192 238.1970703125 192.558203125 237.7 193 236.85 193.8 235.7 193.8 234.55 193.8 233.8 193 233.1 192.2 233.2 191.05 233.3 189.9 234.15 189.1 235.05 188.3 236.2 188.3 237.35 188.3 238.05 189.1 238.295703125 189.362109375 238.45 189.65 238.7671875 190.276953125 238.7 191.05 Z"/>
					<path fill="#F2563B" stroke="none" d=" M 351.95 211.2 L 351.8 211.2 346.05 215.1 346.05 225.2 351.95 221.6 351.95 211.2 Z"/>
					<path id="Layer6_0_1_STROKES" class="windowRims" stroke="#AE663D" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" fill="none" d="
	M 198.55 204.75
	L 208.35 211.1 208.45 216.8 208.6 222.5 198.8 216.15 188.95 209.8 188.8 204.1 188.65 198.4 198.55 204.75 198.65 210.45 208.45 216.8
	M 198.8 216.15
	L 198.65 210.45 188.8 204.1"/>
					<path id="Layer5_0_1_STROKES" class="windowRims" stroke="#AE663D" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" fill="none" d="
	M 325.25 215.35
	L 325.4 221 318.55 217.55 311.7 214.1 311.6 208.45 311.5 202.75 318.4 206.2 325.2 209.7 325.25 215.35 318.45 211.9 318.55 217.55
	M 318.4 206.2
	L 318.45 211.9 311.6 208.45"/>
				</defs>
				<g id="shadow">
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use xlink:href="#bottomShadow"/>
					</g>
				</g>
				<g transform="matrix( 1, 0, 0, 1, 0,0) ">
					<use xlink:href="#sun"/>
				</g>
				<g id="earth">
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer52_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer51_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer50_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer48_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer47_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer46_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer45_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer44_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer43_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer41_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer40_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer38_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer37_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer36_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer35_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer34_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#windowFour"/>
						<use class="element" xlink:href="#Layer32_0_1_STROKES"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer30_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer27_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer26_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer25_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer24_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer22_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer21_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer20_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer19_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer18_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer17_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer16_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer8_0_FILL"/>
						<use class="element" xlink:href="#windowTwo"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer7_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#windowOne"/>
						<use class="element" xlink:href="#Layer6_0_1_STROKES"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#windowThree"/>
						<use class="element" xlink:href="#Layer5_0_1_STROKES"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer2_0_FILL"/>
					</g>
				</g>
			</svg>
			<! -- End of SVG file -->
			<! -- Moon/Sun Toggle -->
			<div id="toggleButton" class="day-toggle">
				<div class="sun-icon"></div>
				<label class="switch">
            <input id="toggleCheckbox" type="checkbox">
            <div class="slider"></div>
        </label>
				<div class="cloud-icon"></div>
			</div>
			<! -- Moon/Sun Toggle -->
			<! -- End of Container -->
		</div>
			</div>
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Zero Days</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">人生如逆旅    我亦是行人</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/03/React-TypeScript-50-条规范和经验/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李斌">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/tx.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zero Days">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">React + TypeScript 50 条规范和经验</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-03T22:08:44+08:00">
                2019-06-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="TypeScript-代码整洁之道"><a href="#TypeScript-代码整洁之道" class="headerlink" title="TypeScript 代码整洁之道"></a><a href="https://juejin.im/post/5cfb2b4951882576be276247" target="_blank" rel="noopener">TypeScript 代码整洁之道</a></h3><h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><h4 id="1-文件顶部的注释，包括描述、作者、日期"><a href="#1-文件顶部的注释，包括描述、作者、日期" class="headerlink" title="(1) 文件顶部的注释，包括描述、作者、日期"></a>(1) 文件顶部的注释，包括描述、作者、日期</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @description xxxxxx</span></span><br><span class="line"><span class="comment"> * @author chengfeng</span></span><br><span class="line"><span class="comment"> * @since 19/05/21</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>
<h4 id="2-模块的注释"><a href="#2-模块的注释" class="headerlink" title="(2) 模块的注释"></a>(2) 模块的注释</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 拷贝数据</span></span><br><span class="line"><span class="comment"> * @param  &#123;*&#125;  data   要拷贝的源数据</span></span><br><span class="line"><span class="comment"> * @param  &#123;boolean&#125; [isDeep=false] 是否深拷贝，默认浅拷贝</span></span><br><span class="line"><span class="comment"> * @return &#123;*&#125;         返回拷贝后的数据</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>
<h4 id="3-业务代码注释"><a href="#3-业务代码注释" class="headerlink" title="(3) 业务代码注释"></a>(3) 业务代码注释</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/*业务代码注释*/</span><br></pre></td></tr></table></figure>
<h4 id="4-变量注释"><a href="#4-变量注释" class="headerlink" title="(4) 变量注释"></a>(4) 变量注释</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> IState &#123;</span><br><span class="line">  <span class="comment">// 名字</span></span><br><span class="line">  name: <span class="built_in">string</span>;</span><br><span class="line">  <span class="comment">// 电话</span></span><br><span class="line">  phone: <span class="built_in">number</span>;</span><br><span class="line">  <span class="comment">// 地址</span></span><br><span class="line">  address: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="引用组件顺序"><a href="#引用组件顺序" class="headerlink" title="引用组件顺序"></a>引用组件顺序</h3><ul>
<li>先引用外部组件库,再引用当前组件块级组件, 然后是 common 里的公共函数库最后是 css 样式,加空行</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> React <span class="keyword">from</span><span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Dropdown, Menu, Icon &#125; <span class="keyword">from</span><span class="string">'antd'</span>;</span><br><span class="line"><span class="keyword">import</span> Header <span class="keyword">from</span><span class="string">'./Header'</span>;</span><br><span class="line"><span class="keyword">import</span> toast <span class="keyword">from</span><span class="string">'common/toast'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span><span class="string">'./index.less'</span>;</span><br></pre></td></tr></table></figure>
<h3 id="引号"><a href="#引号" class="headerlink" title="引号"></a>引号</h3><ul>
<li>使用单引号,或者 es6 的反引号</li>
</ul>
<h3 id="缩进"><a href="#缩进" class="headerlink" title="缩进"></a>缩进</h3><ul>
<li>使用两个空格</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> handleCheck = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  onCancel &amp;&amp; onCancel();</span><br><span class="line">  onClose &amp;&amp; onClose();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="分号"><a href="#分号" class="headerlink" title="分号"></a>分号</h3><ul>
<li>除了代码块的以外的每个表达式后必须加分号。</li>
</ul>
<h3 id="括号"><a href="#括号" class="headerlink" title="括号"></a>括号</h3><p>下列关键字后必须有大括号（即使代码块的内容只有一行）：if, else, for, while, do, switch, try, catch, finally, with。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// not good</span></span><br><span class="line"><span class="keyword">if</span> (condition) doSomething();</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">if</span> (condition) &#123;</span><br><span class="line">  doSomething();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="空格"><a href="#空格" class="headerlink" title="空格"></a>空格</h3><ul>
<li>二元和三元运算符两侧必须有一个空格，一元运算符与操作对象之间不允许有空格。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line">++ x;</span><br><span class="line">y ++;</span><br><span class="line">z = x?<span class="number">1</span>:<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line">++x;</span><br><span class="line">y++;</span><br><span class="line">z = x ? <span class="number">1</span> : <span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>用作代码块起始的左花括号 { 前必须有一个空格。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">if</span> (condition)&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (condition)&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">funcName</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">if</span> (condition) &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (condition) &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">funcName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>if / else / for / while / function / switch / do / try / catch / finally 关键字后，必须有一个空格。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">if</span>(condition) &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(condition) &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">if</span> (condition) &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (condition) &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<ul>
<li>在对象创建时，属性中的 : 之后必须有空格，: 之前不允许有空格。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    a : <span class="number">1</span>,</span><br><span class="line">    b:<span class="number">2</span>,</span><br><span class="line">    c :<span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    a: <span class="number">1</span>,</span><br><span class="line">    b: <span class="number">2</span>,</span><br><span class="line">    c: <span class="number">3</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="换行"><a href="#换行" class="headerlink" title="换行"></a>换行</h3><ul>
<li>每个独立语句结束后必须换行。</li>
<li>在函数声明、函数表达式、函数调用、对象创建、数组创建、for 语句等场景中，不允许在 , 或 ; 前换行</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    a: <span class="number">1</span></span><br><span class="line">    , <span class="attr">b</span>: <span class="number">2</span></span><br><span class="line">    , <span class="attr">c</span>: <span class="number">3</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> object)</span><br><span class="line"> &#123;</span><br><span class="line">  <span class="keyword">if</span> (object.hasOwnProperty(key)) &#123;</span><br><span class="line">    <span class="keyword">const</span> element = object[key];</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    a: <span class="number">1</span>,</span><br><span class="line">    b: <span class="number">2</span>,</span><br><span class="line">    c: <span class="number">3</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> object) &#123;</span><br><span class="line">  <span class="keyword">if</span> (object.hasOwnProperty(key)) &#123;</span><br><span class="line">    <span class="keyword">const</span> element = object[key];</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>下列关键字后：else, catch, finally 不需要换行</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">if</span> (condition) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">finally</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">if</span> (condition) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="数组、对象"><a href="#数组、对象" class="headerlink" title="数组、对象"></a>数组、对象</h3><ul>
<li>对象属性名不需要加引号；</li>
<li>对象以缩进的形式书写，不要写在一行；</li>
<li>数组最后不要有逗号。</li>
<li>对象最后要有逗号。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> a = &#123;</span><br><span class="line">    <span class="string">'b'</span>: <span class="number">1</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a = &#123;<span class="attr">b</span>: <span class="number">1</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a = &#123;</span><br><span class="line">    b: <span class="number">1</span>,</span><br><span class="line">    c: <span class="number">2</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>,];</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> a = &#123;</span><br><span class="line">    b: <span class="number">1</span>,</span><br><span class="line">    c: <span class="number">2</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br></pre></td></tr></table></figure>
<h3 id="命名"><a href="#命名" class="headerlink" title="命名"></a>命名</h3><ul>
<li>类名: 大驼峰式风格，字母和数字，例如：AbcTest。禁止汉字、特殊符号，禁止非大驼峰式风格。</li>
<li>函数名: 小驼峰式风格，字母和数字，例如：abcTest。禁止汉字、特殊符号，禁止非小驼峰式风格，例如snake_case等。</li>
<li>变量名: 同函数名。</li>
<li>常量: 全大写风格，大写字母、数字和下划线，单词之间以下划线分隔，例如：ABC_TEST。禁止汉字、特殊符号、小写字母。</li>
<li>使用 onXxx 形式作为 props 中用于回调的属性名称。</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> IProps &#123;</span><br><span class="line">  onClose?: <span class="function"><span class="params">()</span> =&gt;</span><span class="built_in">void</span>;</span><br><span class="line">  onOk?: <span class="function">(<span class="params">item: Record&lt;<span class="built_in">string</span>, <span class="built_in">any</span>&gt;</span>) =&gt;</span><span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>组件内的事件函数使用 handle 开头尾,handleCheckBtn。</li>
<li>使用 withXxx 形式的词作为高阶组件的名称。</li>
<li>接口命名前面带上 I 表示 interface</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> IProps &#123;&#125;</span><br><span class="line"><span class="keyword">interface</span> IState &#123;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="类型断言"><a href="#类型断言" class="headerlink" title="类型断言"></a>类型断言</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getLength</span>(<span class="params">something: <span class="built_in">string</span> | <span class="built_in">number</span></span>): <span class="title">number</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> something.length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// index.ts(2,22): error TS2339: Property 'length' does not exist on type 'string | number'.</span></span><br><span class="line"><span class="comment">//   Property 'length' does not exist on type 'number'.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// bad </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getLength</span>(<span class="params">something: <span class="built_in">string</span> | <span class="built_in">number</span></span>): <span class="title">number</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ((&lt;<span class="built_in">string</span>&gt;something).length) &#123;</span><br><span class="line">        <span class="keyword">return</span> (&lt;<span class="built_in">string</span>&gt;something).length;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> something.toString().length;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getLength</span>(<span class="params">something: <span class="built_in">string</span> | <span class="built_in">number</span></span>): <span class="title">number</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> something === <span class="string">'string'</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> something.length;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> something.toString().length;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="interface声明顺序"><a href="#interface声明顺序" class="headerlink" title="interface声明顺序"></a>interface声明顺序</h3><p>日常用到比较多的是四种，只读参数放第一位，必选参数第二位，可选参数次之，不确定参数放最后<br><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> iProps &#123;</span><br><span class="line">  readonly x: <span class="built_in">number</span>;</span><br><span class="line">  readonly y: <span class="built_in">number</span>;</span><br><span class="line">  name: <span class="built_in">string</span>;</span><br><span class="line">  age: <span class="built_in">number</span>;</span><br><span class="line">  height?: <span class="built_in">number</span>;</span><br><span class="line">  [propName: <span class="built_in">string</span>]: <span class="built_in">any</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="ts好用的相关工具泛型"><a href="#ts好用的相关工具泛型" class="headerlink" title="ts好用的相关工具泛型"></a>ts好用的相关工具泛型</h3><ul>
<li>Record&lt;string,any&gt; 用这个来声明对象结构的类型</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用于定义一个javascript的对象，key是字符串，value是任意类型</span></span><br><span class="line"> <span class="keyword">const</span> people:Record&lt;<span class="built_in">string</span>,<span class="built_in">any</span>&gt; = &#123;</span><br><span class="line">     name: <span class="string">'chengfeng'</span>,</span><br><span class="line">     age: <span class="number">10</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Partial 作用是将传入的属性变为可选项.</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> iPeople &#123;</span><br><span class="line">    title: <span class="built_in">string</span>;</span><br><span class="line">    name: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> people: Partial&lt;Todo&gt; = &#123;</span><br><span class="line">    title: <span class="string">'Delete inactive users'</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//定义的结构可以是接口iPeople的任意key</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Readonly 作用是将传入的属性变为变成只读</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> iPeople &#123;</span><br><span class="line">    title: <span class="built_in">string</span>;</span><br><span class="line">    name: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> people: Readonly&lt;Todo&gt; = &#123;</span><br><span class="line">    title: <span class="string">'todo list'</span>,</span><br><span class="line">    name: chenfeng;</span><br><span class="line">&#125;;</span><br><span class="line">title name属性就是只读的了</span><br></pre></td></tr></table></figure>
<ul>
<li>Required 的作用是将传入的属性变为必选项</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> iPeople &#123;</span><br><span class="line">    title?: <span class="built_in">string</span>;</span><br><span class="line">    name?: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> people1: Props = &#123; title: <span class="string">'ts'</span> &#125;; <span class="comment">// OK</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> people22: Required&lt;iPeople&gt; = &#123; title: <span class="string">'ts'</span> &#125;; <span class="comment">// Error: property 'name' missing</span></span><br></pre></td></tr></table></figure>
<p><a href="https://link.juejin.im?target=https%3A%2F%2Fgithub.com%2FMicrosoft%2FTypeScript-Handbook%2Fdiffs%2F0%3Fbase_sha%3D22b37a2d8c9a1dd378795444baf954c2e7ecccf5%26commentable%3Dtrue%26head_user%3Dcsantos42%26pull_number%3D801%26sha1%3D22b37a2d8c9a1dd378795444baf954c2e7ecccf5%26sha2%3D9d4c56f5d414dbe23780719885baa3df40222412%26short_path%3D0b2da51%26unchanged%3Dexpanded%26utf8%3D%25E2%259C%2593%23requiredt" target="_blank" rel="noopener">查看更多</a></p>
<h3 id="ts一些好用的小tips"><a href="#ts一些好用的小tips" class="headerlink" title="ts一些好用的小tips"></a>ts一些好用的小tips</h3><ul>
<li>keyof</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> iPeople &#123;</span><br><span class="line">  name: <span class="built_in">string</span>;</span><br><span class="line">  age: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> T = keyof iPeople <span class="comment">// -&gt; "name" | "age"</span></span><br></pre></td></tr></table></figure>
<ul>
<li>in</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Keys = <span class="string">"a"</span> | <span class="string">"b"</span></span><br><span class="line"><span class="keyword">type</span> Obj =  &#123;</span><br><span class="line">  [p <span class="keyword">in</span> Keys]: <span class="built_in">any</span></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">// -&gt; &#123; a: any, b: any &#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="规范其他"><a href="#规范其他" class="headerlink" title="规范其他"></a>规范其他</h3><ul>
<li>不要使用 var 声明变量</li>
<li>不会被修改的变量使用 const 声明</li>
<li>去除声明但未被引用的代码</li>
<li>禁止在代码里使用 debug</li>
<li>不允许有空的代码块</li>
</ul>
<h3 id="仅当初始-state-需要从-props-计算得到的时候，才将-state-的声明放在构造函数中，其它情况下使用静态属性声明-state-并且一般情况下不要将-prop-传给-state，"><a href="#仅当初始-state-需要从-props-计算得到的时候，才将-state-的声明放在构造函数中，其它情况下使用静态属性声明-state-并且一般情况下不要将-prop-传给-state，" class="headerlink" title="仅当初始 state 需要从 props 计算得到的时候，才将 state 的声明放在构造函数中，其它情况下使用静态属性声明 state,并且一般情况下不要将 prop 传给 state，"></a>仅当初始 state 需要从 props 计算得到的时候，才将 state 的声明放在构造函数中，其它情况下使用静态属性声明 state,并且一般情况下不要将 prop 传给 state，</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">constructor</span> (<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">this</span>.setState(&#123; people: <span class="keyword">this</span>.props.people &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line">state: IState = &#123;</span><br><span class="line">  people: &#123;&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="渲染默认值"><a href="#渲染默认值" class="headerlink" title="渲染默认值"></a>渲染默认值</h3><ul>
<li>添加非空判断可以提高代码的稳健性,例如后端返回的一些值,可能会出现不存在的情况，应该要给默认值.</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line">render()&#123;</span><br><span class="line">  &#123;name&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line">render()&#123;</span><br><span class="line">  &#123;name || <span class="string">''</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>还有一种情况，就是本来后端应该返回一个数组给你，但是数据库取不到数据，可能后端给你返回了null,然后前端null.length。这样就gg了</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> &#123; list, totalCount &#125; = <span class="keyword">await</span> getPeopleList(keyword, page, pageSize);</span><br><span class="line"><span class="comment">//list 可能是null或者undefined</span></span><br><span class="line"><span class="comment">//list.length将直接导致前端报错</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.setState(&#123;</span><br><span class="line">  status: STATUS.READY,</span><br><span class="line">  apps: list,</span><br><span class="line">  total: totalCount,</span><br><span class="line">  page: page,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// good const &#123; list, totalCount &#125; = await getPeopleList(keyword, page, pageSize);</span></span><br><span class="line"><span class="keyword">this</span>.setState(&#123;</span><br><span class="line">  status: STATUS.READY,</span><br><span class="line">  apps: list || [],</span><br><span class="line">  total: totalCount || <span class="number">0</span>,</span><br><span class="line">  page: page,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="不确定的属性，最后却疯狂的用…访问不存在的属性"><a href="#不确定的属性，最后却疯狂的用…访问不存在的属性" class="headerlink" title="不确定的属性，最后却疯狂的用…访问不存在的属性"></a>不确定的属性，最后却疯狂的用…访问不存在的属性</h3><p>例如一些地方，不确定这个变量里面到底有什么，但自己觉得有，就疯狂的…,最明显的就是后端返回了一个对象给你，前端拿到之后判断都不判断直接data.dataList.forEach()</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> data = <span class="keyword">await</span> getPeopleList(keyword, page, pageSize);</span><br><span class="line">data.dataList.forEach() <span class="comment">// 直接挂了</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> data = <span class="keyword">await</span> getPeopleList(keyword, page, pageSize);</span><br><span class="line"><span class="keyword">if</span> (data &amp;&amp; data.dataList &amp;&amp; <span class="built_in">Array</span>.isArray(data.dataList) &#123;</span><br><span class="line">    data.dataList.forEach() </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="数据格式转换"><a href="#数据格式转换" class="headerlink" title="数据格式转换"></a>数据格式转换</h3><ul>
<li>把字符串转整型可以使用+号</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> maxPrice = +form.maxPrice.value;</span><br><span class="line"><span class="keyword">let</span> maxPrice = <span class="built_in">Number</span>(form.maxPrice.value);</span><br></pre></td></tr></table></figure>
<ul>
<li>转成 boolean 值用!!</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> mobile = !!ua.match(<span class="regexp">/iPhone|iPad|Android|iPod|Windows Phone/</span>);</span><br></pre></td></tr></table></figure>
<h3 id="判断条件真假"><a href="#判断条件真假" class="headerlink" title="判断条件真假"></a>判断条件真假</h3><p>js 中以下为假,其他情况为真</p>
<ul>
<li>false</li>
<li>null</li>
<li>undefined</li>
<li>0</li>
<li>‘’ (空字符串)</li>
<li>NaN</li>
</ul>
<h3 id="简单组件可以使用函数代替"><a href="#简单组件可以使用函数代替" class="headerlink" title="简单组件可以使用函数代替"></a>简单组件可以使用函数代替</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">class</span> Listing <span class="keyword">extends</span> React.Component&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span>&lt;div&gt;&#123;<span class="keyword">this</span>.props.hello&#125;&lt;<span class="regexp">/div&gt;;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ good</span></span><br><span class="line"><span class="regexp">function Listing(&#123; hello &#125;) &#123;</span></span><br><span class="line"><span class="regexp">  return&lt;div&gt;&#123;hello&#125;&lt;/</span>div&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="对于常用的属性进行缓存"><a href="#对于常用的属性进行缓存" class="headerlink" title="对于常用的属性进行缓存"></a>对于常用的属性进行缓存</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">this</span>.props.app.openid;</span><br><span class="line"><span class="keyword">this</span>.state.time</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> &#123; app &#125; = <span class="keyword">this</span>.props;</span><br><span class="line"><span class="keyword">const</span> &#123; time &#125; = <span class="keyword">this</span>.state;</span><br><span class="line"><span class="built_in">console</span>.log(app.openid)</span><br></pre></td></tr></table></figure>
<h3 id="input-输入框使用-trim"><a href="#input-输入框使用-trim" class="headerlink" title="input 输入框使用 trim()"></a>input 输入框使用 trim()</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">let</span> searchContent = form.search.value;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">let</span> searchContent = form.search.value.trim();</span><br></pre></td></tr></table></figure>
<h3 id="使用-location-跳转前需要先转义"><a href="#使用-location-跳转前需要先转义" class="headerlink" title="使用 location 跳转前需要先转义"></a>使用 location 跳转前需要先转义</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="built_in">window</span>.location.href = redirectUrl + <span class="string">'?a=10&amp;b=20'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="built_in">window</span>.location.href = redirectUrl + <span class="built_in">encodeURIComponent</span>(<span class="string">'?a=10&amp;b=20'</span>);</span><br></pre></td></tr></table></figure>
<h3 id="使用-react-router"><a href="#使用-react-router" class="headerlink" title="使用 react-router"></a>使用 react-router</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">import</span> &#123; withRouter, RouteComponentProps &#125; <span class="keyword">from</span><span class="string">'react-router-dom'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> IProps <span class="keyword">extends</span> RouteComponentProps&lt;any&gt; &#123;&#125;</span><br><span class="line"><span class="keyword">class</span> App <span class="keyword">extends</span> React.Component&lt;IProps, AppStates&gt; &#123;&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> withRouter(App);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">import</span> &#123; withRouter, RouteComponentProps &#125; <span class="keyword">from</span><span class="string">'react-router-dom'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> App <span class="keyword">extends</span> React.Component&lt;IProps &amp; RouteComponentProps&lt;&#123;&#125;&gt;, AppStates&gt; &#123;&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> withRouter(App);</span><br></pre></td></tr></table></figure>
<h3 id="同时开发，数据请求-api-目录-git-冲突目录方案"><a href="#同时开发，数据请求-api-目录-git-冲突目录方案" class="headerlink" title="同时开发，数据请求 api 目录 git 冲突目录方案"></a>同时开发，数据请求 api 目录 git 冲突目录方案</h3><ul>
<li>在 api 目录下新建一个目录，目录对应一级 tab,这个目录内放置一个 index.js ，最后把二级 tab 组件所使用的 api 请求都在这个 index.js 内引入。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 目前</span></span><br><span class="line"></span><br><span class="line">|- api</span><br><span class="line">  |- pageA.ts</span><br><span class="line">  |- pageB.ts</span><br><span class="line"></span><br><span class="line"><span class="comment">// 建议</span></span><br><span class="line"></span><br><span class="line">|- api</span><br><span class="line">  |- pageA</span><br><span class="line">    |- index.js</span><br><span class="line">    |- aaa.js</span><br><span class="line">    |- bbb.js</span><br><span class="line">  |- pageB</span><br><span class="line">    |- index.js</span><br><span class="line">    |- aaa.js</span><br><span class="line">    |- bbb.js</span><br><span class="line">    |- ccc.js</span><br></pre></td></tr></table></figure>
<h3 id="组件嵌套过深"><a href="#组件嵌套过深" class="headerlink" title="组件嵌套过深"></a>组件嵌套过深</h3><ul>
<li>组件一般不要超过三层,最多四层,层级过深可能会导致数据传递过深，在做一些颗粒度比较细的操作的时候，处理起来较为繁琐，可以使用 redux 等状态管理工具替代。</li>
</ul>
<h3 id="代码过滤掉你没考虑到的情况"><a href="#代码过滤掉你没考虑到的情况" class="headerlink" title="代码过滤掉你没考虑到的情况"></a>代码过滤掉你没考虑到的情况</h3><ul>
<li>例如一个函数，你只想操作字符串，那你必须在函数开头就只允许参数是字符串</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parse</span> (<span class="params">str:string</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span>(str) === <span class="string">'string'</span> ) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="业务代码里面的异步请求需要-try-catch"><a href="#业务代码里面的异步请求需要-try-catch" class="headerlink" title="业务代码里面的异步请求需要 try catch"></a>业务代码里面的异步请求需要 try catch</h3><ul>
<li>ajax 请求，使用 try catch，错误提示后端返回,并且做一些失败后的状态操作例如进入列表页，我们需要一个 loading 状态，然后去请求数据,可是失败之后，也需要把 loading 状态去掉,把 loading 隐藏的代码就写在 finally 里面。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">getStudentList = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      loading: <span class="literal">true</span>,</span><br><span class="line">      isEmpty: <span class="literal">false</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">await</span> getStudentList(&#123;&#125;);</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      loading: <span class="literal">false</span>,</span><br><span class="line">      isEmpty: <span class="literal">true</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="comment">// TODO</span></span><br><span class="line">    <span class="built_in">console</span>.log(e)</span><br><span class="line">  &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="comment">//  失败之后的一些兜底操作</span></span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      loading: <span class="literal">false</span>,</span><br><span class="line">      isEmpty: <span class="literal">true</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="setState有三种用法"><a href="#setState有三种用法" class="headerlink" title="setState有三种用法"></a>setState有三种用法</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 对象</span></span><br><span class="line"><span class="keyword">this</span>.setState(&#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数，一般是用于在setState之前做一些操作</span></span><br><span class="line"><span class="keyword">this</span>.setState(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// TODO</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">''</span>)</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      a:<span class="number">300</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二个参数，一般是用于在setState之后做一些操作</span></span><br><span class="line"><span class="keyword">this</span>.setState(&#123;</span><br><span class="line">  a:<span class="number">300</span></span><br><span class="line">&#125;, () =&gt; &#123;</span><br><span class="line">  <span class="comment">// TODO</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="setState可能是同步的"><a href="#setState可能是同步的" class="headerlink" title="setState可能是同步的"></a>setState可能是同步的</h3><ul>
<li>setState 在react里的合成事件和钩子函数中是“异步”的。</li>
<li>setState 在原生事件和 setTimeout 中是同步的。</li>
</ul>
<h3 id="不要在-setState-前面加-await"><a href="#不要在-setState-前面加-await" class="headerlink" title="不要在 setState 前面加 await"></a>不要在 setState 前面加 await</h3><ul>
<li>setState 前面也是可以带 await 的，会变成同步设置状态,但这是一种巧合，不确定未来哪个版本就不支持了，为了遵循 react 框架的设计原则，我们使用回掉函数的形式。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line">func = <span class="keyword">async</span> (name, value, status) =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">    name</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// TODO</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line">func = <span class="function">(<span class="params">name, value, status</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">this</span>.setState(</span><br><span class="line">    &#123;</span><br><span class="line">      name</span><br><span class="line">    &#125;,</span><br><span class="line">    () =&gt; &#123;</span><br><span class="line">      <span class="comment">// TODO</span></span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="阻止事件默认行为"><a href="#阻止事件默认行为" class="headerlink" title="阻止事件默认行为"></a>阻止事件默认行为</h3><ul>
<li>在 React 中你不能通过返回 false 来阻止默认行为。必须明确调用 preventDefault 。</li>
</ul>
<h3 id="在-componentWillUnmount-里面去除副作用的函数"><a href="#在-componentWillUnmount-里面去除副作用的函数" class="headerlink" title="在 componentWillUnmount 里面去除副作用的函数"></a>在 componentWillUnmount 里面去除副作用的函数</h3><ul>
<li>清除 EventListener</li>
<li>中止数据请求</li>
<li>清除定时器</li>
</ul>
<h3 id="key"><a href="#key" class="headerlink" title="key"></a>key</h3><ul>
<li>对于组件中的 key 优化，起到最大化重用 dom</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//bad</span></span><br><span class="line"><span class="keyword">this</span>.state.dataAry.map(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span> /&gt;</span>;</span></span><br><span class="line"><span class="xml">&#125;);</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">//good</span></span><br><span class="line">this.state.dataAry.map(item =&gt; &lt;span key=&#123;item.id&#125; /&gt;);</span><br></pre></td></tr></table></figure>
<h3 id="for-in-中一定要有-hasOwnProperty-的判断（即禁止直接读取原型对象的属性）"><a href="#for-in-中一定要有-hasOwnProperty-的判断（即禁止直接读取原型对象的属性）" class="headerlink" title="for-in 中一定要有 hasOwnProperty 的判断（即禁止直接读取原型对象的属性）"></a>for-in 中一定要有 hasOwnProperty 的判断（即禁止直接读取原型对象的属性）</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//bad</span></span><br><span class="line"><span class="keyword">const</span> arr = [];</span><br><span class="line"><span class="keyword">const</span> key = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">  arr.push(obj[key]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//good</span></span><br><span class="line"><span class="keyword">const</span> arr = [];</span><br><span class="line"><span class="keyword">const</span> key = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">  <span class="keyword">if</span> (obj.hasOwnProperty(key)) &#123;</span><br><span class="line">    arr.push(obj[key]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="第三方库函数的使用"><a href="#第三方库函数的使用" class="headerlink" title="第三方库函数的使用"></a>第三方库函数的使用</h3><ul>
<li>用 try catch 包裹，防止第三方库的出现错误，导致整个程序崩溃</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Echart 用于代绘制图表，但当其自身发生错误时，可能影响到业务代码的执行</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> iniDom = <span class="built_in">document</span>.getElementById(<span class="string">'init-container'</span>);</span><br><span class="line"><span class="keyword">const</span> echartObj = echarts.init(iniDom);</span><br><span class="line"><span class="keyword">this</span>.setState(</span><br><span class="line">  &#123;</span><br><span class="line">    echartObj</span><br><span class="line">  &#125;,</span><br><span class="line">  () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; echartObj &#125; = <span class="keyword">this</span>.state;</span><br><span class="line">    <span class="comment">// 更新图表</span></span><br><span class="line">    echartObj.setOption(CHART_CONFIG, <span class="literal">true</span>);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> iniDom = <span class="built_in">document</span>.getElementById(<span class="string">'init-container'</span>);</span><br><span class="line">  <span class="keyword">const</span> echartObj = echarts.init(iniDom);</span><br><span class="line">  <span class="keyword">this</span>.setState(</span><br><span class="line">    &#123;</span><br><span class="line">      echartObj</span><br><span class="line">    &#125;,</span><br><span class="line">    () =&gt; &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; echartObj &#125; = <span class="keyword">this</span>.state;</span><br><span class="line">      <span class="comment">// 更新图表</span></span><br><span class="line">      echartObj.setOption(CHART_CONFIG, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">  <span class="comment">// TODO</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="防止-xss-攻击"><a href="#防止-xss-攻击" class="headerlink" title="防止 xss 攻击"></a>防止 xss 攻击</h3><ul>
<li>input，textarea 等标签，不要直接把 html 文本直接渲染在页面上,使用 xssb 等过滤之后再输出到标签上;</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; html2text &#125; <span class="keyword">from</span><span class="string">'xss'</span>;</span><br><span class="line">render()&#123;</span><br><span class="line">  &lt;div</span><br><span class="line">  dangerouslySetInnerHTML=&#123;&#123;</span><br><span class="line">    __html: html2text(htmlContent)</span><br><span class="line">  &#125;&#125;</span><br><span class="line">/&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="在组件中获取真实-dom"><a href="#在组件中获取真实-dom" class="headerlink" title="在组件中获取真实 dom"></a>在组件中获取真实 dom</h3><ul>
<li>使用 16 版本后的 createRef()函数</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> MyComponent <span class="keyword">extends</span> React.Component&lt;iProps, iState&gt; &#123;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.inputRef = React.createRef();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span>&lt;inputtype=<span class="string">"text"</span>ref=&#123;<span class="keyword">this</span>.inputRef&#125; /&gt;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="keyword">this</span>.inputRef.current.focus();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="减少魔法数字"><a href="#减少魔法数字" class="headerlink" title="减少魔法数字"></a>减少魔法数字</h3><ul>
<li>写代码的时候尽量减少一些未知含义的数字，尽量用英文单词。例如type === 0的时候做了一些操作，让人不知所以然。</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">type</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="comment">// TODO</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> STATUS: Record&lt;<span class="built_in">string</span>, <span class="built_in">any</span>&gt; = &#123;</span><br><span class="line">  READY: <span class="number">0</span>,</span><br><span class="line">  FETCHING: <span class="number">1</span>,</span><br><span class="line">  FAILED: <span class="number">2</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">type</span> === STATUS.READY) &#123;</span><br><span class="line">  <span class="comment">// TODO</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// best</span></span><br><span class="line"><span class="keyword">enum</span> STATUS &#123;</span><br><span class="line">  <span class="comment">// 就绪</span></span><br><span class="line">  READY = <span class="number">0</span>,</span><br><span class="line">  <span class="comment">// 请求中</span></span><br><span class="line">  FETCHING = <span class="number">1</span>,</span><br><span class="line">  <span class="comment">// 请求失败</span></span><br><span class="line">  FAILED = <span class="number">2</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="如果需要优化-react-性能（一般用不到）"><a href="#如果需要优化-react-性能（一般用不到）" class="headerlink" title="如果需要优化 react 性能（一般用不到）"></a>如果需要优化 react 性能（一般用不到）</h3><ul>
<li>如果组件的 state 和 props 都是简单类型，可以继承 PureComponent 而不是 Component</li>
</ul>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component, PureComponent &#125; <span class="keyword">from</span><span class="string">'react'</span>;</span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">class</span> Message <span class="keyword">extends</span> Component&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span>&lt;span&gt;&#123;<span class="keyword">this</span>.state.message&#125;&lt;<span class="regexp">/span&gt;;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ good</span></span><br><span class="line"><span class="regexp">class Message extends PureComponent&#123;</span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    return&lt;span&gt;&#123;this.state.message&#125;&lt;/</span>span&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>重写 shouldComponentUpdate 方法,在 shouldComponentUpdate 里面根据 state,props 是否有改变来判断是否需要重新渲染.如果组件继承了 PureComponent 就没必要再重写 shouldComponentUpdate 方法</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; isReactPropsEqual, isReactStateEqual &#125; <span class="keyword">from</span><span class="string">'@fe/common/lib/equal'</span>;</span><br><span class="line">shouldComponentUpdate(nextProps:IProps, <span class="attr">nextState</span>:IState) &#123;</span><br><span class="line">    <span class="keyword">if</span> (isReactStateEqual(nextState,<span class="keyword">this</span>.state) &amp;&amp; isReactPropsEqual(nextProps,<span class="keyword">this</span>.props)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Event-事件对象类型"><a href="#Event-事件对象类型" class="headerlink" title="Event 事件对象类型"></a>Event 事件对象类型</h3><p>很多小伙伴用了很久的ts,都不知道常用 Event 事件对象类型：</p>
<p>ClipboardEvent<t = element> 剪贴板事件对象</t></p>
<p>DragEvent<t = element> 拖拽事件对象</t></p>
<p>ChangeEvent<t = element> Change 事件对象</t></p>
<p>KeyboardEvent<t = element> 键盘事件对象</t></p>
<p>MouseEvent<t = element> 鼠标事件对象</t></p>
<p>TouchEvent<t = element> 触摸事件对象</t></p>
<p>WheelEvent<t = element> 滚轮事件对象</t></p>
<p>AnimationEvent<t = element> 动画事件对象</t></p>
<p>TransitionEvent<t = element> 过渡事件对象</t></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; MouseEvent &#125; <span class="keyword">from</span><span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line">interface IProps &#123;</span><br><span class="line">  onClick(event: MouseEvent&lt;HTMLDivElement&gt;): <span class="keyword">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="使用私有属性取代state状态"><a href="#使用私有属性取代state状态" class="headerlink" title="使用私有属性取代state状态"></a>使用私有属性取代state状态</h3><p>对于一些不需要控制ui的状态属性，我们可以直接绑到this上， 即私有属性，没有必要弄到this.state上，不然会触发渲染机制，造成性能浪费<br>例如请求翻页数据的时候,我们都会有个变量。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line">state: IState = &#123;</span><br><span class="line">  pageNo:<span class="number">1</span>,</span><br><span class="line">  pageSize:<span class="number">10</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good </span></span><br><span class="line">queryParams:Record&lt;<span class="built_in">string</span>,<span class="built_in">any</span>&gt; = &#123;</span><br><span class="line">  pageNo:<span class="number">1</span>,</span><br><span class="line">  pageSize:<span class="number">10</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="代码细粒度的思考"><a href="#代码细粒度的思考" class="headerlink" title="代码细粒度的思考"></a>代码细粒度的思考</h3><p>总结四句话。我们在写组件或者函数的的时候，工具函数和业务逻辑抽离，表单校验和业务抽离、事件函数和业务抽离，ajax和业务抽离。<br>例如有些页面是通过location.href跳转的，我们有些业务逻辑等都是放到didmountMount,但是后期改需求，可能要用react-router进行跳转，可能要改的逻辑就会很多了，所以函数抽离出来，需求更新就少改一点代码。<br>如果还不确定如何划分函数的细粒度，我有个建议。使用过两次以上的代码，要抽离组件或者函数，两次的可以不用</p>
<h3 id="if-else-等判断太多了，后期难以维护。"><a href="#if-else-等判断太多了，后期难以维护。" class="headerlink" title="if else 等判断太多了，后期难以维护。"></a>if else 等判断太多了，后期难以维护。</h3><p>个人觉得if else 嵌套深看起来也不会太难受，难受的是，项目迭代久之后，自己都忘记曾经写过这些代码，而且类型多或者不确定有什么类型，是否后期还会加的情况下，改起来就非常复杂了，而且很容易踩坑和背锅。<br>用配置取代if嵌套，大概就是抽离一个config.ts出来，里面放一些配置。</p>
<blockquote>
<p>例如你的业务代码里面，会根据不同url参数，代码会执行不同的逻辑.</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//info?type=wechat&amp;uid=123456&amp;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> qsObj = qs(<span class="built_in">window</span>.location.url)</span><br><span class="line"><span class="keyword">const</span> urlType = qsObj.type</span><br><span class="line"><span class="comment">// bad </span></span><br><span class="line"><span class="keyword">if</span> (urlType === <span class="string">'wechat'</span>) &#123;</span><br><span class="line">    doSomeThing()</span><br><span class="line">&#125; elseif () &#123;</span><br><span class="line">    doSomeThing()</span><br><span class="line">&#125; elseif () &#123;</span><br><span class="line">    doSomeThing()</span><br><span class="line">&#125; elseif () &#123;</span><br><span class="line">    doSomeThing()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good </span></span><br><span class="line">config.t</span><br><span class="line"><span class="keyword">const</span> urlTypeConfig: Record&lt;string, typeItem&gt; = &#123;</span><br><span class="line">  <span class="string">'wechat'</span>: &#123; <span class="comment">// key 就是对应的type</span></span><br><span class="line">    name: <span class="string">'wechat'</span>, </span><br><span class="line">    show: [<span class="string">'header'</span>, <span class="string">'footer'</span>, <span class="string">'wechat'</span>] <span class="comment">// 展示什么，可能是异步的</span></span><br><span class="line">    pession: [<span class="string">'admin'</span>], <span class="comment">// 权限是什么，可能是异步的</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">'zhifubao'</span>: &#123; <span class="comment">// key 就是对应的type</span></span><br><span class="line">    name: <span class="string">'zhifubao'</span>, </span><br><span class="line">    show: [<span class="string">'header'</span>, <span class="string">'footer'</span>, <span class="string">'zhifubao'</span>] <span class="comment">// 展示什么，可能是异步的</span></span><br><span class="line">    pession: [<span class="string">'admin'</span>], <span class="comment">// 权限是什么，可能是异步的</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 业务逻辑</span></span><br><span class="line"><span class="keyword">const</span> qsObj = qs(<span class="built_in">window</span>.location.url)</span><br><span class="line"><span class="keyword">const</span> urlType = qsObj.type</span><br><span class="line">urlTypeConfig.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span>(urlType === item.type) &#123;</span><br><span class="line">    doSomeThing(item.show)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="不要使用renderXXX-要使用函数式组件"><a href="#不要使用renderXXX-要使用函数式组件" class="headerlink" title="不要使用renderXXX,要使用函数式组件"></a>不要使用renderXXX,要使用函数式组件</h3><p>发现团队一些小伙伴为了减少render函数里面的代码量，会把一些元素拆分到函数里面。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line">  renderHeader = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span> /&gt;</span>)</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">  renderBody = () =&gt; &#123;</span></span><br><span class="line"><span class="xml">    return (<span class="tag">&lt;<span class="name">div</span> /&gt;</span>)</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">  renderFooter = () =&gt; &#123;</span></span><br><span class="line"><span class="xml">    return (<span class="tag">&lt;<span class="name">div</span> /&gt;</span>)</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">  render()&#123;</span></span><br><span class="line"><span class="xml">    return(</span></span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        renderHeader()</span><br><span class="line">        renderBody()</span><br><span class="line">        renderFooter()</span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    )</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br></pre></td></tr></table></figure>
<p>更好的办法，是用函数式组件取代在当前组件里面写方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// good</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">RenderHeader</span>(<span class="params">props</span>) =  </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span> /&gt;</span>)</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml"> function RenderBody(props) =  &#123;</span></span><br><span class="line"><span class="xml">    return (<span class="tag">&lt;<span class="name">div</span> /&gt;</span>)</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml"> function RenderFooter(props) =  &#123;</span></span><br><span class="line"><span class="xml">    return (<span class="tag">&lt;<span class="name">div</span> /&gt;</span>)</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line">class Component extends React.Component&lt;iProps, iState&gt;&#123;  </span><br><span class="line">  render () &#123;</span><br><span class="line">    return(</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;RenderHeader /&gt;</span><br><span class="line">        &lt;RenderBody /&gt;</span><br><span class="line">        &lt;RenderFooter /&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="a标签安全问题"><a href="#a标签安全问题" class="headerlink" title="a标签安全问题"></a>a标签安全问题</h3><p>使用a标签打开一个新窗口过程中的安全问题。新页面中可以使用window.opener来控制原始页面。如果新老页面同域，那么在新页面中可以任意操作原始页面。如果是不同域，新页面中依然可以通过window.opener.location，访问到原始页面的location对象</p>
<p>在带有target=”_blank”的a标签中，加上rel=”noopener”属性。如果使用window.open的方式打开页面，将opener对象置为空。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> newWindow = <span class="built_in">window</span>.open();</span><br><span class="line">newWindow.opener = <span class="literal">null</span>;</span><br></pre></td></tr></table></figure>
<h3 id="void-0-替代undefined"><a href="#void-0-替代undefined" class="headerlink" title="void 0 替代undefined"></a>void 0 替代undefined</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">clearSessioin = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">	</span><br><span class="line">  req.session.userName = <span class="literal">undefined</span>;</span><br><span class="line">  </span><br><span class="line">  req.session.userName = <span class="keyword">void</span> <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="前端不要操作cookie"><a href="#前端不要操作cookie" class="headerlink" title="前端不要操作cookie"></a>前端不要操作cookie</h3><p>在做一些前后端鉴权的时候，后端应该开启domain,secure,httponly严格模式，禁止前端操作cookie，防止csrf攻击。</p>
<h3 id="代码检查插件"><a href="#代码检查插件" class="headerlink" title="代码检查插件"></a>代码检查插件</h3><p>我们可以使用构建工具继承 husky eslint tslint lint-stage prettier来规范代码。</p>
<ul>
<li><a href="https://link.juejin.im?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Feslint-config-prettier" target="_blank" rel="noopener">eslint-config-prettier</a></li>
<li><a href="https://link.juejin.im?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Feslint-plugin-prettier" target="_blank" rel="noopener">eslint-plugin-prettier</a></li>
<li><a href="https://link.juejin.im?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Feslint-plugin-react" target="_blank" rel="noopener">eslint-plugin-react</a></li>
<li><a href="https://link.juejin.im?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Ftslint-react" target="_blank" rel="noopener">tslint-react</a></li>
<li><a href="https://link.juejin.im?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Ftslint-plugin-prettier" target="_blank" rel="noopener">tslint-plugin-prettier</a></li>
<li><a href="https://link.juejin.im?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Ftslint-config-prettier" target="_blank" rel="noopener">tslint-config-prettier</a></li>
<li><a href="https://link.juejin.im?target=https%3A%2F%2Fgithub.com%2FFaithree%2Fweb-build-tool-demo%2Ftree%2Fmaster%2F28-workflow" target="_blank" rel="noopener">团队开发工作流</a></li>
</ul>
<h3 id="React组件绑定this的四种方式"><a href="#React组件绑定this的四种方式" class="headerlink" title="React组件绑定this的四种方式"></a>React组件绑定this的四种方式</h3><p>用react进行开发组件时，我们需要关注一下组件内部方法this的指向，react定义组件的方式有两种，一种为函数组件，一种为类组件，类组件内部可以定义一些方法，<br>这些方法的this需要绑定到组件实例上， 一共有四种方案：</p>
<ul>
<li>第一种方案，在构造函数内部使用bind绑定this，这样做的好处是，避免每次渲染时都要重新绑定，代码如下：</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span> (props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;<span class="attr">message</span>: <span class="string">'Allo!'</span>&#125;</span><br><span class="line">        <span class="keyword">this</span>.handleClick = <span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleClick (e) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.state.message)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render () &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;button onClick=&#123; <span class="keyword">this</span>.handleClick &#125;&gt;Say Hello&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>第二种方案同样是用bind，但是这次不再构造函数内部使用，而是在render函数内绑定，但是这样的话，每次渲染都需要重新绑定，代码如下：</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span> (props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;<span class="attr">message</span>: <span class="string">'Allo!'</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleClick (name, e) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.state.message + name)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render () &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;button onClick=&#123; <span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>, <span class="string">'赵四'</span>) &#125;&gt;Say Hello&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>第三种方案是在render函数中，调用方法的位置包裹一层箭头函数，因为箭头函数的this指向箭头函数定义的时候其所处作用域的this，而箭头函数在render函数中定义，render函数this始终指向组件实例，所以箭头函数的this也指向组件实例，代码如下：</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span> (props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;<span class="attr">message</span>: <span class="string">'Allo!'</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleClick (e) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.state.message)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render () &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;button onClick=&#123; ()=&gt;&#123; <span class="keyword">this</span>.handleClick() &#125; &#125;&gt;Say Hello&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>以上这种方式有个小问题，因为箭头函数总是匿名的，如果你打算移除监听事件，是做不到的，那么怎么做才可以移除呢？看下一种方案。</p>
<ul>
<li>第四种方案，代码如下：</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span> (props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;<span class="attr">message</span>: <span class="string">'Allo!'</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    handleClick = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.state.message)</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    render () &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;button onClick=&#123; <span class="keyword">this</span>.handleClick &#125;&gt;Say Hello&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>不过，在Classes中直接赋值是ES7的写法，ES6并不支持，你有两种选择，一种是配置你的开发环境支持ES7，一种使采用如下方式，下面这种方式是第四种方案的另外一种写法，代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span> (props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;<span class="attr">message</span>: <span class="string">'Allo!'</span>&#125;</span><br><span class="line">        <span class="keyword">this</span>.handleClick = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.state.message)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    render () &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;button onClick=&#123; <span class="keyword">this</span>.handleClick &#125;&gt;Say Hello&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="React中关于children和render-props"><a href="#React中关于children和render-props" class="headerlink" title="React中关于children和render props"></a>React中关于children和render props</h3><h4 id="组件的创建方式"><a href="#组件的创建方式" class="headerlink" title="组件的创建方式"></a>组件的创建方式</h4><ul>
<li><p>使用<code>createClass</code>方式创建(已经被淘汰了)</p>
</li>
<li><p>类组件</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span><span class="string">'react'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Components1</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span><span class="xml"><span class="tag">&lt;<span class="name">div</span> /&gt;</span></span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>函数组件(比较推荐的方式)</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span><span class="string">'react'</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;&gt;</span><span class="tag">&lt;/&gt;</span></span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">export default () =&gt; &#123;</span></span><br><span class="line"><span class="xml">  return (</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="xml">     <span class="tag">&lt;<span class="name">Child</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line"><span class="xml">  )</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="组件的调用方式-使用children"><a href="#组件的调用方式-使用children" class="headerlink" title="组件的调用方式(使用children)"></a>组件的调用方式(使用<code>children</code>)</h4><blockquote>
<p>直接把组件当做一个<code>DOM</code>节点,在里面写内容,在该组件中使用<code>childrend</code>进行渲染</p>
</blockquote>
<ul>
<li>简单的引用</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span><span class="string">'react'</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;&gt;</span>我是child组件<span class="tag">&lt;/&gt;</span></span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">export default () =&gt; &#123;</span></span><br><span class="line"><span class="xml">  return (</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">Child</span> /&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line"><span class="xml">  )</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>组件中传递<code>html</code>代码</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span><span class="string">'react'</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(props)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;p&gt;我是child组件&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">      &#123;props.children&#125;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">     &lt;Child&gt;</span><br><span class="line">        &#123;<span class="comment">/* 在组件中直接写内容可以传递到该组件的children上 */</span>&#125;</span><br><span class="line">        &lt;h1&gt;我是父组件传递进去的&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">        &lt;h2&gt;我是父组件传递进去的内容二&lt;/</span>h2&gt;</span><br><span class="line">     &lt;<span class="regexp">/Child&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>传递一个组件进去</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span><span class="string">'react'</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;p&gt;我是Parent组件&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">      &#123;props.children&#125;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;p&gt;我是Child组件&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;Parent&gt;</span><br><span class="line">         &lt;Child /&gt;</span><br><span class="line">      &lt;<span class="regexp">/Parent&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>组件中传递一个函数进去</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span><span class="string">'react'</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;p&gt;我是child组件&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">      &#123;props.children(&#123; name: '哈哈', gender: '男' &#125;)&#125;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">       &lt;Child&gt;</span><br><span class="line">        &#123;args =&gt; &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(args)</span><br><span class="line">          <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">divid="child"</span>&gt;</span>&#123;args.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        &#125;&#125;</span><br><span class="line">      &lt;<span class="regexp">/Child&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="render-props的使用参考文档"><a href="#render-props的使用参考文档" class="headerlink" title="render props的使用参考文档"></a><code>render props</code>的使用<a href="https://link.juejin.im?target=https%3A%2F%2Fzh-hans.reactjs.org%2Fdocs%2Frender-props.html" target="_blank" rel="noopener">参考文档</a></h3><h4 id="主要作用点"><a href="#主要作用点" class="headerlink" title="主要作用点"></a>主要作用点</h4><ul>
<li>1、使用<code>Render Props</code>解决来横切关注点(组件的复用[复用组件内部一些逻辑])</li>
<li>2、<code>Render prop</code> 是一个用于告知组件需要渲染什么内容的函数 <code>prop</code>与传统组件的<code>props</code>有点类似,只是希望渲染的是一个组件或者一个<code>DOM</code>节点</li>
<li>3、<code>Render props</code>主要用于组件代码的复用</li>
</ul>
<h4 id="代码案例"><a href="#代码案例" class="headerlink" title="代码案例"></a>代码案例</h4><ul>
<li>使用<code>render props</code>渲染一个<code>DOM</code>节点</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span><span class="string">'react'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Render03</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">     &lt;div&gt;</span><br><span class="line">        &lt;Child </span><br><span class="line">          render=&#123;props =&gt; &#123;</span><br><span class="line">          <span class="comment">// 可以接收render函数里面的参数</span></span><br><span class="line">          <span class="built_in">console</span>.log(props)</span><br><span class="line">          <span class="keyword">return</span> (</span><br><span class="line">            &lt;divstyle=&#123;&#123;<span class="attr">color</span>: <span class="string">'#f90'</span> &#125;&#125;&gt;</span><br><span class="line">                                  我是渲染出来的--&#123;props.name&#125;--&#123;props.gender&#125;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">          )</span></span><br><span class="line"><span class="regexp">        &#125;&#125;</span></span><br><span class="line"><span class="regexp">      /</span>&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function Child(props) &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;&gt;</span></span><br><span class="line"><span class="regexp">      &lt;h1&gt;我是child组件&lt;/</span>h1&gt;</span><br><span class="line">      &#123;<span class="comment">/* render里面传递参数,真正渲染的地方接收参数 */</span>&#125;</span><br><span class="line">      &#123;props.render(&#123; <span class="attr">name</span>: <span class="string">'张三'</span>, <span class="attr">gender</span>: <span class="string">'男'</span> &#125;)&#125;</span><br><span class="line">    &lt;<span class="regexp">/&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>使用<code>render props</code>渲染一个组件</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span><span class="string">'react'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Render04</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div id=<span class="string">"render04"</span>&gt;</span><br><span class="line">      &lt;Child1 render=&#123; props =&gt; <span class="xml"><span class="tag">&lt;<span class="name">Child2</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span>&#125; /&gt;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child1</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;h2&gt;我是child1组件&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">      &#123;props.render(&#123; name: '张三', gender: '男' &#125;)&#125;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child2</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(props)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;h2&gt;我是child2组件&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">      &lt;h3&gt;&#123;props.name&#125;&lt;/</span>h3&gt;</span><br><span class="line">    &lt;<span class="regexp">/&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>使用<code>render props</code>达到组件的复用</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState &#125; <span class="keyword">from</span><span class="string">'react'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Render05</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;Mouse</span><br><span class="line">        render=&#123;props =&gt; &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Cat</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></span></span><br><span class="line"><span class="xml">        &#125;&#125;</span></span><br><span class="line"><span class="xml">      /&gt;</span></span><br><span class="line">      &lt;Mouse</span><br><span class="line">        render=&#123;props =&gt; &#123;</span><br><span class="line">          console.log(props)</span><br><span class="line">          return (</span><br><span class="line">            &lt;div</span><br><span class="line">              style=&#123;&#123;</span><br><span class="line">                width: '100px',</span><br><span class="line">                height: '100px',</span><br><span class="line">                background: '#f90',</span><br><span class="line">                position: 'absolute',</span><br><span class="line">                top: props.y - 50,</span><br><span class="line">                left: props.x - 50</span><br><span class="line">              &#125;&#125;</span><br><span class="line">            /&gt;</span><br><span class="line">          )</span><br><span class="line">        &#125;&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Cat(props) &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;div</span><br><span class="line">        style=&#123;&#123;</span><br><span class="line">          position: 'absolute',</span><br><span class="line">          width: '100px',</span><br><span class="line">          height: '100px',</span><br><span class="line">          background: '#f00',</span><br><span class="line">          cursor: 'move',</span><br><span class="line">          left: props.x - 50,</span><br><span class="line">          top: props.y - 50</span><br><span class="line">        &#125;&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line">function Mouse(props) &#123;</span><br><span class="line">  const [location, setLocation] = useState(&#123; x: 0, y: 0 &#125;)</span><br><span class="line"></span><br><span class="line">  const handleMouseMove = event =&gt; &#123;</span><br><span class="line">    setLocation(&#123;</span><br><span class="line">      x: event.clientX,</span><br><span class="line">      y: event.clientY</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div style=&#123;&#123; height: '100%' &#125;&#125; onMouseMove=&#123;handleMouseMove&#125;&gt;</span><br><span class="line">      &#123;props.render(location)&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="什么是错误边界"><a href="#什么是错误边界" class="headerlink" title="什么是错误边界"></a>什么是错误边界</h3><p>在 React 中，我们通常有一个组件树。如果任何一个组件发生错误，它将破坏整个组件树。没有办法捕捉这些错误，我们可以用错误边界优雅地处理这些错误。<br>错误边界有两个作用</p>
<ul>
<li>如果发生错误，显示回退UI</li>
<li>记录错误</li>
</ul>
<p>下面是ErrorBoundary类的一个例子。如果类实现了 getDerivedStateFromError或componentDidCatch 这两个生命周期方法的任何一下，<br>那么这个类就会成为ErrorBoundary。<br>前者返回{hasError: true}来呈现回退UI，后者用于记录错误。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">ErrorBoundary</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">      <span class="keyword">super</span>(props);</span><br><span class="line">      <span class="keyword">this</span>.state = &#123; <span class="attr">hasError</span>: <span class="literal">false</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">static</span> getDerivedStateFromError(error) &#123;</span><br><span class="line">      <span class="comment">// Update state so the next render will show the fallback UI.</span></span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">hasError</span>: <span class="literal">true</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    componentDidCatch(error, info) &#123;</span><br><span class="line">      <span class="comment">// You can also log the error to an error reporting service</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'Error::::'</span>, error);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    render() &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.state.hasError) &#123;</span><br><span class="line">        <span class="comment">// You can render any custom fallback UI</span></span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>OOPS!. WE ARE LOOKING INTO IT.<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.props.children; </span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<p>以下是我们如何在其中一个组件中使用ErrorBoundary。使用ErrorBoundary类包裹 ToDoForm和ToDoList。 如果这些组件中发生任何错误，我们会记录错误并显示回退UI。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'../App.css'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; ToDoForm &#125; <span class="keyword">from</span> <span class="string">'./todoform'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; ToDolist &#125; <span class="keyword">from</span> <span class="string">'./todolist'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; ErrorBoundary &#125; <span class="keyword">from</span> <span class="string">'../errorboundary'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Dashboard</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div className=<span class="string">"dashboard"</span>&gt; </span><br><span class="line">        &lt;ErrorBoundary&gt;</span><br><span class="line">          &lt;ToDoForm /&gt;</span><br><span class="line">          &lt;ToDolist /&gt;</span><br><span class="line">        &lt;<span class="regexp">/ErrorBoundary&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="什么是-Fragments"><a href="#什么是-Fragments" class="headerlink" title="什么是 Fragments"></a>什么是 Fragments</h3><p>在React中，我们需要有一个父元素，同时从组件返回React元素。有时在DOM中添加额外的节点会很烦人。使用 Fragments，我们不需要在DOM中添加额外的节点。我们只需要用 React.Fragment 或才简写 &lt;&gt; 来包裹内容就行了。如下 所示：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Without Fragments   </span></span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">       &lt;CompoentA /&gt;</span><br><span class="line">       &lt;CompoentB /&gt;</span><br><span class="line">       &lt;CompoentC /&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ With Fragments   </span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;React.Fragment&gt;</span></span><br><span class="line"><span class="regexp">       &lt;CompoentA /</span>&gt;</span><br><span class="line">       &lt;CompoentB /&gt;</span><br><span class="line">       &lt;CompoentC /&gt;</span><br><span class="line">    &lt;<span class="regexp">/React.Fragment&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/ shorthand notation Fragments   </span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;&gt;</span></span><br><span class="line"><span class="regexp">       &lt;CompoentA /</span>&gt;</span><br><span class="line">       &lt;CompoentB /&gt;</span><br><span class="line">       &lt;CompoentC /&gt;</span><br><span class="line">    &lt;<span class="regexp">/&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br></pre></td></tr></table></figure>
<h3 id="什么是传送门-Portals"><a href="#什么是传送门-Portals" class="headerlink" title="什么是传送门(Portals)"></a>什么是传送门(Portals)</h3><p>默认情况下，所有子组件都在UI上呈现，具体取决于组件层次结构。Portal 提供了一种将子节点渲染到存在于父组件以外的 DOM 节点的优秀的方案。</p>
<p>这里有一个例子。默认情况下，父组件在DOM层次结构中有子组件。</p>
<p>我们可以将 children 组件移出parent 组件并将其附加 id 为 someid 的 Dom 节点下。<br>首先，获取 id 为 someid，我们在constrcutorand中创建一个元素div，将child附加到componentDidMount中的someRoot。 最后，我们在ReactDOM.createPortal（this.props.childen），domnode的帮助下将子节点传递给该特定DOM节点。<br>首先，先获取 id 为someid DOM元素，接着在构造函数中创建一个元素div，在 componentDidMount方法中将 someRoot 放到 div 中 。 最后，通过<br>ReactDOM.createPortal(this.props.childen), domnode)将 children 传递到对应的节点下。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> someRoot = <span class="built_in">document</span>.getElementById(<span class="string">'someid'</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modal</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.el = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    someRoot.appendChild(<span class="keyword">this</span>.el);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentWillUnmount() &#123;</span><br><span class="line">    someRoot.removeChild(<span class="keyword">this</span>.el);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> ReactDOM.createPortal(</span><br><span class="line">      <span class="keyword">this</span>.props.children,</span><br><span class="line">      <span class="keyword">this</span>.el,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="你要的-React-面试知识点，都在这了"><a href="#你要的-React-面试知识点，都在这了" class="headerlink" title="你要的 React 面试知识点，都在这了"></a><a href="https://juejin.im/post/5cf0733de51d4510803ce34e#heading-23" target="_blank" rel="noopener">你要的 React 面试知识点，都在这了</a></h3><hr>
<h3 id="React-关键类型"><a href="#React-关键类型" class="headerlink" title="React - 关键类型"></a>React - 关键类型</h3><ul>
<li>展示性组件（<code>FunctionComponent</code>）</li>
</ul>
<p><code>React.FunctionComponent&lt;P&gt;</code> or <code>React.FC&lt;P&gt;</code>。</p>
<p><code>const MyComponent: React.FC&lt;Props&gt; = ...</code></p>
<ul>
<li>有状态组件（<code>ClassComponent</code>）</li>
</ul>
<p><code>React.Component&lt;P, S&gt;</code></p>
<p><code>class MyComponent extends React.Component&lt;Props, State&gt; { ...</code></p>
<ul>
<li>组件Props</li>
</ul>
<p><code>React.ComponentProps&lt;typeof Component&gt;</code></p>
<p>获取组件（适用于ClassComponent、FunctionComponent）的Props的类型</p>
<p><code>type MyComponentProps = React.ComponentProps&lt;typeof MyComponent&gt;;</code></p>
<ul>
<li>React.FC | React.Component的联合类型</li>
</ul>
<p><code>React.ComponentType&lt;P&gt;</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> withState = <span class="xml"><span class="tag">&lt;<span class="name">P</span> <span class="attr">extends</span> <span class="attr">WrappedComponentProps</span>&gt;</span>(</span></span><br><span class="line">    WrappedComponent: React.ComponentType&lt;P&gt;,</span><br><span class="line">) =&gt; &#123; ...</span><br></pre></td></tr></table></figure>
<ul>
<li>React 要素</li>
</ul>
<p><code>React.ReactElement&lt;P&gt;</code> or <code>JSX.Element</code></p>
<p>表示React元素概念的类型 - DOM组件（例如）或用户定义的复合组件（）</p>
<p><code>const elementOnly: React.ReactElement = &lt;div /&gt; || &lt;MyComponent /&gt;;</code></p>
<ul>
<li>React Node</li>
</ul>
<p><code>React.ReactNode</code></p>
<p>表示任何类型的React节点（基本上是ReactElement（包括Fragments和Portals）+ 原始JS类型 的合集）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> elementOrPrimitive: React.ReactNode = <span class="string">'string'</span> || <span class="number">0</span> || <span class="literal">false</span> || <span class="literal">null</span> || <span class="literal">undefined</span> || <span class="xml"><span class="tag">&lt;<span class="name">div</span> /&gt;</span> || <span class="tag">&lt;<span class="name">MyComponent</span> /&gt;</span>;</span></span><br><span class="line"><span class="xml">const Component = (&#123; children: React.ReactNode &#125;) =&gt; ...</span></span><br></pre></td></tr></table></figure>
<ul>
<li>React CSS属性</li>
</ul>
<p><code>React.CSSProperties</code></p>
<p>代表着Style Object在 JSX 文件中（通常用于 css-in-js）<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> styles: React.CSSProperties = &#123; <span class="attr">flexDirection</span>: <span class="string">'row'</span>, ...</span><br><span class="line"><span class="keyword">const</span> element = <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;styles&#125;</span> <span class="attr">...</span></span></span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>通用的 React Event Handler</li>
</ul>
<p><code>React.ReactEventHandler&lt;HTMLElement&gt;</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> handleChange: React.ReactEventHandler&lt;HTMLInputElement&gt; = <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123; ... &#125; </span><br><span class="line"></span><br><span class="line">&lt;input onChange=&#123;handleChange&#125; ... /&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>特殊的 React Event Handler</li>
</ul>
<p><code>React.MouseEvent&lt;E&gt;</code> | <code>React.KeyboardEvent&lt;E&gt;</code> | <code>React.TouchEvent&lt;E&gt;</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> handleChange = <span class="function">(<span class="params">ev: React.MouseEvent&lt;HTMLDivElement&gt;</span>) =&gt;</span> &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">&lt;div onMouseMove=&#123;handleChange&#125; ... /&gt;</span><br></pre></td></tr></table></figure>
<h3 id="React-组件模式"><a href="#React-组件模式" class="headerlink" title="React 组件模式"></a>React 组件模式</h3><ul>
<li>Function Components - FC 纯函数组件（无状态）</li>
</ul>
<p>顾名思义，纯函数组件本身不具备 <code>State</code>，所以没有状态，一切通过 <code>Props</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; FC, ReactElement, MouseEvent  &#125; <span class="keyword">from</span><span class="string">'react'</span></span><br><span class="line"></span><br><span class="line">type Props = &#123;</span><br><span class="line">    label: string,</span><br><span class="line">    children: ReactElement,</span><br><span class="line">    onClick?: <span class="function">(<span class="params">e: MouseEvent&lt;HTMLButtonElement&gt;</span>) =&gt;</span><span class="keyword">void</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> FunctionComponent: FC&lt;Props&gt; = <span class="function">(<span class="params">&#123; label, children, onClick &#125;: Props</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;span&gt;</span><br><span class="line">                &#123;label&#125;：</span><br><span class="line">            &lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">            &lt;button type="button" onClick=&#123;onClick&#125;&gt;</span></span><br><span class="line"><span class="regexp">                &#123;children&#125;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>button&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default FunctionComponent</span></span><br></pre></td></tr></table></figure>
<p><strong>扩展属性（spread attributes）</strong></p>
<p>利用 <code>...</code> 对剩余属性进行处理</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; FC, ReactElement, MouseEvent, CSSProperties &#125; <span class="keyword">from</span><span class="string">'react'</span></span><br><span class="line"></span><br><span class="line">type Props = &#123;</span><br><span class="line">    label: string,</span><br><span class="line">    children: ReactElement,</span><br><span class="line">    className?: string,</span><br><span class="line">    style?: CSSProperties,</span><br><span class="line">    onClick?: <span class="function">(<span class="params">e: MouseEvent&lt;HTMLButtonElement&gt;</span>) =&gt;</span><span class="keyword">void</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> FunctionComponent: FC&lt;Props&gt; = <span class="function">(<span class="params">&#123; label, children, onClick, ...resetProps &#125;: Props</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line">        &lt;div &#123;...resetProps&#125;&gt;</span><br><span class="line">            &lt;span&gt;&#123;label&#125;：&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">            &lt;button type="button" onClick=&#123;onClick&#125;&gt;</span></span><br><span class="line"><span class="regexp">                &#123;children&#125;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>button&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default FunctionComponent</span></span><br></pre></td></tr></table></figure>
<p><strong>默认属性</strong></p>
<p>如果，需要默认属性，可以通过默认参数值来处理</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; FC, ReactElement, MouseEvent  &#125; <span class="keyword">from</span><span class="string">'react'</span></span><br><span class="line"></span><br><span class="line">type Props = &#123;</span><br><span class="line">    label?: string,</span><br><span class="line">    children: ReactElement,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> FunctionComponent: FC&lt;Props&gt; = <span class="function">(<span class="params">&#123; label = <span class="string">'Hello'</span>, children &#125;: Props</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;span&gt;</span><br><span class="line">                &#123;label&#125;：</span><br><span class="line">            &lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">            &lt;button type="button"&gt;</span></span><br><span class="line"><span class="regexp">                &#123;children&#125;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>button&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default FunctionComponent</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Class Components</li>
</ul>
<p>相对于FC，多了 <code>state</code>，采用如下形式来定义Class Component</p>
<blockquote>
<p>这一部分的写法，与<a href="https://juejin.im/post/5b07caf16fb9a07aa83f2977#heading-2" target="_blank" rel="noopener">TypeScript 2.8下的终极React组件模式</a>相同，觉得结构很清晰，复用。</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span><span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line">type Props = &#123;</span><br><span class="line">    label: string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initialState  = &#123;</span><br><span class="line">    count: <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type State = Readonly&lt;<span class="keyword">typeof</span> initialState&gt;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassCounter</span> <span class="keyword">extends</span> <span class="title">Component</span>&lt;<span class="title">Props</span>, <span class="title">State</span>&gt; </span>&#123;</span><br><span class="line">    readonly state: State = initialState</span><br><span class="line"></span><br><span class="line">private handleIncrement = <span class="function"><span class="params">()</span> =&gt;</span><span class="keyword">this</span>.setState(Increment)</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line"><span class="keyword">const</span> &#123; handleIncrement &#125; = <span class="keyword">this</span>;</span><br><span class="line"><span class="keyword">const</span> &#123; label &#125; = <span class="keyword">this</span>.props;</span><br><span class="line"><span class="keyword">const</span> &#123; count &#125; = <span class="keyword">this</span>.state;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;span&gt;</span><br><span class="line">                    &#123;label&#125;: &#123;count&#125;</span><br><span class="line">                &lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">                &lt;button type="button" onClick=&#123;handleIncrement&#125;&gt;</span></span><br><span class="line"><span class="regexp">                    &#123;`Increment`&#125;</span></span><br><span class="line"><span class="regexp">                &lt;/</span>button&gt;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export const Increment = (preState: State) =&gt; (&#123; count: preState.count + 1 &#125;)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default ClassCounter</span></span><br></pre></td></tr></table></figure>
<p><strong>默认属性</strong></p>
<p>处理 Class Component 的默认属性，主要有两种方法：</p>
<ul>
<li>一是定义高阶组件，例如<a href="https://juejin.im/post/5b07caf16fb9a07aa83f2977#heading-2" target="_blank" rel="noopener">TypeScript 2.8下的终极React组件模式</a>中，利用 <code>withDefaultProps</code> 来定义默认属性，涉及组件的属性的类型转换；</li>
<li>二是利用 <code>static props</code> 以及 <code>componentWillReceiveProps</code>，处理默认属性。</li>
</ul>
<p>具体业务中，视情况而定，第一中可以查看相关文章，这里介绍第二种</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span><span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line">type Props = &#123;</span><br><span class="line">    label: string,</span><br><span class="line">    initialCount: number</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type State = &#123;</span><br><span class="line">    count: number;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassCounter</span> <span class="keyword">extends</span> <span class="title">Component</span>&lt;<span class="title">Props</span>, <span class="title">State</span>&gt; </span>&#123;</span><br><span class="line"><span class="keyword">static</span> defaultProps = &#123;</span><br><span class="line">        initialCount: <span class="number">1</span>,</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// 依据 defaultProps 对 state 进行处理</span></span><br><span class="line">    readonly state: State = &#123;</span><br><span class="line">        count: <span class="keyword">this</span>.props.initialCount,</span><br><span class="line">    &#125;</span><br><span class="line">private handleIncrement = <span class="function"><span class="params">()</span> =&gt;</span><span class="keyword">this</span>.setState(Increment)</span><br><span class="line"><span class="comment">// 响应 defaultProps 的变化</span></span><br><span class="line">    componentWillReceiveProps(&#123; initialCount &#125;: Props) &#123;</span><br><span class="line"><span class="keyword">if</span> (initialCount != <span class="literal">null</span> &amp;&amp; initialCount !== <span class="keyword">this</span>.props.initialCount) &#123;</span><br><span class="line"><span class="keyword">this</span>.setState(&#123; <span class="attr">count</span>: initialCount &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line"><span class="keyword">const</span> &#123; handleIncrement &#125; = <span class="keyword">this</span>;</span><br><span class="line"><span class="keyword">const</span> &#123; label &#125; = <span class="keyword">this</span>.props;</span><br><span class="line"><span class="keyword">const</span> &#123; count &#125; = <span class="keyword">this</span>.state;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;span&gt;</span><br><span class="line">                    &#123;label&#125;: &#123;count&#125;</span><br><span class="line">                &lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">                &lt;button type="button" onClick=&#123;handleIncrement&#125;&gt;</span></span><br><span class="line"><span class="regexp">                    &#123;`Increment`&#125;</span></span><br><span class="line"><span class="regexp">                &lt;/</span>button&gt;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export const Increment = (preState: State) =&gt; (&#123; count: preState.count + 1 &#125;)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default ClassCounter</span></span><br></pre></td></tr></table></figure>
<ul>
<li>通用组件 Generic Components</li>
<li>复用共有的逻辑创建组件</li>
<li>常用于通用列表</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component, ReactElement &#125; <span class="keyword">from</span><span class="string">'react'</span></span><br><span class="line"></span><br><span class="line">interface GenericListProps&lt;T&gt; &#123;</span><br><span class="line">    items: T[],</span><br><span class="line">    itemRenderer: <span class="function">(<span class="params">item: T, i: number</span>) =&gt;</span> ReactElement,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GenericList</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">Component</span>&lt;<span class="title">GenericListProps</span>&lt;<span class="title">T</span>&gt;, </span>&#123;&#125;&gt; &#123;</span><br><span class="line">    render() &#123;</span><br><span class="line"><span class="keyword">const</span> &#123; items, itemRenderer &#125; = <span class="keyword">this</span>.props</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;items.map(itemRenderer)&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> GenericList</span><br></pre></td></tr></table></figure>
<ul>
<li><p>Render Callback &amp; Render Props</p>
</li>
<li><p>Render Callback，也被称为函数子组件，就是将 children 替换为 () =&gt; children；</p>
</li>
<li><p>Render Props，就是将 () =&gt; component 作为 Props 传递下去。</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> React, &#123; Component, ReactElement &#125; <span class="keyword">from</span><span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line">type Props = &#123;</span><br><span class="line">    PropRender?: <span class="function"><span class="params">()</span> =&gt;</span> ReactElement,</span><br><span class="line">    children?: <span class="function"><span class="params">()</span> =&gt;</span> ReactElement</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PropRender</span> <span class="keyword">extends</span> <span class="title">Component</span>&lt;<span class="title">Props</span>, </span>&#123;&#125;&gt; &#123;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">props</span>: &#123; children, PropRender &#125; &#125;: &#123; <span class="attr">props</span>: Props &#125; = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &#123; PropRender &amp;&amp; PropRender() &#125;</span><br><span class="line">                &#123; children &amp;&amp; children() &#125;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default PropRender</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ 应用</span></span><br><span class="line"><span class="regexp">&lt;PropsRender</span></span><br><span class="line"><span class="regexp">                    PropRender=&#123;() =&gt; (&lt;p&gt;Prop Render&lt;/</span>p&gt;)&#125;</span><br><span class="line">                &gt;</span><br><span class="line">                    &#123; () =&gt; (<span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Child Render<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>) &#125;</span><br><span class="line">               &lt;<span class="regexp">/PropsRender&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>HOC（Higher-Order Components）</li>
</ul>
<p>简单理解为，接受React组件作为输入，输出一个新的React组件的组件的工厂函数。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> React <span class="keyword">from</span><span class="string">'react'</span></span><br><span class="line"></span><br><span class="line">interface InjectedProps &#123;</span><br><span class="line">    label: string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">exportconst withState = <span class="xml"><span class="tag">&lt;<span class="name">BaseProps</span> <span class="attr">extends</span> <span class="attr">InjectedProps</span>&gt;</span>(</span></span><br><span class="line">    BaseComponent: React.ComponentType&lt;BaseProps&gt;</span><br><span class="line">) =&gt; &#123;</span><br><span class="line">type HocProps = BaseProps &amp; InjectedProps &amp; &#123;</span><br><span class="line">        initialCount?: number</span><br><span class="line">    &#125;</span><br><span class="line">type HocState = &#123;</span><br><span class="line">        readonly count: number</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">returnclass Hoc extends React.Component&lt;HocProps, HocState&gt; &#123;</span><br><span class="line">// 方便 debugging in React-Dev-Tools</span><br><span class="line">static displayName = `withState($&#123;BaseComponent.name&#125;)`;</span><br><span class="line">// 关联原始的 wrapped component</span><br><span class="line">static readonly WrappedComponent = BaseComponent;</span><br><span class="line"></span><br><span class="line">        readonly state: HocState = &#123;</span><br><span class="line">            count: Number(this.props.initialCount) || 0,</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        handleIncrement = () =&gt; &#123;</span><br><span class="line">this.setState(&#123; count: this.state.count + 1 &#125;)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        render() &#123;</span><br><span class="line">const &#123; ...restProps &#125; = this.props asany</span><br><span class="line">const &#123; count &#125; = this.state</span><br><span class="line"></span><br><span class="line">return (</span><br><span class="line">                &lt;&gt;</span><br><span class="line">                    &#123;count&#125;</span><br><span class="line">                    &lt;BaseComponent</span><br><span class="line">                        onClick=&#123;this.handleIncrement&#125;</span><br><span class="line">                        &#123;...restProps&#125;</span><br><span class="line">                    /&gt;</span><br><span class="line">                &lt;/&gt;</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Redux-使用以及-Redux-Thunk-使用"><a href="#Redux-使用以及-Redux-Thunk-使用" class="headerlink" title="Redux - 使用以及 Redux Thunk 使用"></a>Redux - 使用以及 Redux Thunk 使用</h3><p>以如下形式来介绍Redux，主要是in-ts的使用：</p>
<ul>
<li><p>(prestate, action) =&gt; state；</p>
</li>
<li><p>使用Redux Thunk 来出来异步操作。</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store.js</span></span><br><span class="line"></span><br><span class="line">type DataType = &#123;</span><br><span class="line">    counter: number</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> DataState: DataType = &#123;</span><br><span class="line">    counter: <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type RootState = &#123;</span><br><span class="line">    Data: DataType</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> RootState</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// action.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; Action, AnyAction &#125; <span class="keyword">from</span><span class="string">'redux'</span></span><br><span class="line"><span class="keyword">import</span> &#123; ThunkAction, ThunkDispatch &#125; <span class="keyword">from</span><span class="string">'redux-thunk'</span></span><br><span class="line"><span class="keyword">import</span> RootState <span class="keyword">from</span><span class="string">'../store/index'</span></span><br><span class="line"></span><br><span class="line">type IncrementPayload = &#123;</span><br><span class="line">    value: number</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">interface IncrementAction extends Action &#123;</span><br><span class="line">    type: <span class="string">'INCREMENT'</span>,</span><br><span class="line">    payload: IncrementPayload</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">exportconst Increment = (&#123; value &#125;: IncrementPayload): <span class="function"><span class="params">IncrementAction</span> =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">const</span> payload = &#123; value &#125;</span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">        type: <span class="string">'INCREMENT'</span>,</span><br><span class="line">        payload</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> type DecrementPayload = &#123;</span><br><span class="line">    value: number;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> interface DecrementAction extends Action &#123;</span><br><span class="line">    type: <span class="string">'DECREMENT'</span>;</span><br><span class="line">    payload: DecrementPayload;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> type RootAction = IncrementAction &amp; DecrementAction;</span><br><span class="line"></span><br><span class="line">exportconst asyncIncrement = (</span><br><span class="line">    payload: IncrementPayload</span><br><span class="line">): ThunkAction&lt;<span class="built_in">Promise</span>&lt;<span class="keyword">void</span>&gt;, RootState, <span class="keyword">void</span>, AnyAction&gt; =&gt; &#123;</span><br><span class="line">returnasync (dispatch: ThunkDispatch&lt;RootState, <span class="keyword">void</span>, AnyAction&gt;): <span class="built_in">Promise</span>&lt;<span class="keyword">void</span>&gt; =&gt; &#123;</span><br><span class="line">returnnewPromise&lt;<span class="keyword">void</span>&gt;<span class="function">(<span class="params">(resolve</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'Login in progress'</span>)</span><br><span class="line">            setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                dispatch(Increment(payload))</span><br><span class="line">                setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                    resolve()</span><br><span class="line">                &#125;, <span class="number">1000</span>)</span><br><span class="line">            &#125;, <span class="number">3000</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// reducer.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; DataState, DataType &#125; <span class="keyword">from</span><span class="string">'../store/Data'</span></span><br><span class="line"><span class="keyword">import</span> &#123; RootAction &#125; <span class="keyword">from</span><span class="string">'../actions/'</span></span><br><span class="line"></span><br><span class="line">exportdefaultfunction (state: DataType = DataState, &#123; type, payload &#125;: RootAction): DataType&#123;</span><br><span class="line"><span class="keyword">switch</span>(type) &#123;</span><br><span class="line"><span class="keyword">case</span><span class="string">'INCREMENT'</span>:</span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">                ...state,</span><br><span class="line">                counter: state.counter + payload.value,</span><br><span class="line">            &#125;;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line"><span class="keyword">return</span> state;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><code class="js">
<span class="comment">// Hearder.js</span>
<span class="keyword">import</span> React, { Component, ReactNode } <span class="keyword">from</span><span class="string">'react'</span>
<span class="keyword">import</span> RootState <span class="keyword">from</span><span class="string">'../store/index'</span>
<span class="keyword">import</span> { Dispatch, AnyAction } <span class="keyword">from</span><span class="string">'redux'</span>
<span class="keyword">import</span> { ThunkDispatch } <span class="keyword">from</span><span class="string">'redux-thunk'</span>
<span class="keyword">import</span> { connect } <span class="keyword">from</span><span class="string">'react-redux'</span>
<span class="keyword">import</span> { Increment, asyncIncrement } <span class="keyword">from</span><span class="string">'../actions/'</span>

<span class="keyword">const</span> initialState = {
    name: <span class="string">'string'</span>
}

type StateToPropsType = Readonly&lt;{
    counter: number
}&gt;
type DispatchToPropsType = Readonly&lt;{
    handleAdd: <span class="function"><span class="params">()</span> =&gt;</span><span class="keyword">void</span>,
    handleDec: <span class="function"><span class="params">()</span> =&gt;</span><span class="keyword">void</span>
}&gt;

type StateType = Readonly&lt;<span class="keyword">typeof</span> initialState&gt;
type PropsType = {
    children?: ReactNode
}
type ComponentProps = StateToPropsType &amp; DispatchToPropsType &amp; PropsType

<span class="class"><span class="keyword">class</span> <span class="title">Header</span> <span class="keyword">extends</span> <span class="title">Component</span>&lt;<span class="title">ComponentProps</span>, <span class="title">StateType</span>&gt; </span>{
    readonly state: StateType = initialState;

    render() {
<span class="keyword">const</span> { <span class="attr">props</span>: { handleAdd, handleDec, counter }, <span class="attr">state</span>: { name } } = <span class="keyword">this</span>

<span class="keyword">return</span> (
            &lt;div&gt;
                计数：{counter}
                &lt;button onClick={handleAdd}&gt;+<span class="xml"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>
                &lt;button onClick={handleDec}&gt;-<span class="xml"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>
            &lt;<span class="regexp">/div&gt;</span>
<span class="regexp">        )</span>
<span class="regexp">    }</span>
<span class="regexp"></span>
<span class="regexp">    private handleClick = () =&gt; this.setState(sayHello);</span>
<span class="regexp">}</span>
<span class="regexp"></span>
<span class="regexp">const sayHello = (prevState: StateType) =&gt; ({</span>
<span class="regexp">    name: prevState.name + 'Hello world',</span>
<span class="regexp">})</span>
<span class="regexp"></span>
<span class="regexp">const mapStateToProps = (state: RootState, props: PropsType): StateToPropsType =&gt; {</span>
<span class="regexp">    return {</span>
<span class="regexp">        counter: state.Data.counter</span>
<span class="regexp">    }</span>
<span class="regexp">}</span>
<span class="regexp"></span>
<span class="regexp">const mapDispatchToProps = (dispatch: ThunkDispatch&lt;RootState, void, AnyAction&gt;): DispatchToPropsType =&gt; {</span>
<span class="regexp">    return {</span>
<span class="regexp">        handleAdd: () =&gt; {</span>
<span class="regexp">            dispatch(Increment({ value: 2 }))</span>
<span class="regexp">        },</span>
<span class="regexp">        handleDec: async () =&gt; {</span>
<span class="regexp">            dispatch(asyncIncrement({ value: 10 }))</span>
<span class="regexp">        }</span>
<span class="regexp">    }</span>
<span class="regexp">}</span>
<span class="regexp"></span>
<span class="regexp">export default connect&lt;StateToPropsType, DispatchToPropsType, PropsType, RootState&gt;(mapStateToProps, mapDispatchToProps)(Header)</span>
</code></pre>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/React/" rel="tag"># React</a>
          
            <a href="/tags/TypeScript/" rel="tag"># TypeScript</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/05/22/7个有用的Vue开发技巧/" rel="next" title="7个有用的Vue开发技巧">
                <i class="fa fa-chevron-left"></i> 7个有用的Vue开发技巧
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/06/09/写一个类似Vue的Transition的React组件/" rel="prev" title="写一个类似Vue的Transition的React组件">
                写一个类似Vue的Transition的React组件 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/tx.jpg" alt="李斌">
            
              <p class="site-author-name" itemprop="name">李斌</p>
              <p class="site-description motion-element" itemprop="description">人生如逆旅     我亦是行人</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">196</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">121</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/libin1991" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://juejin.im/user/57e737f6c4c971005f6bcd8d" target="_blank" title="juejin">
                      
                        <i class="fa fa-fw fa-spinner"></i>juejin</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#TypeScript-代码整洁之道"><span class="nav-number">1.</span> <span class="nav-text">TypeScript 代码整洁之道</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#注释"><span class="nav-number">2.</span> <span class="nav-text">注释</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-文件顶部的注释，包括描述、作者、日期"><span class="nav-number">2.1.</span> <span class="nav-text">(1) 文件顶部的注释，包括描述、作者、日期</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-模块的注释"><span class="nav-number">2.2.</span> <span class="nav-text">(2) 模块的注释</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-业务代码注释"><span class="nav-number">2.3.</span> <span class="nav-text">(3) 业务代码注释</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-变量注释"><span class="nav-number">2.4.</span> <span class="nav-text">(4) 变量注释</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#引用组件顺序"><span class="nav-number">3.</span> <span class="nav-text">引用组件顺序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#引号"><span class="nav-number">4.</span> <span class="nav-text">引号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#缩进"><span class="nav-number">5.</span> <span class="nav-text">缩进</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#分号"><span class="nav-number">6.</span> <span class="nav-text">分号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#括号"><span class="nav-number">7.</span> <span class="nav-text">括号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#空格"><span class="nav-number">8.</span> <span class="nav-text">空格</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#换行"><span class="nav-number">9.</span> <span class="nav-text">换行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数组、对象"><span class="nav-number">10.</span> <span class="nav-text">数组、对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#命名"><span class="nav-number">11.</span> <span class="nav-text">命名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#类型断言"><span class="nav-number">12.</span> <span class="nav-text">类型断言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#interface声明顺序"><span class="nav-number">13.</span> <span class="nav-text">interface声明顺序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ts好用的相关工具泛型"><span class="nav-number">14.</span> <span class="nav-text">ts好用的相关工具泛型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ts一些好用的小tips"><span class="nav-number">15.</span> <span class="nav-text">ts一些好用的小tips</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#规范其他"><span class="nav-number">16.</span> <span class="nav-text">规范其他</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#仅当初始-state-需要从-props-计算得到的时候，才将-state-的声明放在构造函数中，其它情况下使用静态属性声明-state-并且一般情况下不要将-prop-传给-state，"><span class="nav-number">17.</span> <span class="nav-text">仅当初始 state 需要从 props 计算得到的时候，才将 state 的声明放在构造函数中，其它情况下使用静态属性声明 state,并且一般情况下不要将 prop 传给 state，</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#渲染默认值"><span class="nav-number">18.</span> <span class="nav-text">渲染默认值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#不确定的属性，最后却疯狂的用…访问不存在的属性"><span class="nav-number">19.</span> <span class="nav-text">不确定的属性，最后却疯狂的用…访问不存在的属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据格式转换"><span class="nav-number">20.</span> <span class="nav-text">数据格式转换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#判断条件真假"><span class="nav-number">21.</span> <span class="nav-text">判断条件真假</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#简单组件可以使用函数代替"><span class="nav-number">22.</span> <span class="nav-text">简单组件可以使用函数代替</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#对于常用的属性进行缓存"><span class="nav-number">23.</span> <span class="nav-text">对于常用的属性进行缓存</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#input-输入框使用-trim"><span class="nav-number">24.</span> <span class="nav-text">input 输入框使用 trim()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-location-跳转前需要先转义"><span class="nav-number">25.</span> <span class="nav-text">使用 location 跳转前需要先转义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-react-router"><span class="nav-number">26.</span> <span class="nav-text">使用 react-router</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#同时开发，数据请求-api-目录-git-冲突目录方案"><span class="nav-number">27.</span> <span class="nav-text">同时开发，数据请求 api 目录 git 冲突目录方案</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#组件嵌套过深"><span class="nav-number">28.</span> <span class="nav-text">组件嵌套过深</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#代码过滤掉你没考虑到的情况"><span class="nav-number">29.</span> <span class="nav-text">代码过滤掉你没考虑到的情况</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#业务代码里面的异步请求需要-try-catch"><span class="nav-number">30.</span> <span class="nav-text">业务代码里面的异步请求需要 try catch</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#setState有三种用法"><span class="nav-number">31.</span> <span class="nav-text">setState有三种用法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#setState可能是同步的"><span class="nav-number">32.</span> <span class="nav-text">setState可能是同步的</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#不要在-setState-前面加-await"><span class="nav-number">33.</span> <span class="nav-text">不要在 setState 前面加 await</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#阻止事件默认行为"><span class="nav-number">34.</span> <span class="nav-text">阻止事件默认行为</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#在-componentWillUnmount-里面去除副作用的函数"><span class="nav-number">35.</span> <span class="nav-text">在 componentWillUnmount 里面去除副作用的函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#key"><span class="nav-number">36.</span> <span class="nav-text">key</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#for-in-中一定要有-hasOwnProperty-的判断（即禁止直接读取原型对象的属性）"><span class="nav-number">37.</span> <span class="nav-text">for-in 中一定要有 hasOwnProperty 的判断（即禁止直接读取原型对象的属性）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#第三方库函数的使用"><span class="nav-number">38.</span> <span class="nav-text">第三方库函数的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#防止-xss-攻击"><span class="nav-number">39.</span> <span class="nav-text">防止 xss 攻击</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#在组件中获取真实-dom"><span class="nav-number">40.</span> <span class="nav-text">在组件中获取真实 dom</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#减少魔法数字"><span class="nav-number">41.</span> <span class="nav-text">减少魔法数字</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如果需要优化-react-性能（一般用不到）"><span class="nav-number">42.</span> <span class="nav-text">如果需要优化 react 性能（一般用不到）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Event-事件对象类型"><span class="nav-number">43.</span> <span class="nav-text">Event 事件对象类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用私有属性取代state状态"><span class="nav-number">44.</span> <span class="nav-text">使用私有属性取代state状态</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#代码细粒度的思考"><span class="nav-number">45.</span> <span class="nav-text">代码细粒度的思考</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#if-else-等判断太多了，后期难以维护。"><span class="nav-number">46.</span> <span class="nav-text">if else 等判断太多了，后期难以维护。</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#不要使用renderXXX-要使用函数式组件"><span class="nav-number">47.</span> <span class="nav-text">不要使用renderXXX,要使用函数式组件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#a标签安全问题"><span class="nav-number">48.</span> <span class="nav-text">a标签安全问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#void-0-替代undefined"><span class="nav-number">49.</span> <span class="nav-text">void 0 替代undefined</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#前端不要操作cookie"><span class="nav-number">50.</span> <span class="nav-text">前端不要操作cookie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#代码检查插件"><span class="nav-number">51.</span> <span class="nav-text">代码检查插件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#React组件绑定this的四种方式"><span class="nav-number">52.</span> <span class="nav-text">React组件绑定this的四种方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#React中关于children和render-props"><span class="nav-number">53.</span> <span class="nav-text">React中关于children和render props</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#组件的创建方式"><span class="nav-number">53.1.</span> <span class="nav-text">组件的创建方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#组件的调用方式-使用children"><span class="nav-number">53.2.</span> <span class="nav-text">组件的调用方式(使用children)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#render-props的使用参考文档"><span class="nav-number">54.</span> <span class="nav-text">render props的使用参考文档</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#主要作用点"><span class="nav-number">54.1.</span> <span class="nav-text">主要作用点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#代码案例"><span class="nav-number">54.2.</span> <span class="nav-text">代码案例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是错误边界"><span class="nav-number">55.</span> <span class="nav-text">什么是错误边界</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是-Fragments"><span class="nav-number">56.</span> <span class="nav-text">什么是 Fragments</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是传送门-Portals"><span class="nav-number">57.</span> <span class="nav-text">什么是传送门(Portals)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#你要的-React-面试知识点，都在这了"><span class="nav-number">58.</span> <span class="nav-text">你要的 React 面试知识点，都在这了</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#React-关键类型"><span class="nav-number">59.</span> <span class="nav-text">React - 关键类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#React-组件模式"><span class="nav-number">60.</span> <span class="nav-text">React 组件模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Redux-使用以及-Redux-Thunk-使用"><span class="nav-number">61.</span> <span class="nav-text">Redux - 使用以及 Redux Thunk 使用</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">李斌</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

  
  <!--
  	描述：点击红心
  -->
  <script type="text/javascript" src="/js/src/clicklove.js"></script>
  <!--
  	描述：复制代码
  -->
  <script type="text/javascript" src="/js/src/clipboard.min.js"></script>
  <script type="text/javascript" src="/js/src/clipboard-use.js"></script>
</body>
</html>


