<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="滚动条,">










<meta name="description" content="CSS滚动条样式之前重构微博私信的时候,地址,要保持各个浏览器滚动条样式的统一。在webkit内核浏览器我们可以这样定义整个页面的滚动条样式:123456789101112::-webkit-scrollbar &amp;#123;  //隐藏滚轮display: none;	width: 6px;	height: 6px;&amp;#125;::-webkit-scrollbar-track-piece &amp;#1">
<meta name="keywords" content="滚动条">
<meta property="og:type" content="article">
<meta property="og:title" content="JS如何统一滚动条样式">
<meta property="og:url" content="http://yoursite.com/2019/05/14/JS如何统一滚动条样式/index.html">
<meta property="og:site_name" content="Zero Days">
<meta property="og:description" content="CSS滚动条样式之前重构微博私信的时候,地址,要保持各个浏览器滚动条样式的统一。在webkit内核浏览器我们可以这样定义整个页面的滚动条样式:123456789101112::-webkit-scrollbar &amp;#123;  //隐藏滚轮display: none;	width: 6px;	height: 6px;&amp;#125;::-webkit-scrollbar-track-piece &amp;#1">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/2019/05/14/JS如何统一滚动条样式/1.gif">
<meta property="og:image" content="http://yoursite.com/2019/05/14/JS如何统一滚动条样式/2.gif">
<meta property="og:updated_time" content="2019-05-21T15:48:03.348Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JS如何统一滚动条样式">
<meta name="twitter:description" content="CSS滚动条样式之前重构微博私信的时候,地址,要保持各个浏览器滚动条样式的统一。在webkit内核浏览器我们可以这样定义整个页面的滚动条样式:123456789101112::-webkit-scrollbar &amp;#123;  //隐藏滚轮display: none;	width: 6px;	height: 6px;&amp;#125;::-webkit-scrollbar-track-piece &amp;#1">
<meta name="twitter:image" content="http://yoursite.com/2019/05/14/JS如何统一滚动条样式/1.gif">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/05/14/JS如何统一滚动条样式/">





  <title>JS如何统一滚动条样式 | Zero Days</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband">
    	<div class="eevee"><div class="body"><div class="head"><div class="ears"><div class="ear"><div class="lobe"></div></div><div class="ear"><div class="lobe"></div></div></div><div class="face"><div class="eyes"><div class="eye"><div class="eyelid"></div></div><div class="eye"><div class="eyelid"></div></div></div><div class="nose"></div><div class="mouth"></div></div></div><div class="chest"><div class="fur"><div class="patch"></div></div><div class="fur"><div class="patch"></div></div><div class="fur"><div class="patch"></div></div></div><div class="legs"><div class="leg"><div class="inner-leg"></div></div><div class="leg"><div class="inner-leg"></div></div><div class="leg"><div class="inner-leg"></div></div><div class="leg"><div class="inner-leg"></div></div></div><div class="tail"><div class="tail"><div class="tail"><div class="tail"><div class="tail"><div class="tail -end"></div></div></div></div></div></div></div></div>
    </div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
    	<div id="sky">
				<div id="background" class="container">
			<!-- svg file -->
			<svg id="svgout" height="100%" width="100%" viewbox="0 0 550 400">
				<defs>
					<g id="bottomShadow">
						<path fill="#000000" stroke="none" d="
		M 270.5 225.95
		L 127.35 316.65 266.8 400 409.6 309.25 270.5 225.95 Z"/>
					</g>
					<g id="Layer52_0_FILL">
						<path class="topGrass" fill="#B9D668" stroke="none" d="
	M 397.85 229.3
	L 397.85 225.6 269.85 152 135.75 228.6 135.75 233.65 262.1 306.55 397.85 229.3 Z"/>
					</g>
					<g id="Layer51_0_FILL">
						<path class="leftSideGrass" fill="#6E9E4F" stroke="none" d="
	M 135.1 229.95
	L 135.1 256.85 262.1 328.4 262.1 301.85 135.1 229.95 Z"/>
					</g>
					<g id="Layer50_0_FILL">
						<path class="rightGrassTop" fill="#8CB154" stroke="none" d="
	M 397.85 225.95
	L 395.8 225.95 261.75 301.55 261.75 328.4 397.85 251.15 397.85 225.95 Z"/>
					</g>
					<g id="Layer48_0_FILL">
						<path class="crustLeftTop" fill="#955541" stroke="none" d="
	M 135.45 282.4
	L 135.75 298.15 262.1 372.1 261.75 355.65 135.45 282.4 Z"/>
					</g>
					<g id="Layer47_0_FILL">
						<path class="middleLeftCrust" fill="#C77E61" stroke="none" d="
	M 135.1 270.3
	L 135.1 283.05 275.9 364.35 271.85 348.9 135.1 270.3 Z"/>
					</g>
					<g id="Layer46_0_FILL">
						<path class="crustLeftTop" fill="#955541" stroke="none" d="
	M 135.1 255.15
	L 135.1 270.3 262.1 343.55 262.1 328.05 135.1 255.15 Z"/>
					</g>
					<g id="Layer45_0_FILL">
						<path class="topRightCrust" fill="#A47237" stroke="none" d="
	M 397.5 294.5
	L 397.5 277 261.75 355.3 261.75 372.75 397.5 294.5 Z"/>
					</g>
					<g id="Layer44_0_FILL">
						<path class="middleRightCrust" fill="#C89451" stroke="none" d="
	M 397.5 269.95
	L 397.15 266.6 262.1 343.2 262.1 355.95 397.5 279.7 397.5 269.95 Z"/>
					</g>
					<g id="Layer43_0_FILL">
						<path class="topRightCrust" fill="#A47237" stroke="none" d="
	M 397.5 266.6
	L 397.5 250.45 261.75 328.4 261.75 343.85 397.5 266.6 Z"/>
					</g>
					<g id="Layer41_0_FILL">
						<path class="greyRoad" fill="#B2B2B1" stroke="none" d="
	M 295.05 283.05
	Q 299.05 280.35 308.45 275.3 317.85 269.95 323.6 266.9
	L 268.8 233.65 338.05 191.35 309.15 174.55 177.75 254.5
	Q 191.55 262.2 198.25 266.25 204.65 269.95 209.7 271.95
	L 241.6 250.45 295.05 283.05 Z"/>
					</g>
					<g id="Layer40_0_FILL">
						<path fill="#FFFFFF" stroke="none" d="
	M 199.95 256.85
	Q 194.55 261.2 191.9 262.2
	L 194.9 263.9 200.95 259.2 199.95 256.85
	M 225.8 243.75
	L 224.8 241.75 211.05 250.8 212.05 252.8 225.8 243.75
	M 308.15 275.65
	L 296.7 266.6 295.35 268.6 306.8 277.7 308.15 275.65
	M 275.9 253.5
	L 274.55 255.5 285.95 264.55 287.3 262.55 275.9 253.5
	M 251.7 227.3
	L 250.7 225.25 236.9 234.35 237.9 236.35 251.7 227.3
	M 257.05 240.7
	L 254.05 240.7 268.8 249.8 269.5 247.75 257.05 240.7
	M 277.2 207.8
	L 263.45 216.85 264.45 218.9 278.25 209.8 277.2 207.8
	M 305.1 192.65
	L 304.1 190.65 290.3 199.75 291.35 201.75 305.1 192.65 Z"/>
					</g>
					<g id="Layer38_0_FILL">
						<path class="frontFascia" fill="#ECB27B" stroke="none" d="
	M 359.25 187.95
	L 346.4 174.95 333.85 202.9 359.25 187.95 Z"/>
					</g>
					<g id="Layer37_0_FILL">
						<path class="frontWall" fill="#EFA258" stroke="none" d="
	M 334 201.05
	L 334.35 232 359.2 217.55 359.25 187.95 334 201.05 Z"/>
					</g>
					<g id="Layer36_0_FILL">
						<path class="leftWall" fill="#C57F42" stroke="none" d="
	M 334.35 232.3
	L 334.35 205.1 305.1 191.35 305.1 216.85 334.35 232.3 Z"/>
					</g>
					<g id="Layer35_0_FILL">
						<path class="rightRoof" fill="#EF4427" stroke="none" d="
	M 329.7 167.9
	L 331.05 167.9 344.55 176.7 347.85 176.7 363 192.25 363.15 189.55 350.65 176.7 350.55 176.7 334.25 167.5 334.25 159.1 329.7 159.1 329.7 164.9 322.65 160.95 322.3 162.15 329.7 167 329.7 167.9 Z"/>
					</g>
					<g id="Layer34_0_FILL">
						<path class="leftRoof" fill="#F2563B" stroke="none" d="
	M 334.05 207.05
	L 350.65 176.7 322.1 160.45 302.1 192.05 334.05 207.05 Z"/>
					</g>
					<g id="Layer30_0_FILL">
						<path id="windowFour" class="windows" stroke="none" fill="#975A42" d="
	M 341.35 203.3
	Q 340.9 203.45 340.5 203.8 340.1 204.2 339.85 204.75 339.7 205 339.7 205.3 339.6 205.75 339.7 206.1 339.7 206.15 339.7 206.2 339.8 206.5 340 206.8 340.55 207.4 341.45 207.4 342.35 207.4 343 206.8 343.4 206.5 343.65 206.1 343.85 205.75 343.95 205.3 344.05 204.4 343.55 203.8 343.3 203.45 343 203.3 342.65 203.15 342.2 203.15 341.8 203.15 341.35 203.3
	M 355.85 198.45
	Q 355.8 198.2 355.6 198 355.1 197.4 354.2 197.4 353.35 197.4 352.6 198 351.85 198.65 351.7 199.55 351.7 199.7 351.7 199.85 351.6 200.5 352 201.05 352.55 201.65 353.45 201.65 354.3 201.65 355.05 201.05 355.45 200.7 355.7 200.25 355.8 200.05 355.9 199.85 355.95 199.7 355.95 199.55 356.05 198.95 355.85 198.45 Z"/>
						<path class="door" fill="#B65041" stroke="none" d="
	M 351.95 211.2
	L 351.8 211.2 346.05 215.1 346.05 225.2 351.95 221.6 351.95 211.2
	M 351.2 211.2
	L 351.35 211.2 351.35 211.1 351.2 211.2 Z"/>
					</g>
					<g>
						<path id="Layer30_0_FILL" fill="#000000" fill-opacity="1" stroke="none" d="
	M 183.7 215.3
	L 183.7 215.6
	Q 187.25 231.75 212.25 234.35
	L 183.7 215.3 Z"/>
					</g>
					<g id="Layer29_0_FILL">
						<path fill="#000000" fill-opacity="0.4" stroke="none" d="
	M 305.1 216.85
	L 305.15 217.2
	Q 309.45 233.2 334.35 232.3
	L 305.1 216.85 Z"/>
					</g>
					<g id="Layer27_0_FILL">
						<path class="vegetation" fill="#78A950" stroke="none" d="
	M 177.45 231.65
	Q 175.75 235.35 181.8 239.35 185.5 235.7 185.15 231.3 182.8 230.65 181.45 234 179.45 231.3 177.45 231.65
	M 236.9 266.6
	Q 235.2 270.3 241.25 274.3 244.95 270.6 244.65 266.25 242.3 265.6 240.95 268.95 238.9 266.25 236.9 266.6
	M 254.7 277
	Q 253.05 280.7 259.1 284.75 262.75 281.05 262.45 276.65 260.1 276 258.75 279.35 256.7 276.65 254.7 277
	M 315.5 245.75
	Q 313.5 243.05 311.5 243.4 309.8 247.1 315.85 251.15 319.55 247.45 319.2 243.05 316.85 242.4 315.5 245.75
	M 295.35 232.65
	Q 293.7 236.35 299.75 240.4 303.45 236.7 303.1 232.3 300.75 231.65 299.4 235 297.4 232.3 295.35 232.65
	M 277.2 171.85
	Q 275.55 175.55 281.6 179.55 285.3 175.85 284.95 171.5 282.6 170.85 281.25 174.2 279.25 171.5 277.2 171.85 Z"/>
					</g>
					<g id="Layer26_0_FILL">
						<path class="treeWood" fill="#AE663D" stroke="none" d="
	M 175.1 177.55
	L 172.05 177.55 172.05 191.1 159.3 172.85
	Q 154.6 171.5 172.05 195.7
	L 172.05 212.5 175.1 212.5 175.1 177.55
	M 252.7 151.35
	L 249 151.35 249 176.9 252.7 176.9 252.7 151.35 Z"/>
					</g>
					<g id="Layer25_0_FILL">
						<path class="vegetation" fill="#77A951" stroke="none" d="
	M 192.55 179.55
	Q 200.95 173.5 200.95 165.1 200.95 156.4 192.55 150 184.15 144.3 172.05 144.3 160.3 144.3 151.9 150 143.15 156.4 143.15 165.1 143.15 173.5 151.9 179.55 160.3 185.95 172.05 185.95 184.15 185.95 192.55 179.55
	M 236.25 106.65
	Q 230.2 116.05 230.2 129.15 230.2 142.25 236.25 151.35 242.3 160.75 250.7 160.75 258.75 160.75 264.8 151.35 270.85 142.25 270.85 129.15 270.85 116.05 264.8 106.65 258.75 97.6 250.7 97.6 242.3 97.6 236.25 106.65 Z"/>
					</g>
					<g id="Layer24_0_FILL">
						<path class="vegetation" fill="#77A951" stroke="none" d="
	M 158.3 221.9
	Q 160.65 221.9 161.95 220.2 163 219.55 163.3 218.55 164.65 218.9 166.35 218.9 170.05 218.9 172.4 216.2 175.1 213.85 175.1 210.15 175.1 206.45 172.4 203.75 170.05 201.4 166.35 201.4 162.65 201.4 159.95 203.75 157.6 206.45 157.6 210.15 157.6 210.8 157.6 211.15 155.95 211.5 154.6 212.5 152.9 214.15 152.9 216.55 152.9 218.9 154.6 220.2 156.25 221.9 158.3 221.9
	M 338.35 240.05
	Q 341.05 237.7 341.05 234 341.05 230.3 338.35 227.6 336 225.25 332.3 225.25 328.65 225.25 325.95 227.6 323.6 230.3 323.6 234 323.6 237.7 325.95 240.05 328.65 242.75 332.3 242.75 336 242.75 338.35 240.05 Z"/>
					</g>
					<g id="Layer22_0_FILL">
						<path class="rightRoof" fill="#D05041" stroke="none" d="
	M 220 173.85
	L 236.8 186.7 264.35 171.15 244.5 159.55 220 173.85 Z"/>
					</g>
					<g id="Layer21_0_FILL">
						<path class="leftWall" fill="#C57F42" stroke="none" d="
	M 212.25 191.35
	L 183.35 172.3 183.7 215.3 212.25 234.35 212.25 191.35 Z"/>
					</g>
					<g id="Layer20_0_FILL">
						<path class="rightRoof" fill="#EF4427" stroke="none" d="
	M 192.1 149.85
	L 236.45 174.8 243.1 171.4
	Q 220.05 150.55 196.3 139.95
	L 192.1 149.85 Z"/>
					</g>
					<g id="Layer19_0_FILL">
						<path class="frontFascia" fill="#EBB17B" stroke="none" d="
	M 226.85 160.95
	L 212 190.6 229.75 192.6 239.75 172.85 226.85 160.95 Z"/>
					</g>
					<g id="Layer18_0_FILL">
						<path class="frontWall" fill="#EFA258" stroke="none" d="
	M 240.15 172.65
	L 211.9 191.6 212.25 233.65 264.35 201.7 264.35 170.8 240.8 184.45 240.15 172.65 Z"/>
					</g>
					<g id="Layer17_0_FILL">
						<path class="rightRoof" fill="#EF4427" stroke="none" d="
	M 210.9 142.2
	L 205.9 142.2 205.9 152.65 210.9 152.65 210.9 142.2 Z"/>
					</g>
					<g>
						<path id="Layer16_0_FILL" class="leftRoof" fill="#F2563B" stroke="none" d="
	M 210.25 195.5
	L 227.4 160.95 195.45 141.35 177.65 175.85 210.25 195.5 Z"/>
					</g>
					<g>
						<path id="sun" fill="#E3BD0E" stroke="none" d="
	M 257.05 15.95
	Q 251.7 15.95 248 19.65 244.3 23.35 244.3 28.7 244.3 34.1 248 37.8 251.7 41.5 257.05 41.5 262.45 41.5 266.15 37.8 269.85 34.1 269.85 28.7 269.85 23.35 266.15 19.65 262.45 15.95 257.05 15.95 Z"/>
					</g>
					<g id="Layer8_0_FILL">
						<path fill="#975A42" stroke="none" d="
	M 238.45 189.65
	Q 238.295703125 189.362109375 238.05 189.1 237.35 188.3 236.2 188.3 235.05 188.3 234.15 189.1 233.3 189.9 233.2 191.05 233.1 192.2 233.8 193 234.55 193.8 235.7 193.8 236.85 193.8 237.7 193 238.1970703125 192.558203125 238.45 192 238.6552734375 191.56484375 238.7 191.05 238.7671875 190.276953125 238.45 189.65
	M 220.55 197.55
	Q 220 197.55 219.5 197.75 218.95 197.95 218.5 198.35 217.933203125 198.8833984375 217.7 199.55 217.5833984375 199.916796875 217.55 200.3 217.4923828125 200.96171875 217.7 201.5 217.852734375 201.9103515625 218.15 202.25 218.95 203.05 220.1 203.05 221.25 203.05 222.05 202.25 222.95 201.45 223.05 200.3 223.15 199.15 222.4 198.35 222.05 197.95 221.65 197.75 221.15 197.55 220.55 197.55 Z"/>
					</g>
					<g id="Layer7_0_FILL">
						<path class="door" fill="#B65041" stroke="none" d="
	M 233.55 206.75
	L 225.9 211.95 226.25 225.5 233.95 220.35 233.55 206.75 Z"/>
					</g>
					<g>
						<path id="windowOne" class="windows" fill="#975A42" stroke="none" d="
	M 188.65 198.4
	L 188.8 204.1 198.65 210.45 198.55 204.75 188.65 198.4
	M 208.45 216.8
	L 208.35 211.1 198.55 204.75 198.65 210.45 208.45 216.8
	M 188.8 204.1
	L 188.95 209.8 198.8 216.15 198.65 210.45 188.8 204.1
	M 208.6 222.5
	L 208.45 216.8 198.65 210.45 198.8 216.15 208.6 222.5 Z"/>
					</g>
					<g>
						<path id="windowThree" class="windows" fill="#975A42" stroke="none" d="
	M 311.7 214.1
	L 318.55 217.55 318.45 211.9 311.6 208.45 311.7 214.1
	M 325.4 221
	L 325.25 215.35 318.45 211.9 318.55 217.55 325.4 221
	M 318.4 206.2
	L 311.5 202.75 311.6 208.45 318.45 211.9 318.4 206.2
	M 325.25 215.35
	L 325.2 209.7 318.4 206.2 318.45 211.9 325.25 215.35 Z"/>
					</g>
					<g id="Layer2_0_FILL">
						<path class="door" fill="#B65041" stroke="none" d="
	M 259.7 183.25
	L 244.6 191.9 244.6 213.8 259.7 204.55 259.7 183.25 Z"/>
					</g>
					<path id="windowTwo" fill="#975A42" class="windows" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" d="
	M 223.05 200.3
	Q 222.95 201.45 222.05 202.25 221.25 203.05 220.1 203.05 218.95 203.05 218.15 202.25 217.852734375 201.9103515625 217.7 201.5 217.4923828125 200.96171875 217.55 200.3 217.5833984375 199.916796875 217.7 199.575 217.933203125 198.8833984375 218.5 198.35 218.95 197.95 219.5 197.75 220 197.55 220.55 197.55 221.15 197.55 221.65 197.75 222.05 197.95 222.4 198.35 223.15 199.15 223.05 200.3 Z
	M 238.7 191.05
	Q 238.6552734375 191.56484375 238.45 192 238.1970703125 192.558203125 237.7 193 236.85 193.8 235.7 193.8 234.55 193.8 233.8 193 233.1 192.2 233.2 191.05 233.3 189.9 234.15 189.1 235.05 188.3 236.2 188.3 237.35 188.3 238.05 189.1 238.295703125 189.362109375 238.45 189.65 238.7671875 190.276953125 238.7 191.05 Z"/>
					<path fill="#F2563B" stroke="none" d=" M 351.95 211.2 L 351.8 211.2 346.05 215.1 346.05 225.2 351.95 221.6 351.95 211.2 Z"/>
					<path id="Layer6_0_1_STROKES" class="windowRims" stroke="#AE663D" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" fill="none" d="
	M 198.55 204.75
	L 208.35 211.1 208.45 216.8 208.6 222.5 198.8 216.15 188.95 209.8 188.8 204.1 188.65 198.4 198.55 204.75 198.65 210.45 208.45 216.8
	M 198.8 216.15
	L 198.65 210.45 188.8 204.1"/>
					<path id="Layer5_0_1_STROKES" class="windowRims" stroke="#AE663D" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" fill="none" d="
	M 325.25 215.35
	L 325.4 221 318.55 217.55 311.7 214.1 311.6 208.45 311.5 202.75 318.4 206.2 325.2 209.7 325.25 215.35 318.45 211.9 318.55 217.55
	M 318.4 206.2
	L 318.45 211.9 311.6 208.45"/>
				</defs>
				<g id="shadow">
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use xlink:href="#bottomShadow"/>
					</g>
				</g>
				<g transform="matrix( 1, 0, 0, 1, 0,0) ">
					<use xlink:href="#sun"/>
				</g>
				<g id="earth">
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer52_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer51_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer50_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer48_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer47_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer46_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer45_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer44_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer43_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer41_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer40_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer38_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer37_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer36_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer35_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer34_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#windowFour"/>
						<use class="element" xlink:href="#Layer32_0_1_STROKES"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer30_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer27_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer26_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer25_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer24_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer22_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer21_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer20_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer19_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer18_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer17_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer16_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer8_0_FILL"/>
						<use class="element" xlink:href="#windowTwo"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer7_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#windowOne"/>
						<use class="element" xlink:href="#Layer6_0_1_STROKES"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#windowThree"/>
						<use class="element" xlink:href="#Layer5_0_1_STROKES"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer2_0_FILL"/>
					</g>
				</g>
			</svg>
			<! -- End of SVG file -->
			<! -- Moon/Sun Toggle -->
			<div id="toggleButton" class="day-toggle">
				<div class="sun-icon"></div>
				<label class="switch">
            <input id="toggleCheckbox" type="checkbox">
            <div class="slider"></div>
        </label>
				<div class="cloud-icon"></div>
			</div>
			<! -- Moon/Sun Toggle -->
			<! -- End of Container -->
		</div>
			</div>
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Zero Days</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">人生如逆旅    我亦是行人</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/14/JS如何统一滚动条样式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李斌">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/tx.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zero Days">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">JS如何统一滚动条样式</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-14T00:21:47+08:00">
                2019-05-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="CSS滚动条样式"><a href="#CSS滚动条样式" class="headerlink" title="CSS滚动条样式"></a>CSS滚动条样式</h3><p>之前重构微博私信的时候,<strong><a href="https://api.weibo.com/chat/#/chat" target="_blank" rel="noopener"><font color="#ff0000">地址</font></a></strong>,要保持各个浏览器滚动条样式的统一。<br>在webkit内核浏览器我们可以这样定义整个页面的滚动条样式:<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">::-webkit-scrollbar &#123;  //隐藏滚轮display: none;</span><br><span class="line">	<span class="selector-tag">width</span>: 6<span class="selector-tag">px</span>;</span><br><span class="line">	<span class="selector-tag">height</span>: 6<span class="selector-tag">px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-pseudo">::-webkit-scrollbar-track-piece</span> &#123;</span><br><span class="line">	<span class="attribute">background</span>: <span class="number">#eee</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-pseudo">::-webkit-scrollbar-thumb</span><span class="selector-pseudo">:vertical</span> &#123;</span><br><span class="line">	<span class="attribute">background</span>: <span class="number">#666</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>其他浏览器我们可以使用CSS自己写一个div模拟滚动条：</p>
<p><img src="/2019/05/14/JS如何统一滚动条样式/1.gif" alt></p>
<h3 id="如何知道滚动条宽度"><a href="#如何知道滚动条宽度" class="headerlink" title="如何知道滚动条宽度"></a>如何知道滚动条宽度</h3><blockquote>
<p>util.js</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> cached</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getScrollBarSize</span>(<span class="params">fresh</span>) </span>&#123;    <span class="comment">//获取滚动条宽度</span></span><br><span class="line">	<span class="keyword">if</span>(fresh || cached === <span class="literal">undefined</span>) &#123;</span><br><span class="line">		<span class="keyword">const</span> inner = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>)</span><br><span class="line">		inner.style.width = <span class="string">'100%'</span></span><br><span class="line">		inner.style.height = <span class="string">'200px'</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">const</span> outer = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>)</span><br><span class="line">		<span class="keyword">const</span> outerStyle = outer.style</span><br><span class="line"></span><br><span class="line">		outerStyle.position = <span class="string">'absolute'</span></span><br><span class="line">		outerStyle.top = <span class="number">0</span></span><br><span class="line">		outerStyle.left = <span class="number">0</span></span><br><span class="line">		outerStyle.pointerEvents = <span class="string">'none'</span></span><br><span class="line">		outerStyle.visibility = <span class="string">'hidden'</span></span><br><span class="line">		outerStyle.width = <span class="string">'200px'</span></span><br><span class="line">		outerStyle.height = <span class="string">'150px'</span></span><br><span class="line">		outerStyle.overflow = <span class="string">'hidden'</span></span><br><span class="line"></span><br><span class="line">		outer.appendChild(inner)</span><br><span class="line"></span><br><span class="line">		<span class="built_in">document</span>.body.appendChild(outer)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">const</span> widthContained = inner.offsetWidth</span><br><span class="line">		outer.style.overflow = <span class="string">'scroll'</span></span><br><span class="line">		<span class="keyword">let</span> widthScroll = inner.offsetWidth</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(widthContained === widthScroll) &#123;</span><br><span class="line">			widthScroll = outer.clientWidth</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">document</span>.body.removeChild(outer)</span><br><span class="line"></span><br><span class="line">		cached = widthContained - widthScroll</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> cached || <span class="number">15</span>     <span class="comment">//MAC可以设置滚动条显示形式</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> debounce = <span class="function"><span class="keyword">function</span>(<span class="params">func, wait, immediate</span>) </span>&#123;   <span class="comment">//节流</span></span><br><span class="line">	<span class="keyword">let</span> timeout, args, context, timestamp, result;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">let</span> later = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">let</span> last = <span class="built_in">Date</span>.now() - timestamp; <span class="comment">// 获取现在与上一次防抖函数的运行间隔时间</span></span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(last &lt; wait &amp;&amp; last &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="comment">// 间隔太小，频率过多，继续延迟</span></span><br><span class="line">			timeout = setTimeout(later, wait - last); <span class="comment">// wait - last为接下来不触发防抖的期望时间</span></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			timeout = <span class="literal">null</span>; <span class="comment">// 间隔够长，运行函数</span></span><br><span class="line">			<span class="keyword">if</span>(!immediate) &#123;</span><br><span class="line">				result = func.apply(context, args);</span><br><span class="line">				<span class="keyword">if</span>(!timeout) context = args = <span class="literal">null</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">..._args</span>) </span>&#123;</span><br><span class="line">		context = <span class="keyword">this</span>;</span><br><span class="line">		args = _args;</span><br><span class="line">		timestamp = <span class="built_in">Date</span>.now(); <span class="comment">//刷新最新一次调用该防抖函数的时间戳</span></span><br><span class="line">		<span class="keyword">let</span> callNow = immediate &amp;&amp; !timeout; <span class="comment">// 是否需要立即调用一次，</span></span><br><span class="line">		<span class="keyword">if</span>(!timeout) timeout = setTimeout(later, wait); <span class="comment">// 同一时间内只存在一个超时</span></span><br><span class="line">		<span class="keyword">if</span>(callNow) &#123;</span><br><span class="line">			<span class="comment">// 立即调用一次</span></span><br><span class="line">			result = func.apply(context, args);</span><br><span class="line">			context = args = <span class="literal">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// 短时间内触发多次不会调用原函数</span></span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">randomColor</span>(<span class="params"></span>) </span>&#123;   <span class="comment">//生成随机色</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'#'</span> + (<span class="string">'00000'</span> + (<span class="built_in">Math</span>.random() * <span class="number">0x1000000</span> &lt;&lt; <span class="number">0</span>).toString(<span class="number">16</span>)).slice(<span class="number">-6</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>scrollbars.vue</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"scroller-wrapper"</span> <span class="attr">ref</span>=<span class="string">"wrapper"</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content-wrapper"</span> <span class="attr">ref</span>=<span class="string">"slot"</span> @<span class="attr">scroll</span>=<span class="string">"onScrollHandle"</span> @<span class="attr">mouseenter</span>=<span class="string">"showBar"</span> @<span class="attr">mouseleave</span>=<span class="string">"yLeaveHandle"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"y-bar-outer bar"</span> <span class="attr">ref</span>=<span class="string">"ybar"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span> </span></span><br><span class="line"><span class="tag">				@<span class="attr">mousedown</span>=<span class="string">"yMouseDownHandle"</span> </span></span><br><span class="line"><span class="tag">				<span class="attr">:class</span>=<span class="string">"&#123;move:move.yMouseDown&#125;"</span> </span></span><br><span class="line"><span class="tag">				<span class="attr">:style</span>=<span class="string">"`height:$&#123;yBarHeight&#125;px;opacity:$&#123;yBarOpa&#125;;transform:translateY($&#123;yInnerTop&#125;px)`"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">	<span class="keyword">import</span> &#123; getScrollBarSize, debounce, randomColor &#125; <span class="keyword">from</span> <span class="string">"./util.js"</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">	<span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">		props: &#123;</span><br><span class="line"><span class="javascript">			autoHide: &#123;   <span class="comment">//滚动条自动隐藏</span></span></span><br><span class="line"><span class="javascript">				type: <span class="built_in">Boolean</span>,</span></span><br><span class="line"><span class="javascript">				<span class="keyword">default</span>: <span class="literal">false</span></span></span><br><span class="line">			&#125;,</span><br><span class="line">			forData: &#123;</span><br><span class="line"><span class="javascript">		      type: [<span class="built_in">Array</span>,<span class="built_in">Number</span>],</span></span><br><span class="line"><span class="javascript">		      <span class="keyword">default</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">		        <span class="keyword">return</span> [];</span></span><br><span class="line">		      &#125;</span><br><span class="line">		    &#125;,</span><br><span class="line">			ScrollTop:&#123;</span><br><span class="line"><span class="javascript">				type: <span class="built_in">Number</span>,</span></span><br><span class="line"><span class="javascript">				<span class="keyword">default</span>: <span class="number">0</span></span></span><br><span class="line">			&#125;,</span><br><span class="line">			listenScrollBottom: &#123;</span><br><span class="line"><span class="javascript">				type: [<span class="built_in">Function</span>, <span class="built_in">Boolean</span>],</span></span><br><span class="line"><span class="javascript">				<span class="keyword">default</span>: <span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;</span></span><br><span class="line">			&#125;,</span><br><span class="line">			listenScrollTop:&#123;</span><br><span class="line"><span class="javascript">				type: [<span class="built_in">Function</span>, <span class="built_in">Boolean</span>],</span></span><br><span class="line"><span class="javascript">				<span class="keyword">default</span>: <span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;</span></span><br><span class="line">			&#125;,</span><br><span class="line">			listenScroll:&#123;</span><br><span class="line"><span class="javascript">				type: [<span class="built_in">Function</span>, <span class="built_in">Boolean</span>],</span></span><br><span class="line"><span class="javascript">				<span class="keyword">default</span>: <span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line"></span><br><span class="line">		data() &#123;</span><br><span class="line"><span class="javascript">			<span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">				yBarHeight: <span class="number">0</span>,  <span class="comment">//滑块高度</span></span></span><br><span class="line"><span class="javascript">				yBarOpa: <span class="number">1</span>,   <span class="comment">//滑块透明度</span></span></span><br><span class="line"><span class="javascript">				yInnerTop: <span class="number">0</span>,   <span class="comment">//滑块top距离</span></span></span><br><span class="line"></span><br><span class="line">				info: &#123;</span><br><span class="line"><span class="javascript">					<span class="comment">// 刷新的时候才更新 减少读取 增加性能</span></span></span><br><span class="line"><span class="javascript">					wrapperHeight: <span class="number">0</span>,   <span class="comment">//外容器高度</span></span></span><br><span class="line"><span class="javascript">					contentHeight: <span class="number">0</span>,   <span class="comment">//内部总高度</span></span></span><br><span class="line"><span class="javascript">					yBarHeight: <span class="number">0</span>       <span class="comment">//滑轨高度</span></span></span><br><span class="line">				&#125;,</span><br><span class="line">				move: &#123;</span><br><span class="line"><span class="javascript">					yMouseDown: <span class="literal">false</span>,</span></span><br><span class="line">					yMouseDownOffset: 0</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;;</span><br><span class="line">		&#125;,</span><br><span class="line">		mounted() &#123;</span><br><span class="line"><span class="javascript">			<span class="comment">// 注册节流函数</span></span></span><br><span class="line"><span class="javascript">			<span class="keyword">this</span>.debounceHide = debounce(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">				<span class="comment">// 放置在此处的判断是个妥协</span></span></span><br><span class="line"><span class="javascript">				<span class="comment">// 尽管会可读性 但是这个判断过于重要 几乎所有地方都需要达成条件才触发自动隐藏</span></span></span><br><span class="line"><span class="javascript">				<span class="comment">// 并且在外部判断 由于延时的特性会导致一些同步问题</span></span></span><br><span class="line"><span class="javascript">				<span class="keyword">if</span>(<span class="keyword">this</span>.autoHide &amp;&amp; !<span class="keyword">this</span>.move.yMouseDown) &#123;</span></span><br><span class="line"><span class="javascript">					<span class="keyword">this</span>.hideBar();</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;, 1000);</span><br><span class="line"></span><br><span class="line"><span class="javascript">			<span class="comment">// 提示用户可以滚动</span></span></span><br><span class="line"><span class="javascript">			<span class="keyword">if</span>(<span class="keyword">this</span>.autoHide) &#123;</span></span><br><span class="line"><span class="javascript">				<span class="keyword">this</span>.showBar();</span></span><br><span class="line"><span class="javascript">				<span class="keyword">this</span>.debounceHide();</span></span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line"><span class="javascript">			<span class="keyword">this</span>.refresh();</span></span><br><span class="line">		&#125;,</span><br><span class="line">		methods: &#123;</span><br><span class="line">			refresh() &#123;</span><br><span class="line"><span class="javascript">				<span class="keyword">this</span>.setContentOffset(); <span class="comment">//-17px</span></span></span><br><span class="line"><span class="javascript">				<span class="keyword">this</span>.reGetInfo(); <span class="comment">//获取滚动条信息</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">				<span class="keyword">if</span>(<span class="keyword">this</span>.info.contentHeight &lt;= <span class="keyword">this</span>.info.wrapperHeight + <span class="number">1</span>) &#123;</span></span><br><span class="line"><span class="javascript">					<span class="keyword">this</span>.yBarHeight = <span class="number">0</span>;</span></span><br><span class="line"><span class="javascript">				&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">					<span class="keyword">this</span>.yBarHeight = (<span class="keyword">this</span>.info.wrapperHeight / <span class="keyword">this</span>.info.contentHeight) * <span class="keyword">this</span>.info.yBarHeight;   <span class="comment">//高度百分比=&gt;滑块高度</span></span></span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line"><span class="javascript">        <span class="keyword">this</span>.onScrollHandle();   <span class="comment">//更新滑块top</span></span></span><br><span class="line">			&#125;,</span><br><span class="line">			setContentOffset() &#123;</span><br><span class="line"><span class="javascript">				<span class="comment">// 获取该设备的默认滚动条宽度 依赖这个宽度把滚动条顶出去</span></span></span><br><span class="line"><span class="javascript">				<span class="keyword">let</span> scrollBarWidth = getScrollBarSize();</span></span><br><span class="line"><span class="javascript">				<span class="keyword">this</span>.$refs.slot.style.marginRight = <span class="string">`<span class="subst">$&#123;-scrollBarWidth&#125;</span>px`</span>;</span></span><br><span class="line"><span class="javascript">				<span class="keyword">this</span>.$refs.slot.style.marginBottom = <span class="string">`<span class="subst">$&#123;-scrollBarWidth&#125;</span>px`</span>;</span></span><br><span class="line">			&#125;,</span><br><span class="line">			reGetInfo() &#123;</span><br><span class="line"><span class="javascript">				<span class="comment">// 获取基本的宽高信息</span></span></span><br><span class="line"><span class="javascript">				<span class="keyword">this</span>.info.wrapperHeight = <span class="keyword">this</span>.$refs.wrapper.clientHeight;</span></span><br><span class="line"><span class="javascript">				<span class="keyword">this</span>.info.contentHeight = <span class="keyword">this</span>.$refs.slot.children[<span class="number">0</span>].clientHeight;</span></span><br><span class="line"><span class="javascript">				<span class="keyword">this</span>.info.yBarHeight = <span class="keyword">this</span>.$refs.ybar.clientHeight;</span></span><br><span class="line">			&#125;,</span><br><span class="line">			onScrollHandle() &#123;</span><br><span class="line"><span class="javascript">				<span class="comment">// 自动隐藏</span></span></span><br><span class="line"><span class="javascript">				<span class="keyword">this</span>.showBar();</span></span><br><span class="line"><span class="javascript">				<span class="keyword">this</span>.debounceHide();</span></span><br><span class="line">				</span><br><span class="line"><span class="javascript">				<span class="keyword">const</span> slotScrollTop = <span class="keyword">this</span>.$refs.slot.scrollTop;</span></span><br><span class="line">				</span><br><span class="line"><span class="javascript">				<span class="keyword">const</span> yScrollPercent = slotScrollTop / <span class="keyword">this</span>.info.contentHeight;  <span class="comment">//计算scrollTop所占容器高度百分百</span></span></span><br><span class="line"><span class="javascript">				<span class="keyword">this</span>.yInnerTop = <span class="keyword">this</span>.info.yBarHeight * yScrollPercent;   <span class="comment">//滑块top</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">				<span class="keyword">this</span>.listenScroll(slotScrollTop);</span></span><br><span class="line"><span class="javascript">				<span class="comment">// 监听滚动到底部</span></span></span><br><span class="line"><span class="javascript">				<span class="keyword">if</span>(<span class="keyword">this</span>.listenScrollBottom) &#123;</span></span><br><span class="line"><span class="javascript">					<span class="keyword">const</span> bottomHeight = <span class="keyword">this</span>.info.contentHeight - <span class="keyword">this</span>.info.wrapperHeight - slotScrollTop;</span></span><br><span class="line">					</span><br><span class="line"><span class="javascript">					<span class="built_in">console</span>.log(<span class="string">'bottomHeight'</span>,bottomHeight)</span></span><br><span class="line">					</span><br><span class="line"><span class="javascript">					<span class="keyword">if</span>(bottomHeight &lt;= <span class="number">0.5</span>) &#123;</span></span><br><span class="line"><span class="javascript">						<span class="keyword">this</span>.listenScrollBottom();</span></span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line"><span class="javascript">				<span class="keyword">if</span>(<span class="keyword">this</span>.listenScrollTop) &#123;</span></span><br><span class="line"> </span><br><span class="line"><span class="javascript">					<span class="keyword">if</span>(slotScrollTop == <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="javascript">						<span class="keyword">this</span>.listenScrollTop();</span></span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;,</span><br><span class="line">			showBar() &#123;</span><br><span class="line"><span class="javascript">				<span class="keyword">this</span>.yBarOpa = <span class="number">1</span>;</span></span><br><span class="line">			&#125;,</span><br><span class="line">			hideBar() &#123;</span><br><span class="line"><span class="javascript">				<span class="keyword">this</span>.yBarOpa = <span class="number">0</span>;</span></span><br><span class="line">			&#125;,</span><br><span class="line">			yMouseDownHandle(e) &#123;</span><br><span class="line"><span class="javascript">				<span class="keyword">const</span> eventScreenY = e.screenY;</span></span><br><span class="line"><span class="javascript">				<span class="keyword">this</span>.move.yMouseDown = <span class="literal">true</span>;</span></span><br><span class="line"><span class="javascript">				<span class="keyword">this</span>.move.yMouseDownOffset = eventScreenY;</span></span><br><span class="line">				</span><br><span class="line"><span class="javascript">				<span class="keyword">this</span>.showBar();</span></span><br><span class="line">				</span><br><span class="line"><span class="javascript">				<span class="keyword">const</span> moveHandle = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span></span><br><span class="line">					e.preventDefault();</span><br><span class="line"><span class="javascript">					<span class="comment">// 计算出Y轴偏移和缩放比例 让content进行滚动</span></span></span><br><span class="line"><span class="javascript">					<span class="keyword">const</span> moveScreenY = e.screenY;</span></span><br><span class="line"><span class="javascript">					<span class="keyword">let</span> offsetY = moveScreenY - <span class="keyword">this</span>.move.yMouseDownOffset;</span></span><br><span class="line"><span class="javascript">					<span class="keyword">this</span>.move.yMouseDownOffset = moveScreenY;</span></span><br><span class="line"><span class="javascript">					<span class="keyword">let</span> scale = <span class="keyword">this</span>.info.contentHeight / <span class="keyword">this</span>.info.yBarHeight;</span></span><br><span class="line"><span class="javascript">					<span class="keyword">let</span> contentOffset = offsetY * scale;</span></span><br><span class="line"><span class="javascript">					<span class="keyword">this</span>.$refs.slot.scrollTop += contentOffset;</span></span><br><span class="line">				&#125;;</span><br><span class="line">				</span><br><span class="line"><span class="javascript">				<span class="built_in">document</span>.addEventListener(<span class="string">"mousemove"</span>, moveHandle);</span></span><br><span class="line">				</span><br><span class="line"><span class="javascript">				<span class="built_in">document</span>.addEventListener(<span class="string">"mouseup"</span>, e =&gt; &#123;</span></span><br><span class="line"><span class="javascript">					<span class="comment">// 清除监听 重设默认值</span></span></span><br><span class="line"><span class="javascript">					<span class="comment">// 自动隐藏</span></span></span><br><span class="line"><span class="javascript">					<span class="built_in">document</span>.removeEventListener(<span class="string">"mousemove"</span>, moveHandle);</span></span><br><span class="line"><span class="javascript">					<span class="keyword">this</span>.move.yMouseDown = <span class="literal">false</span>;</span></span><br><span class="line"><span class="javascript">					<span class="keyword">this</span>.move.yMouseDownOffset = <span class="number">0</span>;</span></span><br><span class="line"><span class="javascript">					<span class="keyword">this</span>.debounceHide();</span></span><br><span class="line">				&#125;);</span><br><span class="line">			&#125;,</span><br><span class="line">			yLeaveHandle() &#123;</span><br><span class="line"><span class="javascript">				<span class="keyword">if</span>(!<span class="keyword">this</span>.move.yMouseDown) &#123;</span></span><br><span class="line"><span class="javascript">					<span class="keyword">this</span>.debounceHide();</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		watch: &#123;</span><br><span class="line">		    forData(newVal) &#123;</span><br><span class="line"><span class="javascript">			    	<span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="javascript">			    		 <span class="keyword">this</span>.refresh();</span></span><br><span class="line">			    	&#125;)</span><br><span class="line">		    &#125;,</span><br><span class="line">		    ScrollTop(newVal)&#123;</span><br><span class="line"><span class="javascript">			    	<span class="built_in">console</span>.log(newVal)</span></span><br><span class="line"><span class="javascript">			    	<span class="keyword">this</span>.$refs.slot.scrollTop=newVal;</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">"stylus"</span>&gt;</span></span><br><span class="line"><span class="css">	<span class="selector-class">.scroller-wrapper</span> &#123;</span></span><br><span class="line">		position: absolute;</span><br><span class="line">		top: 0px;</span><br><span class="line">		left: 0px;</span><br><span class="line">		right: 0px;</span><br><span class="line">		bottom: 0px;</span><br><span class="line">		overflow: hidden;</span><br><span class="line"><span class="css">		<span class="selector-class">.content-wrapper</span> &#123;</span></span><br><span class="line">			position absolute;</span><br><span class="line">			top: 0;</span><br><span class="line">			left: 0;</span><br><span class="line">			right: 0;</span><br><span class="line">			bottom: 0;</span><br><span class="line">			margin-right: -15px;</span><br><span class="line">			margin-bottom: -15px;</span><br><span class="line">			overflow: scroll;</span><br><span class="line">		&#125;</span><br><span class="line"><span class="css">		<span class="selector-class">.y-bar-outer</span> &#123;</span></span><br><span class="line">			position: absolute;</span><br><span class="line">			width: 6px;</span><br><span class="line">			transition: opacity 200ms ease 0s;</span><br><span class="line">			opacity: 1;</span><br><span class="line">			right: 0px;</span><br><span class="line">			bottom: 0px;</span><br><span class="line">			top: 0px;</span><br><span class="line">			border-radius: 0px;</span><br><span class="line"><span class="css">			<span class="selector-class">.inner</span> &#123;</span></span><br><span class="line">				position: relative;</span><br><span class="line">				display: block;</span><br><span class="line">				width: 100%;</span><br><span class="line">				cursor: pointer;</span><br><span class="line">				border-radius: inherit;</span><br><span class="line">				background-color: red;</span><br><span class="line"><span class="css">				<span class="selector-tag">transition</span>: <span class="selector-tag">opacity</span> 0<span class="selector-class">.4s</span> <span class="selector-tag">ease</span>,<span class="selector-tag">height</span> <span class="selector-class">.6s</span> <span class="selector-tag">ease</span>;</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"><span class="css">		<span class="selector-class">.bar</span> &#123;</span></span><br><span class="line"><span class="css">			<span class="selector-class">.inner</span> &#123;</span></span><br><span class="line"><span class="css">				&amp;<span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line">					background-color: rgba(255, 0, 0, 1);</span><br><span class="line">				&#125;</span><br><span class="line"><span class="css">				&amp;<span class="selector-class">.move</span> &#123;</span></span><br><span class="line">					background-color: rgba(255, 0, 0, 1);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>App.vue</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"main"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">scrollbars</span> </span></span><br><span class="line"><span class="tag">				<span class="attr">autoHide</span></span></span><br><span class="line"><span class="tag">				<span class="attr">:forData</span>=<span class="string">"forData"</span></span></span><br><span class="line"><span class="tag">				<span class="attr">:ScrollTop</span>=<span class="string">"ScrollTop"</span></span></span><br><span class="line"><span class="tag">				<span class="attr">:listenScrollBottom</span>=<span class="string">"listenScrollBottom"</span> </span></span><br><span class="line"><span class="tag">				<span class="attr">:listenScrollTop</span>=<span class="string">"listenScrollTop"</span> </span></span><br><span class="line"><span class="tag">				<span class="attr">:listenScroll</span>=<span class="string">"listenScroll"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"scroll-con"</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"(item,index) in num"</span> <span class="attr">:style</span>=<span class="string">"&#123;height:`$&#123;item.height&#125;px`,lineHeight: `$&#123;item.height&#125;px`,background:`$&#123;LiRandomColor()&#125;`&#125;"</span>&gt;</span>&#123;&#123;index+1&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"> 					<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">scrollbars</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"add"</span>&gt;</span>增加<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">	<span class="keyword">import</span> Scrollbars <span class="keyword">from</span> <span class="string">"./components/scrollbars"</span>;</span></span><br><span class="line"><span class="javascript">	<span class="keyword">import</span> &#123; randomColor &#125; <span class="keyword">from</span> <span class="string">"./components/util.js"</span>;</span></span><br><span class="line"><span class="javascript">	<span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">		name:<span class="string">"app"</span>,</span></span><br><span class="line">		data()&#123;</span><br><span class="line"><span class="javascript">			<span class="keyword">return</span> &#123;</span></span><br><span class="line">				ScrollTop:0,</span><br><span class="line">				num:[]</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		mounted() &#123;</span><br><span class="line"><span class="javascript">			<span class="keyword">var</span> a=[];</span></span><br><span class="line"><span class="javascript">			<span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">30</span>;i++)&#123;</span></span><br><span class="line">				a.push(&#123;</span><br><span class="line"><span class="javascript">				   height:<span class="built_in">parseInt</span>(<span class="built_in">Math</span>.random()*<span class="number">40</span>+<span class="number">30</span>,<span class="number">10</span>)+<span class="number">1</span></span></span><br><span class="line">				&#125;)</span><br><span class="line">			&#125;</span><br><span class="line"><span class="javascript">			<span class="keyword">this</span>.num=a;</span></span><br><span class="line"><span class="javascript">			<span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="javascript">	    		   <span class="keyword">this</span>.ScrollTop=<span class="built_in">document</span>.querySelector(<span class="string">".scroll-con"</span>).clientHeight</span></span><br><span class="line">	    	    &#125;)</span><br><span class="line">		&#125;,</span><br><span class="line">		computed:&#123;</span><br><span class="line">			forData()&#123;</span><br><span class="line"><span class="javascript">			  <span class="keyword">return</span> <span class="keyword">this</span>.num.length</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		components: &#123;</span><br><span class="line">			Scrollbars</span><br><span class="line">		&#125;,</span><br><span class="line">		methods: &#123;</span><br><span class="line">			listenScrollBottom() &#123;</span><br><span class="line"><span class="javascript">				<span class="built_in">console</span>.log(<span class="string">"to bottom"</span>);</span></span><br><span class="line">			&#125;,</span><br><span class="line">			listenScrollTop() &#123;</span><br><span class="line"><span class="javascript">				<span class="built_in">console</span>.log(<span class="string">"to top"</span>);</span></span><br><span class="line">			&#125;,</span><br><span class="line">			listenScroll(valH)&#123;</span><br><span class="line"><span class="javascript">				<span class="comment">//console.log(valH);</span></span></span><br><span class="line">			&#125;,</span><br><span class="line">			add()&#123;</span><br><span class="line"><span class="javascript">				<span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span></span><br><span class="line"><span class="javascript">					<span class="keyword">this</span>.num.push(&#123;</span></span><br><span class="line"><span class="javascript">					   height:<span class="built_in">parseInt</span>(<span class="built_in">Math</span>.random()*<span class="number">40</span>+<span class="number">30</span>,<span class="number">10</span>)+<span class="number">1</span></span></span><br><span class="line">					&#125;)</span><br><span class="line">				&#125;</span><br><span class="line"><span class="javascript">				<span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="javascript">	    		   <span class="keyword">this</span>.ScrollTop=<span class="built_in">document</span>.querySelector(<span class="string">".scroll-con"</span>).clientHeight</span></span><br><span class="line">	    	    &#125;)</span><br><span class="line">			&#125;,</span><br><span class="line">			LiRandomColor()&#123;</span><br><span class="line"><span class="javascript">				<span class="keyword">return</span>  randomColor();</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">	* &#123;</span><br><span class="line">		padding: 0px;</span><br><span class="line">		margin: 0px;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"><span class="css">	<span class="selector-id">#app</span> &#123;</span></span><br><span class="line">		font-family: "Avenir", Helvetica, Arial, sans-serif;</span><br><span class="line"><span class="css">		<span class="selector-tag">color</span>: <span class="selector-id">#2c3e50</span>;</span></span><br><span class="line">		margin-top: 60px;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	h1,</span><br><span class="line">	h2 &#123;</span><br><span class="line">		font-weight: normal;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	ul &#123;</span><br><span class="line">		list-style-type: none;</span><br><span class="line">		padding: 0;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	li &#123;</span><br><span class="line">		color: red;</span><br><span class="line">		display: block;</span><br><span class="line">		height: 30px;</span><br><span class="line">		line-height: 30px;</span><br><span class="line"><span class="css">		<span class="selector-tag">background</span>:<span class="selector-id">#aaa</span>;</span></span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"><span class="css">    <span class="selector-tag">li</span><span class="selector-pseudo">:nth-child(2n)</span>&#123;</span></span><br><span class="line"><span class="css">		<span class="selector-tag">background</span>: <span class="selector-id">#eee</span>;</span></span><br><span class="line">	&#125;</span><br><span class="line">	a &#123;</span><br><span class="line"><span class="css">		<span class="selector-tag">color</span>: <span class="selector-id">#42b983</span>;</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"><span class="css">	<span class="selector-class">.inner</span> &#123;</span></span><br><span class="line"><span class="css">		<span class="selector-tag">background-color</span>: <span class="selector-id">#ccc</span>;</span></span><br><span class="line"><span class="css">		<span class="selector-tag">color</span>: <span class="selector-id">#fff</span>;</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"><span class="css">	<span class="selector-class">.main</span> &#123;</span></span><br><span class="line">		height: 400px;</span><br><span class="line">		width: 790px;</span><br><span class="line">		margin: 0 auto;</span><br><span class="line">		border: 1px solid red;</span><br><span class="line">		position: relative;</span><br><span class="line"> </span><br><span class="line">	&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="增加list项闪烁问题"><a href="#增加list项闪烁问题" class="headerlink" title="增加list项闪烁问题"></a>增加list项闪烁问题</h3><p><img src="/2019/05/14/JS如何统一滚动条样式/2.gif" alt><br>之前尝试过Vue.nextTick 解决，发现效果不太好。<strong> <font color="#dd0000">解决办法就是插入数据的时候先移除一个数据，保持列表永远只有固定数目的数据！</font> </strong></p>
<h3 id="自定义滚动条的实现思路与关键算法"><a href="#自定义滚动条的实现思路与关键算法" class="headerlink" title="自定义滚动条的实现思路与关键算法"></a><a href="https://juejin.im/post/5cde85dfe51d45108f254145" target="_blank" rel="noopener">自定义滚动条的实现思路与关键算法</a></h3><h3 id="前端必备自定义滚动库——iScroll"><a href="#前端必备自定义滚动库——iScroll" class="headerlink" title="前端必备自定义滚动库——iScroll"></a><a href="https://juejin.im/post/5bc57e616fb9a05d396f3fc9" target="_blank" rel="noopener">前端必备自定义滚动库——iScroll</a></h3>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/滚动条/" rel="tag"># 滚动条</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/05/03/知否-？知否-？React插件了解一下！/" rel="next" title="知否 ？知否 ？React插件了解一下！">
                <i class="fa fa-chevron-left"></i> 知否 ？知否 ？React插件了解一下！
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/05/22/7个有用的Vue开发技巧/" rel="prev" title="7个有用的Vue开发技巧">
                7个有用的Vue开发技巧 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/tx.jpg" alt="李斌">
            
              <p class="site-author-name" itemprop="name">李斌</p>
              <p class="site-description motion-element" itemprop="description">人生如逆旅     我亦是行人</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">194</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">121</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/libin1991" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://juejin.im/user/57e737f6c4c971005f6bcd8d" target="_blank" title="juejin">
                      
                        <i class="fa fa-fw fa-spinner"></i>juejin</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#CSS滚动条样式"><span class="nav-number">1.</span> <span class="nav-text">CSS滚动条样式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何知道滚动条宽度"><span class="nav-number">2.</span> <span class="nav-text">如何知道滚动条宽度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#增加list项闪烁问题"><span class="nav-number">3.</span> <span class="nav-text">增加list项闪烁问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自定义滚动条的实现思路与关键算法"><span class="nav-number">4.</span> <span class="nav-text">自定义滚动条的实现思路与关键算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#前端必备自定义滚动库——iScroll"><span class="nav-number">5.</span> <span class="nav-text">前端必备自定义滚动库——iScroll</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">李斌</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

  
  <!--
  	描述：点击红心
  -->
  <script type="text/javascript" src="/js/src/clicklove.js"></script>
  <!--
  	描述：复制代码
  -->
  <script type="text/javascript" src="/js/src/clipboard.min.js"></script>
  <script type="text/javascript" src="/js/src/clipboard-use.js"></script>
</body>
</html>


