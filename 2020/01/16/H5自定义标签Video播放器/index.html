<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="Web Components才是组件化的未来 上一时代的牺牲品是jQuery，如今Web Components被越来越多的浏览器所支持，React,Vue或许是下一个“祭品”。  组件化、复用，这几乎是所有开发者追求的东西。Web Components就是为此而提出。可以使用来创建封装功能的定制元素，可以在你喜欢的任何地方重用，不必担心代码冲突。 这样的理念和Vue十分相似，专注于组件。所以Web">
<meta property="og:type" content="article">
<meta property="og:title" content="H5自定义标签Video播放器">
<meta property="og:url" content="http://yoursite.com/2020/01/16/H5自定义标签Video播放器/index.html">
<meta property="og:site_name" content="奔向未来的日子">
<meta property="og:description" content="Web Components才是组件化的未来 上一时代的牺牲品是jQuery，如今Web Components被越来越多的浏览器所支持，React,Vue或许是下一个“祭品”。  组件化、复用，这几乎是所有开发者追求的东西。Web Components就是为此而提出。可以使用来创建封装功能的定制元素，可以在你喜欢的任何地方重用，不必担心代码冲突。 这样的理念和Vue十分相似，专注于组件。所以Web">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://user-images.githubusercontent.com/16753554/72352234-d297d800-371c-11ea-884c-edbce45aa1cb.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/16753554/72330395-69e73600-36f1-11ea-8e15-8f63051dce53.png">
<meta property="og:updated_time" content="2020-01-14T14:31:51.836Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="H5自定义标签Video播放器">
<meta name="twitter:description" content="Web Components才是组件化的未来 上一时代的牺牲品是jQuery，如今Web Components被越来越多的浏览器所支持，React,Vue或许是下一个“祭品”。  组件化、复用，这几乎是所有开发者追求的东西。Web Components就是为此而提出。可以使用来创建封装功能的定制元素，可以在你喜欢的任何地方重用，不必担心代码冲突。 这样的理念和Vue十分相似，专注于组件。所以Web">
<meta name="twitter:image" content="https://user-images.githubusercontent.com/16753554/72352234-d297d800-371c-11ea-884c-edbce45aa1cb.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/01/16/H5自定义标签Video播放器/">





  <title>H5自定义标签Video播放器 | 奔向未来的日子</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband">
    	<div class="eevee"><div class="body"><div class="head"><div class="ears"><div class="ear"><div class="lobe"></div></div><div class="ear"><div class="lobe"></div></div></div><div class="face"><div class="eyes"><div class="eye"><div class="eyelid"></div></div><div class="eye"><div class="eyelid"></div></div></div><div class="nose"></div><div class="mouth"></div></div></div><div class="chest"><div class="fur"><div class="patch"></div></div><div class="fur"><div class="patch"></div></div><div class="fur"><div class="patch"></div></div></div><div class="legs"><div class="leg"><div class="inner-leg"></div></div><div class="leg"><div class="inner-leg"></div></div><div class="leg"><div class="inner-leg"></div></div><div class="leg"><div class="inner-leg"></div></div></div><div class="tail"><div class="tail"><div class="tail"><div class="tail"><div class="tail"><div class="tail -end"></div></div></div></div></div></div></div></div>
    </div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
    	<div id="sky">
				<div id="background" class="container">
			<!-- svg file -->
			<svg id="svgout" height="100%" width="100%" viewbox="0 0 550 400">
				<defs>
					<g id="bottomShadow">
						<path fill="#000000" stroke="none" d="
		M 270.5 225.95
		L 127.35 316.65 266.8 400 409.6 309.25 270.5 225.95 Z"/>
					</g>
					<g id="Layer52_0_FILL">
						<path class="topGrass" fill="#B9D668" stroke="none" d="
	M 397.85 229.3
	L 397.85 225.6 269.85 152 135.75 228.6 135.75 233.65 262.1 306.55 397.85 229.3 Z"/>
					</g>
					<g id="Layer51_0_FILL">
						<path class="leftSideGrass" fill="#6E9E4F" stroke="none" d="
	M 135.1 229.95
	L 135.1 256.85 262.1 328.4 262.1 301.85 135.1 229.95 Z"/>
					</g>
					<g id="Layer50_0_FILL">
						<path class="rightGrassTop" fill="#8CB154" stroke="none" d="
	M 397.85 225.95
	L 395.8 225.95 261.75 301.55 261.75 328.4 397.85 251.15 397.85 225.95 Z"/>
					</g>
					<g id="Layer48_0_FILL">
						<path class="crustLeftTop" fill="#955541" stroke="none" d="
	M 135.45 282.4
	L 135.75 298.15 262.1 372.1 261.75 355.65 135.45 282.4 Z"/>
					</g>
					<g id="Layer47_0_FILL">
						<path class="middleLeftCrust" fill="#C77E61" stroke="none" d="
	M 135.1 270.3
	L 135.1 283.05 275.9 364.35 271.85 348.9 135.1 270.3 Z"/>
					</g>
					<g id="Layer46_0_FILL">
						<path class="crustLeftTop" fill="#955541" stroke="none" d="
	M 135.1 255.15
	L 135.1 270.3 262.1 343.55 262.1 328.05 135.1 255.15 Z"/>
					</g>
					<g id="Layer45_0_FILL">
						<path class="topRightCrust" fill="#A47237" stroke="none" d="
	M 397.5 294.5
	L 397.5 277 261.75 355.3 261.75 372.75 397.5 294.5 Z"/>
					</g>
					<g id="Layer44_0_FILL">
						<path class="middleRightCrust" fill="#C89451" stroke="none" d="
	M 397.5 269.95
	L 397.15 266.6 262.1 343.2 262.1 355.95 397.5 279.7 397.5 269.95 Z"/>
					</g>
					<g id="Layer43_0_FILL">
						<path class="topRightCrust" fill="#A47237" stroke="none" d="
	M 397.5 266.6
	L 397.5 250.45 261.75 328.4 261.75 343.85 397.5 266.6 Z"/>
					</g>
					<g id="Layer41_0_FILL">
						<path class="greyRoad" fill="#B2B2B1" stroke="none" d="
	M 295.05 283.05
	Q 299.05 280.35 308.45 275.3 317.85 269.95 323.6 266.9
	L 268.8 233.65 338.05 191.35 309.15 174.55 177.75 254.5
	Q 191.55 262.2 198.25 266.25 204.65 269.95 209.7 271.95
	L 241.6 250.45 295.05 283.05 Z"/>
					</g>
					<g id="Layer40_0_FILL">
						<path fill="#FFFFFF" stroke="none" d="
	M 199.95 256.85
	Q 194.55 261.2 191.9 262.2
	L 194.9 263.9 200.95 259.2 199.95 256.85
	M 225.8 243.75
	L 224.8 241.75 211.05 250.8 212.05 252.8 225.8 243.75
	M 308.15 275.65
	L 296.7 266.6 295.35 268.6 306.8 277.7 308.15 275.65
	M 275.9 253.5
	L 274.55 255.5 285.95 264.55 287.3 262.55 275.9 253.5
	M 251.7 227.3
	L 250.7 225.25 236.9 234.35 237.9 236.35 251.7 227.3
	M 257.05 240.7
	L 254.05 240.7 268.8 249.8 269.5 247.75 257.05 240.7
	M 277.2 207.8
	L 263.45 216.85 264.45 218.9 278.25 209.8 277.2 207.8
	M 305.1 192.65
	L 304.1 190.65 290.3 199.75 291.35 201.75 305.1 192.65 Z"/>
					</g>
					<g id="Layer38_0_FILL">
						<path class="frontFascia" fill="#ECB27B" stroke="none" d="
	M 359.25 187.95
	L 346.4 174.95 333.85 202.9 359.25 187.95 Z"/>
					</g>
					<g id="Layer37_0_FILL">
						<path class="frontWall" fill="#EFA258" stroke="none" d="
	M 334 201.05
	L 334.35 232 359.2 217.55 359.25 187.95 334 201.05 Z"/>
					</g>
					<g id="Layer36_0_FILL">
						<path class="leftWall" fill="#C57F42" stroke="none" d="
	M 334.35 232.3
	L 334.35 205.1 305.1 191.35 305.1 216.85 334.35 232.3 Z"/>
					</g>
					<g id="Layer35_0_FILL">
						<path class="rightRoof" fill="#EF4427" stroke="none" d="
	M 329.7 167.9
	L 331.05 167.9 344.55 176.7 347.85 176.7 363 192.25 363.15 189.55 350.65 176.7 350.55 176.7 334.25 167.5 334.25 159.1 329.7 159.1 329.7 164.9 322.65 160.95 322.3 162.15 329.7 167 329.7 167.9 Z"/>
					</g>
					<g id="Layer34_0_FILL">
						<path class="leftRoof" fill="#F2563B" stroke="none" d="
	M 334.05 207.05
	L 350.65 176.7 322.1 160.45 302.1 192.05 334.05 207.05 Z"/>
					</g>
					<g id="Layer30_0_FILL">
						<path id="windowFour" class="windows" stroke="none" fill="#975A42" d="
	M 341.35 203.3
	Q 340.9 203.45 340.5 203.8 340.1 204.2 339.85 204.75 339.7 205 339.7 205.3 339.6 205.75 339.7 206.1 339.7 206.15 339.7 206.2 339.8 206.5 340 206.8 340.55 207.4 341.45 207.4 342.35 207.4 343 206.8 343.4 206.5 343.65 206.1 343.85 205.75 343.95 205.3 344.05 204.4 343.55 203.8 343.3 203.45 343 203.3 342.65 203.15 342.2 203.15 341.8 203.15 341.35 203.3
	M 355.85 198.45
	Q 355.8 198.2 355.6 198 355.1 197.4 354.2 197.4 353.35 197.4 352.6 198 351.85 198.65 351.7 199.55 351.7 199.7 351.7 199.85 351.6 200.5 352 201.05 352.55 201.65 353.45 201.65 354.3 201.65 355.05 201.05 355.45 200.7 355.7 200.25 355.8 200.05 355.9 199.85 355.95 199.7 355.95 199.55 356.05 198.95 355.85 198.45 Z"/>
						<path class="door" fill="#B65041" stroke="none" d="
	M 351.95 211.2
	L 351.8 211.2 346.05 215.1 346.05 225.2 351.95 221.6 351.95 211.2
	M 351.2 211.2
	L 351.35 211.2 351.35 211.1 351.2 211.2 Z"/>
					</g>
					<g>
						<path id="Layer30_0_FILL" fill="#000000" fill-opacity="1" stroke="none" d="
	M 183.7 215.3
	L 183.7 215.6
	Q 187.25 231.75 212.25 234.35
	L 183.7 215.3 Z"/>
					</g>
					<g id="Layer29_0_FILL">
						<path fill="#000000" fill-opacity="0.4" stroke="none" d="
	M 305.1 216.85
	L 305.15 217.2
	Q 309.45 233.2 334.35 232.3
	L 305.1 216.85 Z"/>
					</g>
					<g id="Layer27_0_FILL">
						<path class="vegetation" fill="#78A950" stroke="none" d="
	M 177.45 231.65
	Q 175.75 235.35 181.8 239.35 185.5 235.7 185.15 231.3 182.8 230.65 181.45 234 179.45 231.3 177.45 231.65
	M 236.9 266.6
	Q 235.2 270.3 241.25 274.3 244.95 270.6 244.65 266.25 242.3 265.6 240.95 268.95 238.9 266.25 236.9 266.6
	M 254.7 277
	Q 253.05 280.7 259.1 284.75 262.75 281.05 262.45 276.65 260.1 276 258.75 279.35 256.7 276.65 254.7 277
	M 315.5 245.75
	Q 313.5 243.05 311.5 243.4 309.8 247.1 315.85 251.15 319.55 247.45 319.2 243.05 316.85 242.4 315.5 245.75
	M 295.35 232.65
	Q 293.7 236.35 299.75 240.4 303.45 236.7 303.1 232.3 300.75 231.65 299.4 235 297.4 232.3 295.35 232.65
	M 277.2 171.85
	Q 275.55 175.55 281.6 179.55 285.3 175.85 284.95 171.5 282.6 170.85 281.25 174.2 279.25 171.5 277.2 171.85 Z"/>
					</g>
					<g id="Layer26_0_FILL">
						<path class="treeWood" fill="#AE663D" stroke="none" d="
	M 175.1 177.55
	L 172.05 177.55 172.05 191.1 159.3 172.85
	Q 154.6 171.5 172.05 195.7
	L 172.05 212.5 175.1 212.5 175.1 177.55
	M 252.7 151.35
	L 249 151.35 249 176.9 252.7 176.9 252.7 151.35 Z"/>
					</g>
					<g id="Layer25_0_FILL">
						<path class="vegetation" fill="#77A951" stroke="none" d="
	M 192.55 179.55
	Q 200.95 173.5 200.95 165.1 200.95 156.4 192.55 150 184.15 144.3 172.05 144.3 160.3 144.3 151.9 150 143.15 156.4 143.15 165.1 143.15 173.5 151.9 179.55 160.3 185.95 172.05 185.95 184.15 185.95 192.55 179.55
	M 236.25 106.65
	Q 230.2 116.05 230.2 129.15 230.2 142.25 236.25 151.35 242.3 160.75 250.7 160.75 258.75 160.75 264.8 151.35 270.85 142.25 270.85 129.15 270.85 116.05 264.8 106.65 258.75 97.6 250.7 97.6 242.3 97.6 236.25 106.65 Z"/>
					</g>
					<g id="Layer24_0_FILL">
						<path class="vegetation" fill="#77A951" stroke="none" d="
	M 158.3 221.9
	Q 160.65 221.9 161.95 220.2 163 219.55 163.3 218.55 164.65 218.9 166.35 218.9 170.05 218.9 172.4 216.2 175.1 213.85 175.1 210.15 175.1 206.45 172.4 203.75 170.05 201.4 166.35 201.4 162.65 201.4 159.95 203.75 157.6 206.45 157.6 210.15 157.6 210.8 157.6 211.15 155.95 211.5 154.6 212.5 152.9 214.15 152.9 216.55 152.9 218.9 154.6 220.2 156.25 221.9 158.3 221.9
	M 338.35 240.05
	Q 341.05 237.7 341.05 234 341.05 230.3 338.35 227.6 336 225.25 332.3 225.25 328.65 225.25 325.95 227.6 323.6 230.3 323.6 234 323.6 237.7 325.95 240.05 328.65 242.75 332.3 242.75 336 242.75 338.35 240.05 Z"/>
					</g>
					<g id="Layer22_0_FILL">
						<path class="rightRoof" fill="#D05041" stroke="none" d="
	M 220 173.85
	L 236.8 186.7 264.35 171.15 244.5 159.55 220 173.85 Z"/>
					</g>
					<g id="Layer21_0_FILL">
						<path class="leftWall" fill="#C57F42" stroke="none" d="
	M 212.25 191.35
	L 183.35 172.3 183.7 215.3 212.25 234.35 212.25 191.35 Z"/>
					</g>
					<g id="Layer20_0_FILL">
						<path class="rightRoof" fill="#EF4427" stroke="none" d="
	M 192.1 149.85
	L 236.45 174.8 243.1 171.4
	Q 220.05 150.55 196.3 139.95
	L 192.1 149.85 Z"/>
					</g>
					<g id="Layer19_0_FILL">
						<path class="frontFascia" fill="#EBB17B" stroke="none" d="
	M 226.85 160.95
	L 212 190.6 229.75 192.6 239.75 172.85 226.85 160.95 Z"/>
					</g>
					<g id="Layer18_0_FILL">
						<path class="frontWall" fill="#EFA258" stroke="none" d="
	M 240.15 172.65
	L 211.9 191.6 212.25 233.65 264.35 201.7 264.35 170.8 240.8 184.45 240.15 172.65 Z"/>
					</g>
					<g id="Layer17_0_FILL">
						<path class="rightRoof" fill="#EF4427" stroke="none" d="
	M 210.9 142.2
	L 205.9 142.2 205.9 152.65 210.9 152.65 210.9 142.2 Z"/>
					</g>
					<g>
						<path id="Layer16_0_FILL" class="leftRoof" fill="#F2563B" stroke="none" d="
	M 210.25 195.5
	L 227.4 160.95 195.45 141.35 177.65 175.85 210.25 195.5 Z"/>
					</g>
					<g>
						<path id="sun" fill="#E3BD0E" stroke="none" d="
	M 257.05 15.95
	Q 251.7 15.95 248 19.65 244.3 23.35 244.3 28.7 244.3 34.1 248 37.8 251.7 41.5 257.05 41.5 262.45 41.5 266.15 37.8 269.85 34.1 269.85 28.7 269.85 23.35 266.15 19.65 262.45 15.95 257.05 15.95 Z"/>
					</g>
					<g id="Layer8_0_FILL">
						<path fill="#975A42" stroke="none" d="
	M 238.45 189.65
	Q 238.295703125 189.362109375 238.05 189.1 237.35 188.3 236.2 188.3 235.05 188.3 234.15 189.1 233.3 189.9 233.2 191.05 233.1 192.2 233.8 193 234.55 193.8 235.7 193.8 236.85 193.8 237.7 193 238.1970703125 192.558203125 238.45 192 238.6552734375 191.56484375 238.7 191.05 238.7671875 190.276953125 238.45 189.65
	M 220.55 197.55
	Q 220 197.55 219.5 197.75 218.95 197.95 218.5 198.35 217.933203125 198.8833984375 217.7 199.55 217.5833984375 199.916796875 217.55 200.3 217.4923828125 200.96171875 217.7 201.5 217.852734375 201.9103515625 218.15 202.25 218.95 203.05 220.1 203.05 221.25 203.05 222.05 202.25 222.95 201.45 223.05 200.3 223.15 199.15 222.4 198.35 222.05 197.95 221.65 197.75 221.15 197.55 220.55 197.55 Z"/>
					</g>
					<g id="Layer7_0_FILL">
						<path class="door" fill="#B65041" stroke="none" d="
	M 233.55 206.75
	L 225.9 211.95 226.25 225.5 233.95 220.35 233.55 206.75 Z"/>
					</g>
					<g>
						<path id="windowOne" class="windows" fill="#975A42" stroke="none" d="
	M 188.65 198.4
	L 188.8 204.1 198.65 210.45 198.55 204.75 188.65 198.4
	M 208.45 216.8
	L 208.35 211.1 198.55 204.75 198.65 210.45 208.45 216.8
	M 188.8 204.1
	L 188.95 209.8 198.8 216.15 198.65 210.45 188.8 204.1
	M 208.6 222.5
	L 208.45 216.8 198.65 210.45 198.8 216.15 208.6 222.5 Z"/>
					</g>
					<g>
						<path id="windowThree" class="windows" fill="#975A42" stroke="none" d="
	M 311.7 214.1
	L 318.55 217.55 318.45 211.9 311.6 208.45 311.7 214.1
	M 325.4 221
	L 325.25 215.35 318.45 211.9 318.55 217.55 325.4 221
	M 318.4 206.2
	L 311.5 202.75 311.6 208.45 318.45 211.9 318.4 206.2
	M 325.25 215.35
	L 325.2 209.7 318.4 206.2 318.45 211.9 325.25 215.35 Z"/>
					</g>
					<g id="Layer2_0_FILL">
						<path class="door" fill="#B65041" stroke="none" d="
	M 259.7 183.25
	L 244.6 191.9 244.6 213.8 259.7 204.55 259.7 183.25 Z"/>
					</g>
					<path id="windowTwo" fill="#975A42" class="windows" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" d="
	M 223.05 200.3
	Q 222.95 201.45 222.05 202.25 221.25 203.05 220.1 203.05 218.95 203.05 218.15 202.25 217.852734375 201.9103515625 217.7 201.5 217.4923828125 200.96171875 217.55 200.3 217.5833984375 199.916796875 217.7 199.575 217.933203125 198.8833984375 218.5 198.35 218.95 197.95 219.5 197.75 220 197.55 220.55 197.55 221.15 197.55 221.65 197.75 222.05 197.95 222.4 198.35 223.15 199.15 223.05 200.3 Z
	M 238.7 191.05
	Q 238.6552734375 191.56484375 238.45 192 238.1970703125 192.558203125 237.7 193 236.85 193.8 235.7 193.8 234.55 193.8 233.8 193 233.1 192.2 233.2 191.05 233.3 189.9 234.15 189.1 235.05 188.3 236.2 188.3 237.35 188.3 238.05 189.1 238.295703125 189.362109375 238.45 189.65 238.7671875 190.276953125 238.7 191.05 Z"/>
					<path fill="#F2563B" stroke="none" d=" M 351.95 211.2 L 351.8 211.2 346.05 215.1 346.05 225.2 351.95 221.6 351.95 211.2 Z"/>
					<path id="Layer6_0_1_STROKES" class="windowRims" stroke="#AE663D" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" fill="none" d="
	M 198.55 204.75
	L 208.35 211.1 208.45 216.8 208.6 222.5 198.8 216.15 188.95 209.8 188.8 204.1 188.65 198.4 198.55 204.75 198.65 210.45 208.45 216.8
	M 198.8 216.15
	L 198.65 210.45 188.8 204.1"/>
					<path id="Layer5_0_1_STROKES" class="windowRims" stroke="#AE663D" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" fill="none" d="
	M 325.25 215.35
	L 325.4 221 318.55 217.55 311.7 214.1 311.6 208.45 311.5 202.75 318.4 206.2 325.2 209.7 325.25 215.35 318.45 211.9 318.55 217.55
	M 318.4 206.2
	L 318.45 211.9 311.6 208.45"/>
				</defs>
				<g id="shadow">
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use xlink:href="#bottomShadow"/>
					</g>
				</g>
				<g transform="matrix( 1, 0, 0, 1, 0,0) ">
					<use xlink:href="#sun"/>
				</g>
				<g id="earth">
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer52_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer51_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer50_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer48_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer47_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer46_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer45_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer44_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer43_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer41_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer40_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer38_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer37_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer36_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer35_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer34_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#windowFour"/>
						<use class="element" xlink:href="#Layer32_0_1_STROKES"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer30_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer27_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer26_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer25_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer24_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer22_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer21_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer20_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer19_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer18_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer17_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer16_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer8_0_FILL"/>
						<use class="element" xlink:href="#windowTwo"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer7_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#windowOne"/>
						<use class="element" xlink:href="#Layer6_0_1_STROKES"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#windowThree"/>
						<use class="element" xlink:href="#Layer5_0_1_STROKES"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer2_0_FILL"/>
					</g>
				</g>
			</svg>
			<! -- End of SVG file -->
			<! -- Moon/Sun Toggle -->
			<div id="toggleButton" class="day-toggle">
				<div class="sun-icon"></div>
				<label class="switch">
            <input id="toggleCheckbox" type="checkbox">
            <div class="slider"></div>
        </label>
				<div class="cloud-icon"></div>
			</div>
			<! -- Moon/Sun Toggle -->
			<! -- End of Container -->
		</div>
			</div>
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">奔向未来的日子</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">打工是不可能打工的， 这辈子都不可能打工的！</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/16/H5自定义标签Video播放器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李斌">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/tx.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="奔向未来的日子">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">H5自定义标签Video播放器</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-16T22:08:19+08:00">
                2020-01-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="Web-Components才是组件化的未来"><a href="#Web-Components才是组件化的未来" class="headerlink" title="Web Components才是组件化的未来"></a>Web Components才是组件化的未来</h3><blockquote>
<p><strong>上一时代的<code>牺牲品</code>是jQuery，如今Web Components被越来越多的浏览器所支持，React,Vue或许是下一个“祭品”。</strong></p>
</blockquote>
<p>组件化、复用，这几乎是所有开发者追求的东西。Web Components就是为此而提出。可以使用来创建封装功能的定制元素，可以在你喜欢的任何地方重用，不必担心代码冲突。</p>
<p>这样的理念和Vue十分相似，专注于组件。所以Web Components或许是未来的方向！</p>
<p>组件是 Web 开发的方向，现在的热点是 JavaScript 组件，但是 HTML 组件未来可能更有希望。</p>
<p>浏览器将自定义元素保留在 DOM 之中，但不会任何语义。除此之外，自定义元素与标准元素都一致</p>
<p>事实上，浏览器提供了一个<code>HTMLUnknownElement</code>，<code>HTMLElement</code>对象，所有自定义元素都是该对象的实例。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> tabs=<span class="built_in">document</span>.createElement(<span class="string">"tabs"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(tabs <span class="keyword">instanceof</span> HTMLUnknownElement);   <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(tabs <span class="keyword">instanceof</span> HTMLElement);     <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>Custom Elements 标准: <font color="#ff0000"> <strong>自定义元素的名字必须包含一个破折号（-）</strong> </font><br><strong>一旦名字之中使用了破折号，自定义元素就不是HTMLUnknownElement的实例了。</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> tabs=<span class="built_in">document</span>.createElement(<span class="string">"my-tabs"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(tabs <span class="keyword">instanceof</span> HTMLUnknownElement);   <span class="comment">//false</span></span><br><span class="line"><span class="built_in">console</span>.log(tabs <span class="keyword">instanceof</span> HTMLElement);     <span class="comment">//true</span></span><br></pre></td></tr></table></figure></p>
<p>Custom Elements 标准规定了，自定义元素的定义可以使用 ES6 的class语法</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"Generator"</span> <span class="attr">content</span>=<span class="string">"EditPlus®"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"Author"</span> <span class="attr">content</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"Keywords"</span> <span class="attr">content</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"Description"</span> <span class="attr">content</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">my-element</span> <span class="attr">content</span>=<span class="string">"Custom Element"</span>&gt;</span></span><br><span class="line">  Hello</span><br><span class="line"><span class="tag">&lt;/<span class="name">my-element</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="class"><span class="keyword">class</span> <span class="title">MyElement</span> <span class="keyword">extends</span> <span class="title">HTMLElement</span> </span>&#123;<span class="comment">//自定义元素的定义可以使用ES6的class语法</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">get</span>  content() &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> <span class="keyword">this</span>.getAttribute(<span class="string">'content'</span>);</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line"><span class="javascript">  <span class="keyword">set</span>  content(val) &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">this</span>.setAttribute(<span class="string">'content'</span>, val);</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="javascript"><span class="comment">// 原生的window.customElements对象的define方法用来定义 Custom Element。</span></span></span><br><span class="line"><span class="javascript"><span class="comment">// 该方法接受两个参数，第一个参数是自定义元素的名字，第二个参数是一个 ES6 的class。</span></span></span><br><span class="line"><span class="javascript"><span class="built_in">window</span>.customElements.define(<span class="string">'my-element'</span>, MyElement);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="built_in">window</span>.onload=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">//在页面元素加载完之后，才执行</span></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">customTag</span>(<span class="params">tagName, fn</span>)</span>&#123;<span class="comment">//Array.from（[arguments]）；可以将字符串，数组，类数组集合转化为数组</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">Array</span></span></span><br><span class="line"><span class="javascript">    .from(<span class="built_in">document</span>.getElementsByTagName(tagName))</span></span><br><span class="line">    .forEach(fn);</span><br><span class="line">&#125;</span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">myElementHandler</span>(<span class="params">element</span>) </span>&#123;</span></span><br><span class="line">  element.textContent = element.content;</span><br><span class="line">&#125;</span><br><span class="line"><span class="javascript">customTag(<span class="string">'my-element'</span>, myElementHandler);</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="自定义elements"><a href="#自定义elements" class="headerlink" title="自定义elements"></a>自定义elements</h3><p>Web Components通过CustomElementRegistry.define()来定义elements，目前有两种elements，独立的element与继承自基本的HTML element</p>
<h3 id="独立的element"><a href="#独立的element" class="headerlink" title="独立的element"></a>独立的element</h3><p>独立的element像<custom-element>这样的自定义标签<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">customElements.define(<span class="string">'custom-element'</span>,</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">MyCustomElement</span> <span class="keyword">extends</span> <span class="title">HTMLElement</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">      <span class="keyword">super</span>();</span><br><span class="line"></span><br><span class="line">      <span class="comment">//创建&lt;p stype='color:red'&gt;&lt;/p&gt;</span></span><br><span class="line">      <span class="keyword">const</span> pElem = <span class="built_in">document</span>.createElement(<span class="string">'p'</span>);</span><br><span class="line">      pElem.textContent = <span class="keyword">this</span>.textContent;</span><br><span class="line">      pElem.style.color = <span class="string">'red'</span>;</span><br><span class="line">      <span class="comment">//加入根节点</span></span><br><span class="line">      <span class="keyword">const</span> shadowRoot = <span class="keyword">this</span>.attachShadow(&#123;<span class="attr">mode</span>: <span class="string">'closed'</span>&#125;);</span><br><span class="line">      shadowRoot.appendChild(pElem);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;custom-element&gt;红色字体的段落！&lt;<span class="regexp">/custom-element&gt;</span></span><br></pre></td></tr></table></figure></custom-element></p>
<h3 id="生命周期回调函数"><a href="#生命周期回调函数" class="headerlink" title="生命周期回调函数"></a>生命周期回调函数</h3><p>在自定义的element的构造函数中，可以指定多个不同的回调函数，它们将会在元素的不同生命时期被调用：</p>
<ul>
<li>connectedCallback：当 custom element首次被插入文档DOM时，被调用。</li>
<li>disconnectedCallback：当 custom element从文档DOM中删除时，被调用。</li>
<li>adoptedCallback：当 custom element被移动到新的文档时，被调用。</li>
<li>attributeChangedCallback: 当 custom element增加、删除、修改自身属性时，被调用。<br>例如：</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">customElements.define(<span class="string">'other-custom-element'</span>,</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">MyOtherCustomElement</span> <span class="keyword">extends</span> <span class="title">HTMLElement</span>  </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">      <span class="keyword">super</span>();</span><br><span class="line">      <span class="comment">//......</span></span><br><span class="line">    &#125;</span><br><span class="line">    connectedCallback() &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'Custom square element added to page.'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    disconnectedCallback() &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'Custom square element removed from page.'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    adoptedCallback() &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'Custom square element moved to new page.'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    attributeChangedCallback(name, oldValue, newValue) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'Custom square element attributes changed.'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="Shadow-DOM"><a href="#Shadow-DOM" class="headerlink" title="Shadow DOM"></a>Shadow DOM</h3><p><img src="https://user-images.githubusercontent.com/16753554/72352234-d297d800-371c-11ea-884c-edbce45aa1cb.png" alt="image"></p>
<p>如图，Shadow DOM会在自定义标签解析时，加载到普通的DOM上。内部可以通过Element.attachShadow()来获取shadow root。它有一个mode属性，值可以是open或者closed,表示能否在外部获取Shadow DOM对象，一般而言应当为closed，内部实现不应该对外可见。</p>
<h3 id="HTML-templates"><a href="#HTML-templates" class="headerlink" title="HTML templates"></a>HTML templates</h3><p>如果你熟悉Vue的话，这块与它很相似，是template与slot。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">"person-template"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Personal ID Card<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">"person-name"</span>&gt;</span>NAME MISSING<span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">"person-age"</span>&gt;</span>AGE MISSING<span class="tag">&lt;/<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">"person-occupation"</span>&gt;</span>OCCUPATION MISSING<span class="tag">&lt;/<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">person-details</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 官方例子p slot="person-name"，由于hexo对p的解析会出错，这里改成了&lt;span&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">"person-name"</span>&gt;</span>Morgan Stanley<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">"person-age"</span>&gt;</span>36<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">"person-occupation"</span>&gt;</span>Accountant<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">person-details</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">customElements.define(<span class="string">'person-details'</span>,</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">HTMLElement</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">      <span class="keyword">super</span>();</span><br><span class="line">      <span class="keyword">const</span> template = <span class="built_in">document</span>.getElementById(<span class="string">'person-template'</span>);</span><br><span class="line">      <span class="keyword">const</span> templateContent = template.content;</span><br><span class="line">      <span class="keyword">const</span> shadowRoot = <span class="keyword">this</span>.attachShadow(&#123;<span class="attr">mode</span>: <span class="string">'closed'</span>&#125;);</span><br><span class="line">      shadowRoot.appendChild(templateContent.cloneNode(<span class="literal">true</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="HTML-Imports"><a href="#HTML-Imports" class="headerlink" title="HTML Imports"></a>HTML Imports</h3><p>这块存在争议，Mozilla认为将来应该用更合适的方式。不多做介绍。</p>
<h3 id="Web-Components视频播放器"><a href="#Web-Components视频播放器" class="headerlink" title="Web Components视频播放器"></a>Web Components视频播放器</h3><blockquote>
<p>参考项目：<a href="https://github.com/yisar/eplayer" target="_blank" rel="noopener">https://github.com/yisar/eplayer</a></p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Eplayer</span> <span class="keyword">extends</span> <span class="title">HTMLElement</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span> () &#123;</span><br><span class="line">    <span class="keyword">super</span>()</span><br><span class="line">    <span class="keyword">this</span>.doms = &#123;&#125;</span><br><span class="line">    <span class="keyword">this</span>.src = <span class="keyword">this</span>.getAttribute(<span class="string">'src'</span>)</span><br><span class="line">    <span class="keyword">this</span>.type = <span class="keyword">this</span>.getAttribute(<span class="string">'type'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.init()</span><br><span class="line">    <span class="keyword">this</span>.stream()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">get</span> observedAttributes () &#123;</span><br><span class="line">    <span class="keyword">return</span> [<span class="string">'src'</span>, <span class="string">'type'</span>]</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  attributeChangedCallback (name, _, newVal) &#123;</span><br><span class="line">    <span class="keyword">if</span> (name === <span class="string">'src'</span>) <span class="keyword">this</span>.src = <span class="keyword">this</span>.$(<span class="string">'.video'</span>).src = newVal</span><br><span class="line">    <span class="keyword">if</span> (name === <span class="string">'type'</span>) <span class="keyword">this</span>.type = newVal</span><br><span class="line">    <span class="keyword">this</span>.stream()</span><br><span class="line">    <span class="keyword">this</span>.video.load()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  $ (key) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.doms[key]</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  waiting () &#123;</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.mark'</span>).classList.remove(<span class="string">'playing'</span>)</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.mark'</span>).classList.add(<span class="string">'loading'</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  stream () &#123;</span><br><span class="line">    <span class="keyword">switch</span> (<span class="keyword">this</span>.type) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'hls'</span>:</span><br><span class="line">        <span class="keyword">if</span> (Hls.isSupported()) &#123;</span><br><span class="line">          <span class="keyword">let</span> hls = <span class="keyword">new</span> Hls()</span><br><span class="line">          hls.loadSource(<span class="keyword">this</span>.src)</span><br><span class="line">          hls.attachMedia(<span class="keyword">this</span>.video)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  canplay () &#123;</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.mark'</span>).classList.remove(<span class="string">'loading'</span>)</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.mark'</span>).classList.add(<span class="string">'playing'</span>)</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.mark'</span>).onclick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      clearTimeout(<span class="keyword">this</span>.timer)</span><br><span class="line">      <span class="keyword">this</span>.timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.play()</span><br><span class="line">      &#125;, <span class="number">200</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.total'</span>).innerHTML = getTimeStr(<span class="keyword">this</span>.video.duration)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  play () &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.video.paused) &#123;</span><br><span class="line">      <span class="keyword">this</span>.video.play()</span><br><span class="line">      <span class="keyword">this</span>.$(<span class="string">'.ep-video'</span>).style.display = <span class="string">'none'</span></span><br><span class="line">      <span class="keyword">this</span>.$(<span class="string">'.is-play'</span>).classList.replace(<span class="string">'ep-play'</span>, <span class="string">'ep-pause'</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.video.pause()</span><br><span class="line">      <span class="keyword">this</span>.$(<span class="string">'.ep-video'</span>).style.display = <span class="string">'block'</span></span><br><span class="line">      <span class="keyword">this</span>.$(<span class="string">'.is-play'</span>).classList.replace(<span class="string">'ep-pause'</span>, <span class="string">'ep-play'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  volume () &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.video.muted) &#123;</span><br><span class="line">      <span class="keyword">this</span>.video.muted = <span class="literal">false</span></span><br><span class="line">      setVolume(<span class="keyword">this</span>.video.volume * <span class="number">10</span>, <span class="keyword">this</span>.$(<span class="string">'.line'</span>))</span><br><span class="line">      <span class="keyword">this</span>.$(<span class="string">'.is-volume'</span>).classList.replace(<span class="string">'ep-volume-off'</span>, <span class="string">'ep-volume'</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.video.muted = <span class="literal">true</span></span><br><span class="line">      setVolume(<span class="number">0</span>, <span class="keyword">this</span>.$(<span class="string">'.line'</span>))</span><br><span class="line">      <span class="keyword">this</span>.$(<span class="string">'.is-volume'</span>).classList.replace(<span class="string">'ep-volume'</span>, <span class="string">'ep-volume-off'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  update () &#123;</span><br><span class="line">    <span class="keyword">let</span> cTime = getTimeStr(<span class="keyword">this</span>.video.currentTime)</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.video.buffered.length) &#123;</span><br><span class="line">      <span class="keyword">let</span> bufferEnd = <span class="keyword">this</span>.video.buffered.end(<span class="keyword">this</span>.video.buffered.length - <span class="number">1</span>)</span><br><span class="line">      <span class="keyword">this</span>.$(<span class="string">'.buffer'</span>).style.width =</span><br><span class="line">        (bufferEnd / <span class="keyword">this</span>.video.duration) * <span class="keyword">this</span>.$(<span class="string">'.progress'</span>).clientWidth +</span><br><span class="line">        <span class="string">'px'</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> offset =</span><br><span class="line">      (<span class="keyword">this</span>.video.currentTime / <span class="keyword">this</span>.video.duration) * <span class="keyword">this</span>.$(<span class="string">'.bg'</span>).clientWidth</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.now'</span>).innerHTML = cTime</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.current'</span>).style.width = offset + <span class="string">'px'</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  progress (e) &#123;</span><br><span class="line">    <span class="keyword">let</span> offset = e.offsetX / <span class="keyword">this</span>.$(<span class="string">'.progress'</span>).offsetWidth</span><br><span class="line">    <span class="keyword">this</span>.video.currentTime = <span class="keyword">this</span>.video.duration * offset</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  down (e) &#123;</span><br><span class="line">    e.stopPropagation()</span><br><span class="line">    <span class="keyword">this</span>.disX = e.clientX - <span class="keyword">this</span>.$(<span class="string">'.cycle'</span>).offsetLeft</span><br><span class="line">    <span class="built_in">document</span>.onmousemove = <span class="function"><span class="params">e</span> =&gt;</span> <span class="keyword">this</span>.move(e)</span><br><span class="line">    <span class="built_in">document</span>.onmouseup = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      e.stopPropagation()</span><br><span class="line">      <span class="built_in">document</span>.onmousemove = <span class="literal">null</span></span><br><span class="line">      <span class="built_in">document</span>.onmouseup = <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  move (e) &#123;</span><br><span class="line">    e.stopPropagation()</span><br><span class="line">    <span class="keyword">let</span> offset = e.clientX - <span class="keyword">this</span>.disX + <span class="number">7</span></span><br><span class="line">    <span class="keyword">if</span> (offset &lt; <span class="number">0</span>) offset = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> (offset &gt; <span class="keyword">this</span>.$(<span class="string">'.progress'</span>).clientWidth) &#123;</span><br><span class="line">      offset = <span class="keyword">this</span>.$(<span class="string">'.progress'</span>).clientWidth</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.current'</span>).style.width = offset + <span class="string">'px'</span></span><br><span class="line">    <span class="keyword">this</span>.video.currentTime =</span><br><span class="line">      (offset / <span class="keyword">this</span>.$(<span class="string">'.progress'</span>).clientWidth) * <span class="keyword">this</span>.video.duration</span><br><span class="line">    <span class="built_in">document</span>.onmousemove = <span class="literal">null</span></span><br><span class="line">    setTimeout(</span><br><span class="line">      (<span class="built_in">document</span>.onmousemove = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (e) <span class="keyword">this</span>.move(e)</span><br><span class="line">      &#125;),</span><br><span class="line">      <span class="number">30</span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  alow () &#123;</span><br><span class="line">    clearTimeout(<span class="keyword">this</span>.timer)</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.controls'</span>).style.bottom = <span class="number">0</span></span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.ep-video'</span>).style.bottom = <span class="number">70</span> + <span class="string">'px'</span></span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.mark'</span>).style.cursor = <span class="string">'default'</span></span><br><span class="line">    <span class="keyword">this</span>.timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.$(<span class="string">'.controls'</span>).style.bottom = <span class="number">-70</span> + <span class="string">'px'</span></span><br><span class="line">      <span class="keyword">this</span>.$(<span class="string">'.ep-video'</span>).style.bottom = <span class="number">25</span> + <span class="string">'px'</span></span><br><span class="line">      <span class="keyword">this</span>.$(<span class="string">'.mark'</span>).style.cursor = <span class="string">'none'</span></span><br><span class="line">    &#125;, <span class="number">5000</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  keydown (e) &#123;</span><br><span class="line">    <span class="keyword">switch</span> (e.keyCode) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">37</span>:</span><br><span class="line">        <span class="keyword">this</span>.video.currentTime -= <span class="number">10</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">case</span> <span class="number">39</span>:</span><br><span class="line">        <span class="keyword">this</span>.video.currentTime += <span class="number">10</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">case</span> <span class="number">38</span>:</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">this</span>.video.volume = <span class="built_in">parseInt</span>(<span class="keyword">this</span>.video.volume * <span class="number">100</span>) / <span class="number">100</span> + <span class="number">0.05</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line">        setVolume(<span class="keyword">this</span>.video.volume.toFixed(<span class="number">1</span>) * <span class="number">10</span>, <span class="keyword">this</span>.$(<span class="string">'.line'</span>))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">case</span> <span class="number">40</span>:</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">this</span>.video.volume = <span class="built_in">parseInt</span>(<span class="keyword">this</span>.video.volume * <span class="number">100</span>) / <span class="number">100</span> - <span class="number">0.05</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;&#125;</span><br><span class="line">        setVolume(<span class="keyword">this</span>.video.volume.toFixed(<span class="number">1</span>) * <span class="number">10</span>, <span class="keyword">this</span>.$(<span class="string">'.line'</span>))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">case</span> <span class="number">32</span>:</span><br><span class="line">        <span class="keyword">this</span>.play()</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ended () &#123;</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.is-play'</span>).classList.replace(<span class="string">'ep-pause'</span>, <span class="string">'ep-play'</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  full () &#123;</span><br><span class="line">    <span class="keyword">if</span> (isFullScreen()) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">document</span>.exitFullscreen) &#123;</span><br><span class="line">        <span class="built_in">document</span>.exitFullscreen()</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">document</span>.mozCancelFullScreen) &#123;</span><br><span class="line">        <span class="built_in">document</span>.mozCancelFullScreen()</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">document</span>.webkitCancelFullScreen) &#123;</span><br><span class="line">        <span class="built_in">document</span>.webkitCancelFullScreen()</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">document</span>.msExitFullscreen) &#123;</span><br><span class="line">        <span class="built_in">document</span>.msExitFullscreen()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> el = <span class="keyword">this</span>.$(<span class="string">'.eplayer'</span>)</span><br><span class="line">      <span class="keyword">let</span> rfs =</span><br><span class="line">        el.requestFullScreen ||</span><br><span class="line">        el.webkitRequestFullScreen ||</span><br><span class="line">        el.mozRequestFullScreen ||</span><br><span class="line">        el.msRequestFullscreen</span><br><span class="line">      <span class="keyword">return</span> rfs.call(el)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  panel (e) &#123;</span><br><span class="line">    e.preventDefault()</span><br><span class="line">    <span class="keyword">let</span> panel = <span class="keyword">this</span>.$(<span class="string">'.panel'</span>)</span><br><span class="line">    <span class="keyword">if</span> (e.button !== <span class="number">2</span>) &#123;</span><br><span class="line">      panel.style.display = <span class="string">'none'</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      panel.style.display = <span class="string">'block'</span></span><br><span class="line">      panel.style.height = panel.childElementCount * <span class="number">24</span> + <span class="string">'px'</span></span><br><span class="line">      panel.style.top = e.offsetY + <span class="string">'px'</span></span><br><span class="line">      panel.style.left = e.offsetX + <span class="string">'px'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  init () &#123;</span><br><span class="line">    <span class="keyword">let</span> html = <span class="string">`</span></span><br><span class="line"><span class="string">      &lt;style&gt;</span></span><br><span class="line"><span class="string">        @import "https://at.alicdn.com/t/font_836948_6lbb2iu59.css";</span></span><br><span class="line"><span class="string">        *&#123;</span></span><br><span class="line"><span class="string">          padding:0;</span></span><br><span class="line"><span class="string">          margin:0;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        li&#123;</span></span><br><span class="line"><span class="string">          list-style:none;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .eplayer,video&#123;</span></span><br><span class="line"><span class="string">          height:100%;</span></span><br><span class="line"><span class="string">          width:100%;</span></span><br><span class="line"><span class="string">          color:var(--icons,rgba(255,255,255,0.6));</span></span><br><span class="line"><span class="string">          font-size:12px;</span></span><br><span class="line"><span class="string">          background:#000</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .eplayer&#123;</span></span><br><span class="line"><span class="string">          user-select:none;</span></span><br><span class="line"><span class="string">          position: relative;</span></span><br><span class="line"><span class="string">          overflow: hidden;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .controls&#123;</span></span><br><span class="line"><span class="string">          position:absolute;</span></span><br><span class="line"><span class="string">          left:0;</span></span><br><span class="line"><span class="string">          right:0;</span></span><br><span class="line"><span class="string">          bottom:0;</span></span><br><span class="line"><span class="string">          padding:10px;</span></span><br><span class="line"><span class="string">          background:linear-gradient(transparent,rgba(0,0,0,.5));</span></span><br><span class="line"><span class="string">          transition: .3s ease-out;   </span></span><br><span class="line"><span class="string">          z-index:1;   </span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .progress&#123;</span></span><br><span class="line"><span class="string">          position:relative;</span></span><br><span class="line"><span class="string">          bottom:15px;</span></span><br><span class="line"><span class="string">          left:0;</span></span><br><span class="line"><span class="string">          right:0;</span></span><br><span class="line"><span class="string">          cursor:pointer;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .options&#123;</span></span><br><span class="line"><span class="string">          display:flex;</span></span><br><span class="line"><span class="string">          align-items:center;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .epicon&#123;</span></span><br><span class="line"><span class="string">          color:var(--icons,rgba(255,255,255,0.6));</span></span><br><span class="line"><span class="string">          padding:0 10px;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .epicon&#123;</span></span><br><span class="line"><span class="string">          font-size:18px;</span></span><br><span class="line"><span class="string">          transition: .3s;</span></span><br><span class="line"><span class="string">          cursor:pointer;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .epicon:hover&#123;</span></span><br><span class="line"><span class="string">          color:#fff;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .time&#123;</span></span><br><span class="line"><span class="string">          position:relative;</span></span><br><span class="line"><span class="string">          top:-2px;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .time b&#123;</span></span><br><span class="line"><span class="string">          font-weight:normal;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .line&#123;</span></span><br><span class="line"><span class="string">          padding:0 1px;</span></span><br><span class="line"><span class="string">          margin-bottom: -2px;</span></span><br><span class="line"><span class="string">          cursor:pointer</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .line i&#123;</span></span><br><span class="line"><span class="string">          width:4px;</span></span><br><span class="line"><span class="string">          border-radius:4px;</span></span><br><span class="line"><span class="string">          display: inline-block;</span></span><br><span class="line"><span class="string">          background: var(--icons,rgba(255,255,255,0.6));</span></span><br><span class="line"><span class="string">          height: 12px;</span></span><br><span class="line"><span class="string">          transform:scaleX(0.7);</span></span><br><span class="line"><span class="string">          transition: .3s;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .line:hover i&#123;</span></span><br><span class="line"><span class="string">          height:14px;</span></span><br><span class="line"><span class="string">          background:var(--theme,#c136e4);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .active i&#123;</span></span><br><span class="line"><span class="string">          background:var(--theme,#c136e4);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .left&#123;</span></span><br><span class="line"><span class="string">          flex:1;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .right&#123;</span></span><br><span class="line"><span class="string">          flex:1;</span></span><br><span class="line"><span class="string">          display:flex;</span></span><br><span class="line"><span class="string">          align-items:center;</span></span><br><span class="line"><span class="string">          justify-content: flex-end;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .bg,.current,.buffer&#123;</span></span><br><span class="line"><span class="string">          left:0;</span></span><br><span class="line"><span class="string">          height:3px;</span></span><br><span class="line"><span class="string">          position:absolute;</span></span><br><span class="line"><span class="string">          top:0;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .bg&#123;</span></span><br><span class="line"><span class="string">          right:0;</span></span><br><span class="line"><span class="string">          background:var(--progress,rgba(255,255,255,.3));</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .current&#123;</span></span><br><span class="line"><span class="string">          background:var(--theme,#c136e4);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .buffer&#123;</span></span><br><span class="line"><span class="string">          background:var(--buffer,rgba(255,255,255,.5));</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .dot&#123;</span></span><br><span class="line"><span class="string">          position:absolute;</span></span><br><span class="line"><span class="string">          border-radius: 50%;</span></span><br><span class="line"><span class="string">          display: block;</span></span><br><span class="line"><span class="string">          background:var(--theme,#c136e4);</span></span><br><span class="line"><span class="string">          height: 9px;</span></span><br><span class="line"><span class="string">          width:9px;</span></span><br><span class="line"><span class="string">          right:-5px;</span></span><br><span class="line"><span class="string">          top:-3px;</span></span><br><span class="line"><span class="string">          cursor:pointer;</span></span><br><span class="line"><span class="string">          z-index:1;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .cycle&#123;</span></span><br><span class="line"><span class="string">          position:absolute;</span></span><br><span class="line"><span class="string">          border-radius: 50%;</span></span><br><span class="line"><span class="string">          display: block;</span></span><br><span class="line"><span class="string">          background:var(--theme,#c136e4);</span></span><br><span class="line"><span class="string">          opacity:0.3;</span></span><br><span class="line"><span class="string">          height: 15px;</span></span><br><span class="line"><span class="string">          width:15px;</span></span><br><span class="line"><span class="string">          right:-8px;</span></span><br><span class="line"><span class="string">          top:-6px;</span></span><br><span class="line"><span class="string">          cursor:pointer;</span></span><br><span class="line"><span class="string">          z-index:1;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        @keyframes loading&#123;</span></span><br><span class="line"><span class="string">          0%&#123;</span></span><br><span class="line"><span class="string">            transform: rotate(0deg);</span></span><br><span class="line"><span class="string">          &#125;</span></span><br><span class="line"><span class="string">          100%&#123;</span></span><br><span class="line"><span class="string">            transform: rotate(360deg);</span></span><br><span class="line"><span class="string">          &#125;  </span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .playing&#123;</span></span><br><span class="line"><span class="string">          position: absolute;</span></span><br><span class="line"><span class="string">          z-index: 1;</span></span><br><span class="line"><span class="string">          top:0;</span></span><br><span class="line"><span class="string">          left:0;</span></span><br><span class="line"><span class="string">          right:0;</span></span><br><span class="line"><span class="string">          bottom:0;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .loading &#123;</span></span><br><span class="line"><span class="string">          position: absolute;</span></span><br><span class="line"><span class="string">          z-index: 1;</span></span><br><span class="line"><span class="string">          top: 50%;</span></span><br><span class="line"><span class="string">          left: 50%;</span></span><br><span class="line"><span class="string">          margin:-20px 0 0 -20px;</span></span><br><span class="line"><span class="string">          width: 40px;</span></span><br><span class="line"><span class="string">          height: 40px;</span></span><br><span class="line"><span class="string">          z-index:1;</span></span><br><span class="line"><span class="string">          box-shadow: 2px 0px rgba(255,255,255,.6);</span></span><br><span class="line"><span class="string">          border-radius: 50%;</span></span><br><span class="line"><span class="string">          animation: loading 1s linear infinite;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .ep-video &#123;</span></span><br><span class="line"><span class="string">          position: absolute;</span></span><br><span class="line"><span class="string">          bottom: 25px;</span></span><br><span class="line"><span class="string">          right: 20px;</span></span><br><span class="line"><span class="string">          font-size:40px;</span></span><br><span class="line"><span class="string">          color:var(--icons,rgba(255,255,255,.6));</span></span><br><span class="line"><span class="string">          z-index:1;</span></span><br><span class="line"><span class="string">          cursor: pointer; </span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .panel &#123;</span></span><br><span class="line"><span class="string">          position: absolute;</span></span><br><span class="line"><span class="string">          bottom: 200px;</span></span><br><span class="line"><span class="string">          right: 300px;</span></span><br><span class="line"><span class="string">          background:rgba(0,0,0,.8);</span></span><br><span class="line"><span class="string">          border-radius:4px;</span></span><br><span class="line"><span class="string">          cursor: pointer; </span></span><br><span class="line"><span class="string">          z-index: 1;</span></span><br><span class="line"><span class="string">          display:none;</span></span><br><span class="line"><span class="string">          width:150px;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .panel li&#123;</span></span><br><span class="line"><span class="string">          line-height:24px;</span></span><br><span class="line"><span class="string">          text-align:center;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        .panel li:hover&#123;</span></span><br><span class="line"><span class="string">          border-radius:4px;</span></span><br><span class="line"><span class="string">          background:rgba(0,0,0,.8)</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &lt;/style&gt;</span></span><br><span class="line"><span class="string">      &lt;div class="eplayer"&gt;</span></span><br><span class="line"><span class="string">        &lt;video id="video" class="video" src="<span class="subst">$&#123;<span class="keyword">this</span>.src || <span class="string">''</span>&#125;</span>"&gt;&lt;/video&gt;</span></span><br><span class="line"><span class="string">        &lt;div class="mark loading"&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;div class="controls" style="bottom:-50px"&gt;</span></span><br><span class="line"><span class="string">          &lt;div class="progress"&gt;</span></span><br><span class="line"><span class="string">            &lt;b class="bg"&gt;&lt;/b&gt;</span></span><br><span class="line"><span class="string">            &lt;b class="buffer"&gt;&lt;/b&gt;</span></span><br><span class="line"><span class="string">            &lt;div class="current" style="width:0"&gt;</span></span><br><span class="line"><span class="string">              &lt;div class="dot"&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">              &lt;div class="cycle"&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">          &lt;/div&gt;</span></span><br><span class="line"><span class="string">          &lt;div class="options"&gt;</span></span><br><span class="line"><span class="string">            &lt;div class="left"&gt;</span></span><br><span class="line"><span class="string">              &lt;i class="epicon ep-play is-play"&gt;&lt;/i&gt;</span></span><br><span class="line"><span class="string">              &lt;span class="time"&gt;</span></span><br><span class="line"><span class="string">                &lt;b class="now"&gt;00:00&lt;/b&gt; / &lt;b class="total"&gt;00:00&lt;/b&gt;</span></span><br><span class="line"><span class="string">              &lt;/span&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;div class="right"&gt;</span></span><br><span class="line"><span class="string">              &lt;i class="epicon ep-volume is-volume"&gt;&lt;/i&gt;</span></span><br><span class="line"><span class="string">              &lt;span class="line"&gt;&lt;i&gt;&lt;/i&gt;&lt;/span&gt;</span></span><br><span class="line"><span class="string">              &lt;span class="line"&gt;&lt;i&gt;&lt;/i&gt;&lt;/span&gt;</span></span><br><span class="line"><span class="string">              &lt;span class="line"&gt;&lt;i&gt;&lt;/i&gt;&lt;/span&gt;</span></span><br><span class="line"><span class="string">              &lt;span class="line"&gt;&lt;i&gt;&lt;/i&gt;&lt;/span&gt;</span></span><br><span class="line"><span class="string">              &lt;span class="line"&gt;&lt;i&gt;&lt;/i&gt;&lt;/span&gt;</span></span><br><span class="line"><span class="string">              &lt;span class="line"&gt;&lt;i&gt;&lt;/i&gt;&lt;/span&gt;</span></span><br><span class="line"><span class="string">              &lt;span class="line"&gt;&lt;i&gt;&lt;/i&gt;&lt;/span&gt;</span></span><br><span class="line"><span class="string">              &lt;span class="line"&gt;&lt;i&gt;&lt;/i&gt;&lt;/span&gt;</span></span><br><span class="line"><span class="string">              &lt;span class="line"&gt;&lt;i&gt;&lt;/i&gt;&lt;/span&gt;</span></span><br><span class="line"><span class="string">              &lt;span class="line"&gt;&lt;i&gt;&lt;/i&gt;&lt;/span&gt;</span></span><br><span class="line"><span class="string">              &lt;i class="epicon ep-full"&gt;&lt;/i&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">          &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;div class="epicon ep-video"&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;div class="panel"&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">      &lt;/div&gt;</span></span><br><span class="line"><span class="string">    `</span></span><br><span class="line">    <span class="keyword">let</span> template = <span class="built_in">document</span>.createElement(<span class="string">'template'</span>)</span><br><span class="line">    template.innerHTML = html</span><br><span class="line">    <span class="keyword">this</span>.attachShadow(&#123;</span><br><span class="line">      mode: <span class="string">'open'</span></span><br><span class="line">    &#125;).appendChild(template.content.cloneNode(<span class="literal">true</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> doms = [</span><br><span class="line">      <span class="string">'.video'</span>,</span><br><span class="line">      <span class="string">'.mark'</span>,</span><br><span class="line">      <span class="string">'.playing'</span>,</span><br><span class="line">      <span class="string">'.loading'</span>,</span><br><span class="line">      <span class="string">'.total'</span>,</span><br><span class="line">      <span class="string">'.now'</span>,</span><br><span class="line">      <span class="string">'.current'</span>,</span><br><span class="line">      <span class="string">'.buffer'</span>,</span><br><span class="line">      <span class="string">'.is-play'</span>,</span><br><span class="line">      <span class="string">'.ep-video'</span>,</span><br><span class="line">      <span class="string">'.is-volume'</span>,</span><br><span class="line">      <span class="string">'.cycle'</span>,</span><br><span class="line">      <span class="string">'.progress'</span>,</span><br><span class="line">      <span class="string">'.controls'</span>,</span><br><span class="line">      <span class="string">'.line'</span>,</span><br><span class="line">      <span class="string">'.ep-pause'</span>,</span><br><span class="line">      <span class="string">'.ep-play'</span>,</span><br><span class="line">      <span class="string">'.ep-volume-off'</span>,</span><br><span class="line">      <span class="string">'.ep-volume'</span>,</span><br><span class="line">      <span class="string">'.bg'</span>,</span><br><span class="line">      <span class="string">'.eplayer'</span>,</span><br><span class="line">      <span class="string">'.ep-full'</span>,</span><br><span class="line">      <span class="string">'.panel'</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">of</span> doms) &#123;</span><br><span class="line">      <span class="keyword">let</span> dom = <span class="keyword">this</span>.shadowRoot.querySelectorAll(key)</span><br><span class="line">      <span class="keyword">this</span>.doms[key] = dom.length &gt; <span class="number">1</span> ? [...dom] : dom[<span class="number">0</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.mount()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> name <span class="keyword">in</span> Eplayer.plugins) &#123;</span><br><span class="line">      <span class="keyword">const</span> cb = Eplayer.plugins[name]</span><br><span class="line">      <span class="keyword">let</span> node = <span class="built_in">document</span>.createElement(<span class="string">'li'</span>)</span><br><span class="line">      node.innerText = name</span><br><span class="line">      <span class="keyword">let</span> panel = <span class="keyword">this</span>.$(<span class="string">'.panel'</span>)</span><br><span class="line">      panel.appendChild(node)</span><br><span class="line">      node.addEventListener(<span class="string">'click'</span>, () =&gt; cb(<span class="keyword">this</span>.shadowRoot))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  mount () &#123;</span><br><span class="line">    <span class="keyword">this</span>.video = <span class="keyword">this</span>.$(<span class="string">'.video'</span>)</span><br><span class="line">    <span class="keyword">this</span>.video.volume = <span class="number">0.5</span></span><br><span class="line">    setVolume(<span class="keyword">this</span>.video.volume * <span class="number">10</span>, <span class="keyword">this</span>.$(<span class="string">'.line'</span>))</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.is-volume'</span>).onclick = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.volume()</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.line'</span>).forEach(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">      item.onclick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.video.volume = (index + <span class="number">1</span>) / <span class="number">10</span></span><br><span class="line">        setVolume(index + <span class="number">1</span>, <span class="keyword">this</span>.$(<span class="string">'.line'</span>))</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.progress'</span>).onmousedown = <span class="function"><span class="params">e</span> =&gt;</span> <span class="keyword">this</span>.progress(e)</span><br><span class="line">    <span class="keyword">this</span>.video.onwaiting = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.waiting()</span><br><span class="line">    <span class="keyword">this</span>.video.oncanplay = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.canplay()</span><br><span class="line">    <span class="keyword">this</span>.video.ontimeupdate = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.update()</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.cycle'</span>).onmousedown = <span class="function"><span class="params">e</span> =&gt;</span> <span class="keyword">this</span>.down(e)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.eplayer'</span>).onmousemove = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.alow()</span><br><span class="line">    <span class="built_in">document</span>.onkeydown = <span class="function"><span class="params">e</span> =&gt;</span> <span class="keyword">this</span>.keydown(e)</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.ep-full'</span>).onclick = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.full()</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.ep-video'</span>).onclick = <span class="keyword">this</span>.$(<span class="string">'.is-play'</span>).onclick = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.play()</span><br><span class="line">    <span class="keyword">this</span>.video.onended = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.ended()</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.mark'</span>).ondblclick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      clearTimeout(<span class="keyword">this</span>.timer)</span><br><span class="line">      <span class="keyword">this</span>.full()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.eplayer'</span>).oncontextmenu = <span class="function"><span class="params">e</span> =&gt;</span> <span class="literal">false</span></span><br><span class="line">    <span class="keyword">this</span>.$(<span class="string">'.mark'</span>).onmousedown = <span class="function"><span class="params">e</span> =&gt;</span> <span class="keyword">this</span>.panel(e)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Eplayer.plugins = &#123;&#125;</span><br><span class="line"></span><br><span class="line">Eplayer.use = <span class="function"><span class="keyword">function</span> (<span class="params">name, cb</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.plugins[name] = cb</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getTimeStr</span> (<span class="params">time</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> h = <span class="built_in">Math</span>.floor(time / <span class="number">3600</span>)</span><br><span class="line">  <span class="keyword">let</span> m = <span class="built_in">Math</span>.floor((time % <span class="number">3600</span>) / <span class="number">60</span>)</span><br><span class="line">  <span class="keyword">let</span> s = <span class="built_in">Math</span>.floor(time % <span class="number">60</span>)</span><br><span class="line">  h = h &gt;= <span class="number">10</span> ? h : <span class="string">'0'</span> + h</span><br><span class="line">  m = m &gt;= <span class="number">10</span> ? m : <span class="string">'0'</span> + m</span><br><span class="line">  s = s &gt;= <span class="number">10</span> ? s : <span class="string">'0'</span> + s</span><br><span class="line">  <span class="keyword">return</span> h === <span class="string">'00'</span> ? m + <span class="string">':'</span> + s : h + <span class="string">':'</span> + m + <span class="string">':'</span> + s</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setVolume</span> (<span class="params">index, node</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> j = index; j &lt; node.length; j++) &#123;</span><br><span class="line">    node[j].classList.remove(<span class="string">'active'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; index; i++) &#123;</span><br><span class="line">    node[i].classList.add(<span class="string">'active'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isFullScreen</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="built_in">document</span>.isFullScreen ||</span><br><span class="line">    <span class="built_in">document</span>.webkitIsFullScreen ||</span><br><span class="line">    <span class="built_in">document</span>.mozIsFullScreen</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">;(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> link = <span class="built_in">document</span>.createElement(<span class="string">'link'</span>)</span><br><span class="line">  link.setAttribute(<span class="string">'href'</span>, <span class="string">'https://at.alicdn.com/t/font_836948_6lbb2iu59.css'</span>)</span><br><span class="line">  link.setAttribute(<span class="string">'rel'</span>, <span class="string">'stylesheet'</span>)</span><br><span class="line">  <span class="built_in">document</span>.head.appendChild(link)</span><br><span class="line">&#125;)()</span><br><span class="line"></span><br><span class="line">Eplayer.use(</span><br><span class="line">  <span class="string">'github源码'</span>,</span><br><span class="line">  ep =&gt; &#123;</span><br><span class="line">    <span class="built_in">window</span>.location.href = <span class="string">'https://github.com/132yse/eplayer'</span></span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">customElements.define(<span class="string">'e-player'</span>, Eplayer)</span><br></pre></td></tr></table></figure>
<p><img src="https://user-images.githubusercontent.com/16753554/72330395-69e73600-36f1-11ea-8e15-8f63051dce53.png" alt="image"></p>
<h3 id="HTML-自定义元素教程"><a href="#HTML-自定义元素教程" class="headerlink" title="HTML 自定义元素教程"></a><a href="https://www.cnblogs.com/zytrue/p/8494500.html" target="_blank" rel="noopener">HTML 自定义元素教程</a></h3><h3 id="Web-Components-入门实例教程"><a href="#Web-Components-入门实例教程" class="headerlink" title="Web Components 入门实例教程"></a><a href="http://www.ruanyifeng.com/blog/2019/08/web_components.html" target="_blank" rel="noopener">Web Components 入门实例教程</a></h3><h3 id="Web-Components实践"><a href="#Web-Components实践" class="headerlink" title="Web Components实践"></a><a href="https://www.jianshu.com/p/2bf2e6681d37" target="_blank" rel="noopener">Web Components实践</a></h3>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/01/05/Object-prototype-hasOwnProperty的性能问题/" rel="next" title="Object.prototype.hasOwnProperty的性能问题">
                <i class="fa fa-chevron-left"></i> Object.prototype.hasOwnProperty的性能问题
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/01/21/让你的动画变得更炫之FLIP技术/" rel="prev" title="让你的动画变得更炫之FLIP技术">
                让你的动画变得更炫之FLIP技术 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/tx.jpg" alt="李斌">
            
              <p class="site-author-name" itemprop="name">李斌</p>
              <p class="site-description motion-element" itemprop="description">人生如逆旅     我亦是行人</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">210</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">121</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/libin1991" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://juejin.im/user/57e737f6c4c971005f6bcd8d" target="_blank" title="juejin">
                      
                        <i class="fa fa-fw fa-spinner"></i>juejin</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Web-Components才是组件化的未来"><span class="nav-number">1.</span> <span class="nav-text">Web Components才是组件化的未来</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自定义elements"><span class="nav-number">2.</span> <span class="nav-text">自定义elements</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#独立的element"><span class="nav-number">3.</span> <span class="nav-text">独立的element</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#生命周期回调函数"><span class="nav-number">4.</span> <span class="nav-text">生命周期回调函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Shadow-DOM"><span class="nav-number">5.</span> <span class="nav-text">Shadow DOM</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTML-templates"><span class="nav-number">6.</span> <span class="nav-text">HTML templates</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTML-Imports"><span class="nav-number">7.</span> <span class="nav-text">HTML Imports</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Web-Components视频播放器"><span class="nav-number">8.</span> <span class="nav-text">Web Components视频播放器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTML-自定义元素教程"><span class="nav-number">9.</span> <span class="nav-text">HTML 自定义元素教程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Web-Components-入门实例教程"><span class="nav-number">10.</span> <span class="nav-text">Web Components 入门实例教程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Web-Components实践"><span class="nav-number">11.</span> <span class="nav-text">Web Components实践</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">李斌</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

  
  <!--
  	描述：点击红心
  -->
  <script type="text/javascript" src="/js/src/clicklove.js"></script>
  <!--
  	描述：复制代码
  -->
  <script type="text/javascript" src="/js/src/clipboard.min.js"></script>
  <script type="text/javascript" src="/js/src/clipboard-use.js"></script>
</body>
</html>


