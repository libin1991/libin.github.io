<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Generator,">










<meta name="description" content="前言本文就是简单介绍下 Generator 语法编译后的代码。 Generatorfunction* helloWorldGenerator() {   yield&amp;apos;hello&amp;apos;;   yield&amp;apos;world&amp;apos;;   return&amp;apos;ending&amp;apos;; } 我们打印下执行的结果： var hw = helloWorldGenerator();">
<meta name="keywords" content="Generator">
<meta property="og:type" content="article">
<meta property="og:title" content="Babel 将 Generator 编译成了什么">
<meta property="og:url" content="http://yoursite.com/2018/10/05/Babel-将-Generator-编译成了什么/index.html">
<meta property="og:site_name" content="Zero Days">
<meta property="og:description" content="前言本文就是简单介绍下 Generator 语法编译后的代码。 Generatorfunction* helloWorldGenerator() {   yield&amp;apos;hello&amp;apos;;   yield&amp;apos;world&amp;apos;;   return&amp;apos;ending&amp;apos;; } 我们打印下执行的结果： var hw = helloWorldGenerator();">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/2018/10/05/Babel-将-Generator-编译成了什么/166c52b4064a3c92.webp">
<meta property="og:updated_time" content="2018-11-01T13:12:17.372Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Babel 将 Generator 编译成了什么">
<meta name="twitter:description" content="前言本文就是简单介绍下 Generator 语法编译后的代码。 Generatorfunction* helloWorldGenerator() {   yield&amp;apos;hello&amp;apos;;   yield&amp;apos;world&amp;apos;;   return&amp;apos;ending&amp;apos;; } 我们打印下执行的结果： var hw = helloWorldGenerator();">
<meta name="twitter:image" content="http://yoursite.com/2018/10/05/Babel-将-Generator-编译成了什么/166c52b4064a3c92.webp">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/10/05/Babel-将-Generator-编译成了什么/">





  <title>Babel 将 Generator 编译成了什么 | Zero Days</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband">
    	<div class="eevee"><div class="body"><div class="head"><div class="ears"><div class="ear"><div class="lobe"></div></div><div class="ear"><div class="lobe"></div></div></div><div class="face"><div class="eyes"><div class="eye"><div class="eyelid"></div></div><div class="eye"><div class="eyelid"></div></div></div><div class="nose"></div><div class="mouth"></div></div></div><div class="chest"><div class="fur"><div class="patch"></div></div><div class="fur"><div class="patch"></div></div><div class="fur"><div class="patch"></div></div></div><div class="legs"><div class="leg"><div class="inner-leg"></div></div><div class="leg"><div class="inner-leg"></div></div><div class="leg"><div class="inner-leg"></div></div><div class="leg"><div class="inner-leg"></div></div></div><div class="tail"><div class="tail"><div class="tail"><div class="tail"><div class="tail"><div class="tail -end"></div></div></div></div></div></div></div></div>
    </div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
    	<div id="sky">
				<div id="background" class="container">
			<!-- svg file -->
			<svg id="svgout" height="100%" width="100%" viewbox="0 0 550 400">
				<defs>
					<g id="bottomShadow">
						<path fill="#000000" stroke="none" d="
		M 270.5 225.95
		L 127.35 316.65 266.8 400 409.6 309.25 270.5 225.95 Z"/>
					</g>
					<g id="Layer52_0_FILL">
						<path class="topGrass" fill="#B9D668" stroke="none" d="
	M 397.85 229.3
	L 397.85 225.6 269.85 152 135.75 228.6 135.75 233.65 262.1 306.55 397.85 229.3 Z"/>
					</g>
					<g id="Layer51_0_FILL">
						<path class="leftSideGrass" fill="#6E9E4F" stroke="none" d="
	M 135.1 229.95
	L 135.1 256.85 262.1 328.4 262.1 301.85 135.1 229.95 Z"/>
					</g>
					<g id="Layer50_0_FILL">
						<path class="rightGrassTop" fill="#8CB154" stroke="none" d="
	M 397.85 225.95
	L 395.8 225.95 261.75 301.55 261.75 328.4 397.85 251.15 397.85 225.95 Z"/>
					</g>
					<g id="Layer48_0_FILL">
						<path class="crustLeftTop" fill="#955541" stroke="none" d="
	M 135.45 282.4
	L 135.75 298.15 262.1 372.1 261.75 355.65 135.45 282.4 Z"/>
					</g>
					<g id="Layer47_0_FILL">
						<path class="middleLeftCrust" fill="#C77E61" stroke="none" d="
	M 135.1 270.3
	L 135.1 283.05 275.9 364.35 271.85 348.9 135.1 270.3 Z"/>
					</g>
					<g id="Layer46_0_FILL">
						<path class="crustLeftTop" fill="#955541" stroke="none" d="
	M 135.1 255.15
	L 135.1 270.3 262.1 343.55 262.1 328.05 135.1 255.15 Z"/>
					</g>
					<g id="Layer45_0_FILL">
						<path class="topRightCrust" fill="#A47237" stroke="none" d="
	M 397.5 294.5
	L 397.5 277 261.75 355.3 261.75 372.75 397.5 294.5 Z"/>
					</g>
					<g id="Layer44_0_FILL">
						<path class="middleRightCrust" fill="#C89451" stroke="none" d="
	M 397.5 269.95
	L 397.15 266.6 262.1 343.2 262.1 355.95 397.5 279.7 397.5 269.95 Z"/>
					</g>
					<g id="Layer43_0_FILL">
						<path class="topRightCrust" fill="#A47237" stroke="none" d="
	M 397.5 266.6
	L 397.5 250.45 261.75 328.4 261.75 343.85 397.5 266.6 Z"/>
					</g>
					<g id="Layer41_0_FILL">
						<path class="greyRoad" fill="#B2B2B1" stroke="none" d="
	M 295.05 283.05
	Q 299.05 280.35 308.45 275.3 317.85 269.95 323.6 266.9
	L 268.8 233.65 338.05 191.35 309.15 174.55 177.75 254.5
	Q 191.55 262.2 198.25 266.25 204.65 269.95 209.7 271.95
	L 241.6 250.45 295.05 283.05 Z"/>
					</g>
					<g id="Layer40_0_FILL">
						<path fill="#FFFFFF" stroke="none" d="
	M 199.95 256.85
	Q 194.55 261.2 191.9 262.2
	L 194.9 263.9 200.95 259.2 199.95 256.85
	M 225.8 243.75
	L 224.8 241.75 211.05 250.8 212.05 252.8 225.8 243.75
	M 308.15 275.65
	L 296.7 266.6 295.35 268.6 306.8 277.7 308.15 275.65
	M 275.9 253.5
	L 274.55 255.5 285.95 264.55 287.3 262.55 275.9 253.5
	M 251.7 227.3
	L 250.7 225.25 236.9 234.35 237.9 236.35 251.7 227.3
	M 257.05 240.7
	L 254.05 240.7 268.8 249.8 269.5 247.75 257.05 240.7
	M 277.2 207.8
	L 263.45 216.85 264.45 218.9 278.25 209.8 277.2 207.8
	M 305.1 192.65
	L 304.1 190.65 290.3 199.75 291.35 201.75 305.1 192.65 Z"/>
					</g>
					<g id="Layer38_0_FILL">
						<path class="frontFascia" fill="#ECB27B" stroke="none" d="
	M 359.25 187.95
	L 346.4 174.95 333.85 202.9 359.25 187.95 Z"/>
					</g>
					<g id="Layer37_0_FILL">
						<path class="frontWall" fill="#EFA258" stroke="none" d="
	M 334 201.05
	L 334.35 232 359.2 217.55 359.25 187.95 334 201.05 Z"/>
					</g>
					<g id="Layer36_0_FILL">
						<path class="leftWall" fill="#C57F42" stroke="none" d="
	M 334.35 232.3
	L 334.35 205.1 305.1 191.35 305.1 216.85 334.35 232.3 Z"/>
					</g>
					<g id="Layer35_0_FILL">
						<path class="rightRoof" fill="#EF4427" stroke="none" d="
	M 329.7 167.9
	L 331.05 167.9 344.55 176.7 347.85 176.7 363 192.25 363.15 189.55 350.65 176.7 350.55 176.7 334.25 167.5 334.25 159.1 329.7 159.1 329.7 164.9 322.65 160.95 322.3 162.15 329.7 167 329.7 167.9 Z"/>
					</g>
					<g id="Layer34_0_FILL">
						<path class="leftRoof" fill="#F2563B" stroke="none" d="
	M 334.05 207.05
	L 350.65 176.7 322.1 160.45 302.1 192.05 334.05 207.05 Z"/>
					</g>
					<g id="Layer30_0_FILL">
						<path id="windowFour" class="windows" stroke="none" fill="#975A42" d="
	M 341.35 203.3
	Q 340.9 203.45 340.5 203.8 340.1 204.2 339.85 204.75 339.7 205 339.7 205.3 339.6 205.75 339.7 206.1 339.7 206.15 339.7 206.2 339.8 206.5 340 206.8 340.55 207.4 341.45 207.4 342.35 207.4 343 206.8 343.4 206.5 343.65 206.1 343.85 205.75 343.95 205.3 344.05 204.4 343.55 203.8 343.3 203.45 343 203.3 342.65 203.15 342.2 203.15 341.8 203.15 341.35 203.3
	M 355.85 198.45
	Q 355.8 198.2 355.6 198 355.1 197.4 354.2 197.4 353.35 197.4 352.6 198 351.85 198.65 351.7 199.55 351.7 199.7 351.7 199.85 351.6 200.5 352 201.05 352.55 201.65 353.45 201.65 354.3 201.65 355.05 201.05 355.45 200.7 355.7 200.25 355.8 200.05 355.9 199.85 355.95 199.7 355.95 199.55 356.05 198.95 355.85 198.45 Z"/>
						<path class="door" fill="#B65041" stroke="none" d="
	M 351.95 211.2
	L 351.8 211.2 346.05 215.1 346.05 225.2 351.95 221.6 351.95 211.2
	M 351.2 211.2
	L 351.35 211.2 351.35 211.1 351.2 211.2 Z"/>
					</g>
					<g>
						<path id="Layer30_0_FILL" fill="#000000" fill-opacity="1" stroke="none" d="
	M 183.7 215.3
	L 183.7 215.6
	Q 187.25 231.75 212.25 234.35
	L 183.7 215.3 Z"/>
					</g>
					<g id="Layer29_0_FILL">
						<path fill="#000000" fill-opacity="0.4" stroke="none" d="
	M 305.1 216.85
	L 305.15 217.2
	Q 309.45 233.2 334.35 232.3
	L 305.1 216.85 Z"/>
					</g>
					<g id="Layer27_0_FILL">
						<path class="vegetation" fill="#78A950" stroke="none" d="
	M 177.45 231.65
	Q 175.75 235.35 181.8 239.35 185.5 235.7 185.15 231.3 182.8 230.65 181.45 234 179.45 231.3 177.45 231.65
	M 236.9 266.6
	Q 235.2 270.3 241.25 274.3 244.95 270.6 244.65 266.25 242.3 265.6 240.95 268.95 238.9 266.25 236.9 266.6
	M 254.7 277
	Q 253.05 280.7 259.1 284.75 262.75 281.05 262.45 276.65 260.1 276 258.75 279.35 256.7 276.65 254.7 277
	M 315.5 245.75
	Q 313.5 243.05 311.5 243.4 309.8 247.1 315.85 251.15 319.55 247.45 319.2 243.05 316.85 242.4 315.5 245.75
	M 295.35 232.65
	Q 293.7 236.35 299.75 240.4 303.45 236.7 303.1 232.3 300.75 231.65 299.4 235 297.4 232.3 295.35 232.65
	M 277.2 171.85
	Q 275.55 175.55 281.6 179.55 285.3 175.85 284.95 171.5 282.6 170.85 281.25 174.2 279.25 171.5 277.2 171.85 Z"/>
					</g>
					<g id="Layer26_0_FILL">
						<path class="treeWood" fill="#AE663D" stroke="none" d="
	M 175.1 177.55
	L 172.05 177.55 172.05 191.1 159.3 172.85
	Q 154.6 171.5 172.05 195.7
	L 172.05 212.5 175.1 212.5 175.1 177.55
	M 252.7 151.35
	L 249 151.35 249 176.9 252.7 176.9 252.7 151.35 Z"/>
					</g>
					<g id="Layer25_0_FILL">
						<path class="vegetation" fill="#77A951" stroke="none" d="
	M 192.55 179.55
	Q 200.95 173.5 200.95 165.1 200.95 156.4 192.55 150 184.15 144.3 172.05 144.3 160.3 144.3 151.9 150 143.15 156.4 143.15 165.1 143.15 173.5 151.9 179.55 160.3 185.95 172.05 185.95 184.15 185.95 192.55 179.55
	M 236.25 106.65
	Q 230.2 116.05 230.2 129.15 230.2 142.25 236.25 151.35 242.3 160.75 250.7 160.75 258.75 160.75 264.8 151.35 270.85 142.25 270.85 129.15 270.85 116.05 264.8 106.65 258.75 97.6 250.7 97.6 242.3 97.6 236.25 106.65 Z"/>
					</g>
					<g id="Layer24_0_FILL">
						<path class="vegetation" fill="#77A951" stroke="none" d="
	M 158.3 221.9
	Q 160.65 221.9 161.95 220.2 163 219.55 163.3 218.55 164.65 218.9 166.35 218.9 170.05 218.9 172.4 216.2 175.1 213.85 175.1 210.15 175.1 206.45 172.4 203.75 170.05 201.4 166.35 201.4 162.65 201.4 159.95 203.75 157.6 206.45 157.6 210.15 157.6 210.8 157.6 211.15 155.95 211.5 154.6 212.5 152.9 214.15 152.9 216.55 152.9 218.9 154.6 220.2 156.25 221.9 158.3 221.9
	M 338.35 240.05
	Q 341.05 237.7 341.05 234 341.05 230.3 338.35 227.6 336 225.25 332.3 225.25 328.65 225.25 325.95 227.6 323.6 230.3 323.6 234 323.6 237.7 325.95 240.05 328.65 242.75 332.3 242.75 336 242.75 338.35 240.05 Z"/>
					</g>
					<g id="Layer22_0_FILL">
						<path class="rightRoof" fill="#D05041" stroke="none" d="
	M 220 173.85
	L 236.8 186.7 264.35 171.15 244.5 159.55 220 173.85 Z"/>
					</g>
					<g id="Layer21_0_FILL">
						<path class="leftWall" fill="#C57F42" stroke="none" d="
	M 212.25 191.35
	L 183.35 172.3 183.7 215.3 212.25 234.35 212.25 191.35 Z"/>
					</g>
					<g id="Layer20_0_FILL">
						<path class="rightRoof" fill="#EF4427" stroke="none" d="
	M 192.1 149.85
	L 236.45 174.8 243.1 171.4
	Q 220.05 150.55 196.3 139.95
	L 192.1 149.85 Z"/>
					</g>
					<g id="Layer19_0_FILL">
						<path class="frontFascia" fill="#EBB17B" stroke="none" d="
	M 226.85 160.95
	L 212 190.6 229.75 192.6 239.75 172.85 226.85 160.95 Z"/>
					</g>
					<g id="Layer18_0_FILL">
						<path class="frontWall" fill="#EFA258" stroke="none" d="
	M 240.15 172.65
	L 211.9 191.6 212.25 233.65 264.35 201.7 264.35 170.8 240.8 184.45 240.15 172.65 Z"/>
					</g>
					<g id="Layer17_0_FILL">
						<path class="rightRoof" fill="#EF4427" stroke="none" d="
	M 210.9 142.2
	L 205.9 142.2 205.9 152.65 210.9 152.65 210.9 142.2 Z"/>
					</g>
					<g>
						<path id="Layer16_0_FILL" class="leftRoof" fill="#F2563B" stroke="none" d="
	M 210.25 195.5
	L 227.4 160.95 195.45 141.35 177.65 175.85 210.25 195.5 Z"/>
					</g>
					<g>
						<path id="sun" fill="#E3BD0E" stroke="none" d="
	M 257.05 15.95
	Q 251.7 15.95 248 19.65 244.3 23.35 244.3 28.7 244.3 34.1 248 37.8 251.7 41.5 257.05 41.5 262.45 41.5 266.15 37.8 269.85 34.1 269.85 28.7 269.85 23.35 266.15 19.65 262.45 15.95 257.05 15.95 Z"/>
					</g>
					<g id="Layer8_0_FILL">
						<path fill="#975A42" stroke="none" d="
	M 238.45 189.65
	Q 238.295703125 189.362109375 238.05 189.1 237.35 188.3 236.2 188.3 235.05 188.3 234.15 189.1 233.3 189.9 233.2 191.05 233.1 192.2 233.8 193 234.55 193.8 235.7 193.8 236.85 193.8 237.7 193 238.1970703125 192.558203125 238.45 192 238.6552734375 191.56484375 238.7 191.05 238.7671875 190.276953125 238.45 189.65
	M 220.55 197.55
	Q 220 197.55 219.5 197.75 218.95 197.95 218.5 198.35 217.933203125 198.8833984375 217.7 199.55 217.5833984375 199.916796875 217.55 200.3 217.4923828125 200.96171875 217.7 201.5 217.852734375 201.9103515625 218.15 202.25 218.95 203.05 220.1 203.05 221.25 203.05 222.05 202.25 222.95 201.45 223.05 200.3 223.15 199.15 222.4 198.35 222.05 197.95 221.65 197.75 221.15 197.55 220.55 197.55 Z"/>
					</g>
					<g id="Layer7_0_FILL">
						<path class="door" fill="#B65041" stroke="none" d="
	M 233.55 206.75
	L 225.9 211.95 226.25 225.5 233.95 220.35 233.55 206.75 Z"/>
					</g>
					<g>
						<path id="windowOne" class="windows" fill="#975A42" stroke="none" d="
	M 188.65 198.4
	L 188.8 204.1 198.65 210.45 198.55 204.75 188.65 198.4
	M 208.45 216.8
	L 208.35 211.1 198.55 204.75 198.65 210.45 208.45 216.8
	M 188.8 204.1
	L 188.95 209.8 198.8 216.15 198.65 210.45 188.8 204.1
	M 208.6 222.5
	L 208.45 216.8 198.65 210.45 198.8 216.15 208.6 222.5 Z"/>
					</g>
					<g>
						<path id="windowThree" class="windows" fill="#975A42" stroke="none" d="
	M 311.7 214.1
	L 318.55 217.55 318.45 211.9 311.6 208.45 311.7 214.1
	M 325.4 221
	L 325.25 215.35 318.45 211.9 318.55 217.55 325.4 221
	M 318.4 206.2
	L 311.5 202.75 311.6 208.45 318.45 211.9 318.4 206.2
	M 325.25 215.35
	L 325.2 209.7 318.4 206.2 318.45 211.9 325.25 215.35 Z"/>
					</g>
					<g id="Layer2_0_FILL">
						<path class="door" fill="#B65041" stroke="none" d="
	M 259.7 183.25
	L 244.6 191.9 244.6 213.8 259.7 204.55 259.7 183.25 Z"/>
					</g>
					<path id="windowTwo" fill="#975A42" class="windows" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" d="
	M 223.05 200.3
	Q 222.95 201.45 222.05 202.25 221.25 203.05 220.1 203.05 218.95 203.05 218.15 202.25 217.852734375 201.9103515625 217.7 201.5 217.4923828125 200.96171875 217.55 200.3 217.5833984375 199.916796875 217.7 199.575 217.933203125 198.8833984375 218.5 198.35 218.95 197.95 219.5 197.75 220 197.55 220.55 197.55 221.15 197.55 221.65 197.75 222.05 197.95 222.4 198.35 223.15 199.15 223.05 200.3 Z
	M 238.7 191.05
	Q 238.6552734375 191.56484375 238.45 192 238.1970703125 192.558203125 237.7 193 236.85 193.8 235.7 193.8 234.55 193.8 233.8 193 233.1 192.2 233.2 191.05 233.3 189.9 234.15 189.1 235.05 188.3 236.2 188.3 237.35 188.3 238.05 189.1 238.295703125 189.362109375 238.45 189.65 238.7671875 190.276953125 238.7 191.05 Z"/>
					<path fill="#F2563B" stroke="none" d=" M 351.95 211.2 L 351.8 211.2 346.05 215.1 346.05 225.2 351.95 221.6 351.95 211.2 Z"/>
					<path id="Layer6_0_1_STROKES" class="windowRims" stroke="#AE663D" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" fill="none" d="
	M 198.55 204.75
	L 208.35 211.1 208.45 216.8 208.6 222.5 198.8 216.15 188.95 209.8 188.8 204.1 188.65 198.4 198.55 204.75 198.65 210.45 208.45 216.8
	M 198.8 216.15
	L 198.65 210.45 188.8 204.1"/>
					<path id="Layer5_0_1_STROKES" class="windowRims" stroke="#AE663D" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" fill="none" d="
	M 325.25 215.35
	L 325.4 221 318.55 217.55 311.7 214.1 311.6 208.45 311.5 202.75 318.4 206.2 325.2 209.7 325.25 215.35 318.45 211.9 318.55 217.55
	M 318.4 206.2
	L 318.45 211.9 311.6 208.45"/>
				</defs>
				<g id="shadow">
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use xlink:href="#bottomShadow"/>
					</g>
				</g>
				<g transform="matrix( 1, 0, 0, 1, 0,0) ">
					<use xlink:href="#sun"/>
				</g>
				<g id="earth">
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer52_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer51_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer50_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer48_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer47_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer46_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer45_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer44_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer43_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer41_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer40_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer38_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer37_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer36_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer35_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer34_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#windowFour"/>
						<use class="element" xlink:href="#Layer32_0_1_STROKES"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer30_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer27_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer26_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer25_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer24_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer22_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer21_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer20_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer19_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer18_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer17_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer16_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer8_0_FILL"/>
						<use class="element" xlink:href="#windowTwo"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer7_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#windowOne"/>
						<use class="element" xlink:href="#Layer6_0_1_STROKES"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#windowThree"/>
						<use class="element" xlink:href="#Layer5_0_1_STROKES"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer2_0_FILL"/>
					</g>
				</g>
			</svg>
			<! -- End of SVG file -->
			<! -- Moon/Sun Toggle -->
			<div id="toggleButton" class="day-toggle">
				<div class="sun-icon"></div>
				<label class="switch">
            <input id="toggleCheckbox" type="checkbox">
            <div class="slider"></div>
        </label>
				<div class="cloud-icon"></div>
			</div>
			<! -- Moon/Sun Toggle -->
			<! -- End of Container -->
		</div>
			</div>
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Zero Days</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">人生如逆旅    我亦是行人</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/05/Babel-将-Generator-编译成了什么/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李斌">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/tx.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zero Days">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Babel 将 Generator 编译成了什么</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-05T21:36:19+08:00">
                2018-10-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本文就是简单介绍下 Generator 语法编译后的代码。</p>
<h2 id="Generator"><a href="#Generator" class="headerlink" title="Generator"></a>Generator</h2><pre><code>function* helloWorldGenerator() {
  yield&apos;hello&apos;;
  yield&apos;world&apos;;
  return&apos;ending&apos;;
}
</code></pre><p>我们打印下执行的结果：</p>
<pre><code>var hw = helloWorldGenerator();

console.log(hw.next()); // {value: &quot;hello&quot;, done: false}console.log(hw.next()); // {value: &quot;world&quot;, done: false}console.log(hw.next()); // {value: &quot;ending&quot;, done: true}console.log(hw.next()); // {value: undefined, done: true}
</code></pre><h2 id="Babel"><a href="#Babel" class="headerlink" title="Babel"></a>Babel</h2><p>具体的执行过程就不说了，我们直接在 Babel 官网的 <a href="https://babeljs.io/repl" target="_blank" rel="noopener">Try it out</a> 粘贴上述代码，然后查看代码被编译成了什么样子：</p>
<pre><code>/**
 * 我们就称呼这个版本为简单编译版本吧
 */var _marked = /*#__PURE__*/ regeneratorRuntime.mark(helloWorldGenerator);

functionhelloWorldGenerator() {
  return regeneratorRuntime.wrap(
    functionhelloWorldGenerator$(_context) {
      while (1) {
        switch ((_context.prev = _context.next)) {
          case0:
            _context.next = 2;
            return&quot;hello&quot;;

          case2:
            _context.next = 4;
            return&quot;world&quot;;

          case4:
            return _context.abrupt(&quot;return&quot;, &quot;ending&quot;);

          case5:
          case&quot;end&quot;:
            return _context.stop();
        }
      }
    },
    _marked,
    this
  );
}
</code></pre><p>猛一看，好像编译后的代码还蛮少的，但是细细一看，编译后的代码肯定是不能用的呀，<code>regeneratorRuntime</code> 是个什么鬼？哪里有声明呀？<code>mark</code> 和 <code>wrap</code> 方法又都做了什么？</p>
<p>难道就不能编译一个完整可用的代码吗？</p>
<h2 id="regenerator"><a href="#regenerator" class="headerlink" title="regenerator"></a>regenerator</h2><p>如果你想看到完整可用的代码，你可以使用 <a href="https://github.com/facebook/regenerator" target="_blank" rel="noopener">regenerator</a>，这是 facebook 下的一个工具，用于编译 ES6 的 generator 函数。</p>
<p>我们先安装一下 regenerator：</p>
<pre><code>npm install -g regenerator
</code></pre><p>然后新建一个 generator.js 文件，里面的代码就是文章最一开始的代码，我们执行命令：</p>
<pre><code>regenerator --include-runtime generator.js &gt; generator-es5.js
</code></pre><p>我们就可以在 generator-es5.js 文件看到编译后的完整可用的代码。</p>
<p>而这一编译就编译了 700 多行…… 编译后的代码可以查看 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Copyright (c) 2014-present, Facebook, Inc.</span><br><span class="line"> *</span><br><span class="line"> * This source code is licensed under the MIT license found in the</span><br><span class="line"> * LICENSE file in the root directory of this source tree.</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">!(function(global) &#123;</span><br><span class="line">  &quot;use strict&quot;;</span><br><span class="line"></span><br><span class="line">  var Op = Object.prototype;</span><br><span class="line">  var hasOwn = Op.hasOwnProperty;</span><br><span class="line">  var undefined; // More compressible than void 0.</span><br><span class="line">  var $Symbol = typeof Symbol === &quot;function&quot; ? Symbol : &#123;&#125;;</span><br><span class="line">  var iteratorSymbol = $Symbol.iterator || &quot;@@iterator&quot;;</span><br><span class="line">  var asyncIteratorSymbol = $Symbol.asyncIterator || &quot;@@asyncIterator&quot;;</span><br><span class="line">  var toStringTagSymbol = $Symbol.toStringTag || &quot;@@toStringTag&quot;;</span><br><span class="line"></span><br><span class="line">  var inModule = typeof module === &quot;object&quot;;</span><br><span class="line">  var runtime = global.regeneratorRuntime;</span><br><span class="line">  if (runtime) &#123;</span><br><span class="line">    if (inModule) &#123;</span><br><span class="line">      // If regeneratorRuntime is defined globally and we&apos;re in a module,</span><br><span class="line">      // make the exports object identical to regeneratorRuntime.</span><br><span class="line">      module.exports = runtime;</span><br><span class="line">    &#125;</span><br><span class="line">    // Don&apos;t bother evaluating the rest of this file if the runtime was</span><br><span class="line">    // already defined globally.</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // Define the runtime globally (as expected by generated code) as either</span><br><span class="line">  // module.exports (if we&apos;re in a module) or a new, empty object.</span><br><span class="line">  runtime = global.regeneratorRuntime = inModule ? module.exports : &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  function wrap(innerFn, outerFn, self, tryLocsList) &#123;</span><br><span class="line">    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.</span><br><span class="line">    var protoGenerator = outerFn &amp;&amp; outerFn.prototype instanceof Generator ? outerFn : Generator;</span><br><span class="line">    var generator = Object.create(protoGenerator.prototype);</span><br><span class="line">    var context = new Context(tryLocsList || []);</span><br><span class="line"></span><br><span class="line">    // The ._invoke method unifies the implementations of the .next,</span><br><span class="line">    // .throw, and .return methods.</span><br><span class="line">    generator._invoke = makeInvokeMethod(innerFn, self, context);</span><br><span class="line"></span><br><span class="line">    return generator;</span><br><span class="line">  &#125;</span><br><span class="line">  runtime.wrap = wrap;</span><br><span class="line"></span><br><span class="line">  // Try/catch helper to minimize deoptimizations. Returns a completion</span><br><span class="line">  // record like context.tryEntries[i].completion. This interface could</span><br><span class="line">  // have been (and was previously) designed to take a closure to be</span><br><span class="line">  // invoked without arguments, but in all the cases we care about we</span><br><span class="line">  // already have an existing method we want to call, so there&apos;s no need</span><br><span class="line">  // to create a new function object. We can even get away with assuming</span><br><span class="line">  // the method takes exactly one argument, since that happens to be true</span><br><span class="line">  // in every case, so we don&apos;t have to touch the arguments object. The</span><br><span class="line">  // only additional allocation required is the completion record, which</span><br><span class="line">  // has a stable shape and so hopefully should be cheap to allocate.</span><br><span class="line">  function tryCatch(fn, obj, arg) &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">      return &#123; type: &quot;normal&quot;, arg: fn.call(obj, arg) &#125;;</span><br><span class="line">    &#125; catch (err) &#123;</span><br><span class="line">      return &#123; type: &quot;throw&quot;, arg: err &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  var GenStateSuspendedStart = &quot;suspendedStart&quot;;</span><br><span class="line">  var GenStateSuspendedYield = &quot;suspendedYield&quot;;</span><br><span class="line">  var GenStateExecuting = &quot;executing&quot;;</span><br><span class="line">  var GenStateCompleted = &quot;completed&quot;;</span><br><span class="line"></span><br><span class="line">  // Returning this object from the innerFn has the same effect as</span><br><span class="line">  // breaking out of the dispatch switch statement.</span><br><span class="line">  var ContinueSentinel = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  // Dummy constructor functions that we use as the .constructor and</span><br><span class="line">  // .constructor.prototype properties for functions that return Generator</span><br><span class="line">  // objects. For full spec compliance, you may wish to configure your</span><br><span class="line">  // minifier not to mangle the names of these two functions.</span><br><span class="line">  function Generator() &#123;&#125;</span><br><span class="line">  function GeneratorFunction() &#123;&#125;</span><br><span class="line">  function GeneratorFunctionPrototype() &#123;&#125;</span><br><span class="line"></span><br><span class="line">  // This is a polyfill for %IteratorPrototype% for environments that</span><br><span class="line">  // don&apos;t natively support it.</span><br><span class="line">  var IteratorPrototype = &#123;&#125;;</span><br><span class="line">  IteratorPrototype[iteratorSymbol] = function () &#123;</span><br><span class="line">    return this;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  var getProto = Object.getPrototypeOf;</span><br><span class="line">  var NativeIteratorPrototype = getProto &amp;&amp; getProto(getProto(values([])));</span><br><span class="line">  if (NativeIteratorPrototype &amp;&amp;</span><br><span class="line">      NativeIteratorPrototype !== Op &amp;&amp;</span><br><span class="line">      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) &#123;</span><br><span class="line">    // This environment has a native %IteratorPrototype%; use it instead</span><br><span class="line">    // of the polyfill.</span><br><span class="line">    IteratorPrototype = NativeIteratorPrototype;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  var Gp = GeneratorFunctionPrototype.prototype =</span><br><span class="line">    Generator.prototype = Object.create(IteratorPrototype);</span><br><span class="line">  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;</span><br><span class="line">  GeneratorFunctionPrototype.constructor = GeneratorFunction;</span><br><span class="line">  GeneratorFunctionPrototype[toStringTagSymbol] =</span><br><span class="line">    GeneratorFunction.displayName = &quot;GeneratorFunction&quot;;</span><br><span class="line"></span><br><span class="line">  // Helper for defining the .next, .throw, and .return methods of the</span><br><span class="line">  // Iterator interface in terms of a single ._invoke method.</span><br><span class="line">  function defineIteratorMethods(prototype) &#123;</span><br><span class="line">    [&quot;next&quot;, &quot;throw&quot;, &quot;return&quot;].forEach(function(method) &#123;</span><br><span class="line">      prototype[method] = function(arg) &#123;</span><br><span class="line">        return this._invoke(method, arg);</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  runtime.isGeneratorFunction = function(genFun) &#123;</span><br><span class="line">    var ctor = typeof genFun === &quot;function&quot; &amp;&amp; genFun.constructor;</span><br><span class="line">    return ctor</span><br><span class="line">      ? ctor === GeneratorFunction ||</span><br><span class="line">        // For the native GeneratorFunction constructor, the best we can</span><br><span class="line">        // do is to check its .name property.</span><br><span class="line">        (ctor.displayName || ctor.name) === &quot;GeneratorFunction&quot;</span><br><span class="line">      : false;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  runtime.mark = function(genFun) &#123;</span><br><span class="line">    if (Object.setPrototypeOf) &#123;</span><br><span class="line">      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      genFun.__proto__ = GeneratorFunctionPrototype;</span><br><span class="line">      if (!(toStringTagSymbol in genFun)) &#123;</span><br><span class="line">        genFun[toStringTagSymbol] = &quot;GeneratorFunction&quot;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    genFun.prototype = Object.create(Gp);</span><br><span class="line">    return genFun;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  // Within the body of any async function, `await x` is transformed to</span><br><span class="line">  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test</span><br><span class="line">  // `hasOwn.call(value, &quot;__await&quot;)` to determine if the yielded value is</span><br><span class="line">  // meant to be awaited.</span><br><span class="line">  runtime.awrap = function(arg) &#123;</span><br><span class="line">    return &#123; __await: arg &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  function AsyncIterator(generator) &#123;</span><br><span class="line">    function invoke(method, arg, resolve, reject) &#123;</span><br><span class="line">      var record = tryCatch(generator[method], generator, arg);</span><br><span class="line">      if (record.type === &quot;throw&quot;) &#123;</span><br><span class="line">        reject(record.arg);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        var result = record.arg;</span><br><span class="line">        var value = result.value;</span><br><span class="line">        if (value &amp;&amp;</span><br><span class="line">            typeof value === &quot;object&quot; &amp;&amp;</span><br><span class="line">            hasOwn.call(value, &quot;__await&quot;)) &#123;</span><br><span class="line">          return Promise.resolve(value.__await).then(function(value) &#123;</span><br><span class="line">            invoke(&quot;next&quot;, value, resolve, reject);</span><br><span class="line">          &#125;, function(err) &#123;</span><br><span class="line">            invoke(&quot;throw&quot;, err, resolve, reject);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return Promise.resolve(value).then(function(unwrapped) &#123;</span><br><span class="line">          // When a yielded Promise is resolved, its final value becomes</span><br><span class="line">          // the .value of the Promise&lt;&#123;value,done&#125;&gt; result for the</span><br><span class="line">          // current iteration.</span><br><span class="line">          result.value = unwrapped;</span><br><span class="line">          resolve(result);</span><br><span class="line">        &#125;, function(error) &#123;</span><br><span class="line">          // If a rejected Promise was yielded, throw the rejection back</span><br><span class="line">          // into the async generator function so it can be handled there.</span><br><span class="line">          return invoke(&quot;throw&quot;, error, resolve, reject);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    var previousPromise;</span><br><span class="line"></span><br><span class="line">    function enqueue(method, arg) &#123;</span><br><span class="line">      function callInvokeWithMethodAndArg() &#123;</span><br><span class="line">        return new Promise(function(resolve, reject) &#123;</span><br><span class="line">          invoke(method, arg, resolve, reject);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      return previousPromise =</span><br><span class="line">        // If enqueue has been called before, then we want to wait until</span><br><span class="line">        // all previous Promises have been resolved before calling invoke,</span><br><span class="line">        // so that results are always delivered in the correct order. If</span><br><span class="line">        // enqueue has not been called before, then it is important to</span><br><span class="line">        // call invoke immediately, without waiting on a callback to fire,</span><br><span class="line">        // so that the async generator function has the opportunity to do</span><br><span class="line">        // any necessary setup in a predictable way. This predictability</span><br><span class="line">        // is why the Promise constructor synchronously invokes its</span><br><span class="line">        // executor callback, and why async functions synchronously</span><br><span class="line">        // execute code before the first await. Since we implement simple</span><br><span class="line">        // async functions in terms of async generators, it is especially</span><br><span class="line">        // important to get this right, even though it requires care.</span><br><span class="line">        previousPromise ? previousPromise.then(</span><br><span class="line">          callInvokeWithMethodAndArg,</span><br><span class="line">          // Avoid propagating failures to Promises returned by later</span><br><span class="line">          // invocations of the iterator.</span><br><span class="line">          callInvokeWithMethodAndArg</span><br><span class="line">        ) : callInvokeWithMethodAndArg();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Define the unified helper method that is used to implement .next,</span><br><span class="line">    // .throw, and .return (see defineIteratorMethods).</span><br><span class="line">    this._invoke = enqueue;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  defineIteratorMethods(AsyncIterator.prototype);</span><br><span class="line">  AsyncIterator.prototype[asyncIteratorSymbol] = function () &#123;</span><br><span class="line">    return this;</span><br><span class="line">  &#125;;</span><br><span class="line">  runtime.AsyncIterator = AsyncIterator;</span><br><span class="line"></span><br><span class="line">  // Note that simple async functions are implemented on top of</span><br><span class="line">  // AsyncIterator objects; they just return a Promise for the value of</span><br><span class="line">  // the final result produced by the iterator.</span><br><span class="line">  runtime.async = function(innerFn, outerFn, self, tryLocsList) &#123;</span><br><span class="line">    var iter = new AsyncIterator(</span><br><span class="line">      wrap(innerFn, outerFn, self, tryLocsList)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    return runtime.isGeneratorFunction(outerFn)</span><br><span class="line">      ? iter // If outerFn is a generator, return the full iterator.</span><br><span class="line">      : iter.next().then(function(result) &#123;</span><br><span class="line">          return result.done ? result.value : iter.next();</span><br><span class="line">        &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  function makeInvokeMethod(innerFn, self, context) &#123;</span><br><span class="line">    var state = GenStateSuspendedStart;</span><br><span class="line"></span><br><span class="line">    return function invoke(method, arg) &#123;</span><br><span class="line">      if (state === GenStateExecuting) &#123;</span><br><span class="line">        throw new Error(&quot;Generator is already running&quot;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (state === GenStateCompleted) &#123;</span><br><span class="line">        if (method === &quot;throw&quot;) &#123;</span><br><span class="line">          throw arg;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Be forgiving, per 25.3.3.3.3 of the spec:</span><br><span class="line">        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume</span><br><span class="line">        return doneResult();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      context.method = method;</span><br><span class="line">      context.arg = arg;</span><br><span class="line"></span><br><span class="line">      while (true) &#123;</span><br><span class="line">        var delegate = context.delegate;</span><br><span class="line">        if (delegate) &#123;</span><br><span class="line">          var delegateResult = maybeInvokeDelegate(delegate, context);</span><br><span class="line">          if (delegateResult) &#123;</span><br><span class="line">            if (delegateResult === ContinueSentinel) continue;</span><br><span class="line">            return delegateResult;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (context.method === &quot;next&quot;) &#123;</span><br><span class="line">          // Setting context._sent for legacy support of Babel&apos;s</span><br><span class="line">          // function.sent implementation.</span><br><span class="line">          context.sent = context._sent = context.arg;</span><br><span class="line"></span><br><span class="line">        &#125; else if (context.method === &quot;throw&quot;) &#123;</span><br><span class="line">          if (state === GenStateSuspendedStart) &#123;</span><br><span class="line">            state = GenStateCompleted;</span><br><span class="line">            throw context.arg;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          context.dispatchException(context.arg);</span><br><span class="line"></span><br><span class="line">        &#125; else if (context.method === &quot;return&quot;) &#123;</span><br><span class="line">          context.abrupt(&quot;return&quot;, context.arg);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        state = GenStateExecuting;</span><br><span class="line"></span><br><span class="line">        var record = tryCatch(innerFn, self, context);</span><br><span class="line">        if (record.type === &quot;normal&quot;) &#123;</span><br><span class="line">          // If an exception is thrown from innerFn, we leave state ===</span><br><span class="line">          // GenStateExecuting and loop back for another invocation.</span><br><span class="line">          state = context.done</span><br><span class="line">            ? GenStateCompleted</span><br><span class="line">            : GenStateSuspendedYield;</span><br><span class="line"></span><br><span class="line">          if (record.arg === ContinueSentinel) &#123;</span><br><span class="line">            continue;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          return &#123;</span><br><span class="line">            value: record.arg,</span><br><span class="line">            done: context.done</span><br><span class="line">          &#125;;</span><br><span class="line"></span><br><span class="line">        &#125; else if (record.type === &quot;throw&quot;) &#123;</span><br><span class="line">          state = GenStateCompleted;</span><br><span class="line">          // Dispatch the exception by looping back around to the</span><br><span class="line">          // context.dispatchException(context.arg) call above.</span><br><span class="line">          context.method = &quot;throw&quot;;</span><br><span class="line">          context.arg = record.arg;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // Call delegate.iterator[context.method](context.arg) and handle the</span><br><span class="line">  // result, either by returning a &#123; value, done &#125; result from the</span><br><span class="line">  // delegate iterator, or by modifying context.method and context.arg,</span><br><span class="line">  // setting context.delegate to null, and returning the ContinueSentinel.</span><br><span class="line">  function maybeInvokeDelegate(delegate, context) &#123;</span><br><span class="line">    var method = delegate.iterator[context.method];</span><br><span class="line">    if (method === undefined) &#123;</span><br><span class="line">      // A .throw or .return when the delegate iterator has no .throw</span><br><span class="line">      // method always terminates the yield* loop.</span><br><span class="line">      context.delegate = null;</span><br><span class="line"></span><br><span class="line">      if (context.method === &quot;throw&quot;) &#123;</span><br><span class="line">        if (delegate.iterator.return) &#123;</span><br><span class="line">          // If the delegate iterator has a return method, give it a</span><br><span class="line">          // chance to clean up.</span><br><span class="line">          context.method = &quot;return&quot;;</span><br><span class="line">          context.arg = undefined;</span><br><span class="line">          maybeInvokeDelegate(delegate, context);</span><br><span class="line"></span><br><span class="line">          if (context.method === &quot;throw&quot;) &#123;</span><br><span class="line">            // If maybeInvokeDelegate(context) changed context.method from</span><br><span class="line">            // &quot;return&quot; to &quot;throw&quot;, let that override the TypeError below.</span><br><span class="line">            return ContinueSentinel;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        context.method = &quot;throw&quot;;</span><br><span class="line">        context.arg = new TypeError(</span><br><span class="line">          &quot;The iterator does not provide a &apos;throw&apos; method&quot;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      return ContinueSentinel;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    var record = tryCatch(method, delegate.iterator, context.arg);</span><br><span class="line"></span><br><span class="line">    if (record.type === &quot;throw&quot;) &#123;</span><br><span class="line">      context.method = &quot;throw&quot;;</span><br><span class="line">      context.arg = record.arg;</span><br><span class="line">      context.delegate = null;</span><br><span class="line">      return ContinueSentinel;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    var info = record.arg;</span><br><span class="line"></span><br><span class="line">    if (! info) &#123;</span><br><span class="line">      context.method = &quot;throw&quot;;</span><br><span class="line">      context.arg = new TypeError(&quot;iterator result is not an object&quot;);</span><br><span class="line">      context.delegate = null;</span><br><span class="line">      return ContinueSentinel;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (info.done) &#123;</span><br><span class="line">      // Assign the result of the finished delegate to the temporary</span><br><span class="line">      // variable specified by delegate.resultName (see delegateYield).</span><br><span class="line">      context[delegate.resultName] = info.value;</span><br><span class="line"></span><br><span class="line">      // Resume execution at the desired location (see delegateYield).</span><br><span class="line">      context.next = delegate.nextLoc;</span><br><span class="line"></span><br><span class="line">      // If context.method was &quot;throw&quot; but the delegate handled the</span><br><span class="line">      // exception, let the outer generator proceed normally. If</span><br><span class="line">      // context.method was &quot;next&quot;, forget context.arg since it has been</span><br><span class="line">      // &quot;consumed&quot; by the delegate iterator. If context.method was</span><br><span class="line">      // &quot;return&quot;, allow the original .return call to continue in the</span><br><span class="line">      // outer generator.</span><br><span class="line">      if (context.method !== &quot;return&quot;) &#123;</span><br><span class="line">        context.method = &quot;next&quot;;</span><br><span class="line">        context.arg = undefined;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      // Re-yield the result returned by the delegate method.</span><br><span class="line">      return info;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // The delegate iterator is finished, so forget it and continue with</span><br><span class="line">    // the outer generator.</span><br><span class="line">    context.delegate = null;</span><br><span class="line">    return ContinueSentinel;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // Define Generator.prototype.&#123;next,throw,return&#125; in terms of the</span><br><span class="line">  // unified ._invoke helper method.</span><br><span class="line">  defineIteratorMethods(Gp);</span><br><span class="line"></span><br><span class="line">  Gp[toStringTagSymbol] = &quot;Generator&quot;;</span><br><span class="line"></span><br><span class="line">  // A Generator should always return itself as the iterator object when the</span><br><span class="line">  // @@iterator function is called on it. Some browsers&apos; implementations of the</span><br><span class="line">  // iterator prototype chain incorrectly implement this, causing the Generator</span><br><span class="line">  // object to not be returned from this call. This ensures that doesn&apos;t happen.</span><br><span class="line">  // See https://github.com/facebook/regenerator/issues/274 for more details.</span><br><span class="line">  Gp[iteratorSymbol] = function() &#123;</span><br><span class="line">    return this;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  Gp.toString = function() &#123;</span><br><span class="line">    return &quot;[object Generator]&quot;;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  function pushTryEntry(locs) &#123;</span><br><span class="line">    var entry = &#123; tryLoc: locs[0] &#125;;</span><br><span class="line"></span><br><span class="line">    if (1 in locs) &#123;</span><br><span class="line">      entry.catchLoc = locs[1];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (2 in locs) &#123;</span><br><span class="line">      entry.finallyLoc = locs[2];</span><br><span class="line">      entry.afterLoc = locs[3];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    this.tryEntries.push(entry);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function resetTryEntry(entry) &#123;</span><br><span class="line">    var record = entry.completion || &#123;&#125;;</span><br><span class="line">    record.type = &quot;normal&quot;;</span><br><span class="line">    delete record.arg;</span><br><span class="line">    entry.completion = record;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function Context(tryLocsList) &#123;</span><br><span class="line">    // The root entry object (effectively a try statement without a catch</span><br><span class="line">    // or a finally block) gives us a place to store values thrown from</span><br><span class="line">    // locations where there is no enclosing try statement.</span><br><span class="line">    this.tryEntries = [&#123; tryLoc: &quot;root&quot; &#125;];</span><br><span class="line">    tryLocsList.forEach(pushTryEntry, this);</span><br><span class="line">    this.reset(true);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  runtime.keys = function(object) &#123;</span><br><span class="line">    var keys = [];</span><br><span class="line">    for (var key in object) &#123;</span><br><span class="line">      keys.push(key);</span><br><span class="line">    &#125;</span><br><span class="line">    keys.reverse();</span><br><span class="line"></span><br><span class="line">    // Rather than returning an object with a next method, we keep</span><br><span class="line">    // things simple and return the next function itself.</span><br><span class="line">    return function next() &#123;</span><br><span class="line">      while (keys.length) &#123;</span><br><span class="line">        var key = keys.pop();</span><br><span class="line">        if (key in object) &#123;</span><br><span class="line">          next.value = key;</span><br><span class="line">          next.done = false;</span><br><span class="line">          return next;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // To avoid creating an additional object, we just hang the .value</span><br><span class="line">      // and .done properties off the next function object itself. This</span><br><span class="line">      // also ensures that the minifier will not anonymize the function.</span><br><span class="line">      next.done = true;</span><br><span class="line">      return next;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  function values(iterable) &#123;</span><br><span class="line">    if (iterable) &#123;</span><br><span class="line">      var iteratorMethod = iterable[iteratorSymbol];</span><br><span class="line">      if (iteratorMethod) &#123;</span><br><span class="line">        return iteratorMethod.call(iterable);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (typeof iterable.next === &quot;function&quot;) &#123;</span><br><span class="line">        return iterable;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (!isNaN(iterable.length)) &#123;</span><br><span class="line">        var i = -1, next = function next() &#123;</span><br><span class="line">          while (++i &lt; iterable.length) &#123;</span><br><span class="line">            if (hasOwn.call(iterable, i)) &#123;</span><br><span class="line">              next.value = iterable[i];</span><br><span class="line">              next.done = false;</span><br><span class="line">              return next;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          next.value = undefined;</span><br><span class="line">          next.done = true;</span><br><span class="line"></span><br><span class="line">          return next;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        return next.next = next;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Return an iterator with no values.</span><br><span class="line">    return &#123; next: doneResult &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  runtime.values = values;</span><br><span class="line"></span><br><span class="line">  function doneResult() &#123;</span><br><span class="line">    return &#123; value: undefined, done: true &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Context.prototype = &#123;</span><br><span class="line">    constructor: Context,</span><br><span class="line"></span><br><span class="line">    reset: function(skipTempReset) &#123;</span><br><span class="line">      this.prev = 0;</span><br><span class="line">      this.next = 0;</span><br><span class="line">      // Resetting context._sent for legacy support of Babel&apos;s</span><br><span class="line">      // function.sent implementation.</span><br><span class="line">      this.sent = this._sent = undefined;</span><br><span class="line">      this.done = false;</span><br><span class="line">      this.delegate = null;</span><br><span class="line"></span><br><span class="line">      this.method = &quot;next&quot;;</span><br><span class="line">      this.arg = undefined;</span><br><span class="line"></span><br><span class="line">      this.tryEntries.forEach(resetTryEntry);</span><br><span class="line"></span><br><span class="line">      if (!skipTempReset) &#123;</span><br><span class="line">        for (var name in this) &#123;</span><br><span class="line">          // Not sure about the optimal order of these conditions:</span><br><span class="line">          if (name.charAt(0) === &quot;t&quot; &amp;&amp;</span><br><span class="line">              hasOwn.call(this, name) &amp;&amp;</span><br><span class="line">              !isNaN(+name.slice(1))) &#123;</span><br><span class="line">            this[name] = undefined;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    stop: function() &#123;</span><br><span class="line">      this.done = true;</span><br><span class="line"></span><br><span class="line">      var rootEntry = this.tryEntries[0];</span><br><span class="line">      var rootRecord = rootEntry.completion;</span><br><span class="line">      if (rootRecord.type === &quot;throw&quot;) &#123;</span><br><span class="line">        throw rootRecord.arg;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      return this.rval;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    dispatchException: function(exception) &#123;</span><br><span class="line">      if (this.done) &#123;</span><br><span class="line">        throw exception;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      var context = this;</span><br><span class="line">      function handle(loc, caught) &#123;</span><br><span class="line">        record.type = &quot;throw&quot;;</span><br><span class="line">        record.arg = exception;</span><br><span class="line">        context.next = loc;</span><br><span class="line"></span><br><span class="line">        if (caught) &#123;</span><br><span class="line">          // If the dispatched exception was caught by a catch block,</span><br><span class="line">          // then let that catch block handle the exception normally.</span><br><span class="line">          context.method = &quot;next&quot;;</span><br><span class="line">          context.arg = undefined;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return !! caught;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      for (var i = this.tryEntries.length - 1; i &gt;= 0; --i) &#123;</span><br><span class="line">        var entry = this.tryEntries[i];</span><br><span class="line">        var record = entry.completion;</span><br><span class="line"></span><br><span class="line">        if (entry.tryLoc === &quot;root&quot;) &#123;</span><br><span class="line">          // Exception thrown outside of any try block that could handle</span><br><span class="line">          // it, so set the completion value of the entire function to</span><br><span class="line">          // throw the exception.</span><br><span class="line">          return handle(&quot;end&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (entry.tryLoc &lt;= this.prev) &#123;</span><br><span class="line">          var hasCatch = hasOwn.call(entry, &quot;catchLoc&quot;);</span><br><span class="line">          var hasFinally = hasOwn.call(entry, &quot;finallyLoc&quot;);</span><br><span class="line"></span><br><span class="line">          if (hasCatch &amp;&amp; hasFinally) &#123;</span><br><span class="line">            if (this.prev &lt; entry.catchLoc) &#123;</span><br><span class="line">              return handle(entry.catchLoc, true);</span><br><span class="line">            &#125; else if (this.prev &lt; entry.finallyLoc) &#123;</span><br><span class="line">              return handle(entry.finallyLoc);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">          &#125; else if (hasCatch) &#123;</span><br><span class="line">            if (this.prev &lt; entry.catchLoc) &#123;</span><br><span class="line">              return handle(entry.catchLoc, true);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">          &#125; else if (hasFinally) &#123;</span><br><span class="line">            if (this.prev &lt; entry.finallyLoc) &#123;</span><br><span class="line">              return handle(entry.finallyLoc);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">          &#125; else &#123;</span><br><span class="line">            throw new Error(&quot;try statement without catch or finally&quot;);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    abrupt: function(type, arg) &#123;</span><br><span class="line">      for (var i = this.tryEntries.length - 1; i &gt;= 0; --i) &#123;</span><br><span class="line">        var entry = this.tryEntries[i];</span><br><span class="line">        if (entry.tryLoc &lt;= this.prev &amp;&amp;</span><br><span class="line">            hasOwn.call(entry, &quot;finallyLoc&quot;) &amp;&amp;</span><br><span class="line">            this.prev &lt; entry.finallyLoc) &#123;</span><br><span class="line">          var finallyEntry = entry;</span><br><span class="line">          break;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (finallyEntry &amp;&amp;</span><br><span class="line">          (type === &quot;break&quot; ||</span><br><span class="line">           type === &quot;continue&quot;) &amp;&amp;</span><br><span class="line">          finallyEntry.tryLoc &lt;= arg &amp;&amp;</span><br><span class="line">          arg &lt;= finallyEntry.finallyLoc) &#123;</span><br><span class="line">        // Ignore the finally entry if control is not jumping to a</span><br><span class="line">        // location outside the try/catch block.</span><br><span class="line">        finallyEntry = null;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      var record = finallyEntry ? finallyEntry.completion : &#123;&#125;;</span><br><span class="line">      record.type = type;</span><br><span class="line">      record.arg = arg;</span><br><span class="line"></span><br><span class="line">      if (finallyEntry) &#123;</span><br><span class="line">        this.method = &quot;next&quot;;</span><br><span class="line">        this.next = finallyEntry.finallyLoc;</span><br><span class="line">        return ContinueSentinel;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      return this.complete(record);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    complete: function(record, afterLoc) &#123;</span><br><span class="line">      if (record.type === &quot;throw&quot;) &#123;</span><br><span class="line">        throw record.arg;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (record.type === &quot;break&quot; ||</span><br><span class="line">          record.type === &quot;continue&quot;) &#123;</span><br><span class="line">        this.next = record.arg;</span><br><span class="line">      &#125; else if (record.type === &quot;return&quot;) &#123;</span><br><span class="line">        this.rval = this.arg = record.arg;</span><br><span class="line">        this.method = &quot;return&quot;;</span><br><span class="line">        this.next = &quot;end&quot;;</span><br><span class="line">      &#125; else if (record.type === &quot;normal&quot; &amp;&amp; afterLoc) &#123;</span><br><span class="line">        this.next = afterLoc;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      return ContinueSentinel;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    finish: function(finallyLoc) &#123;</span><br><span class="line">      for (var i = this.tryEntries.length - 1; i &gt;= 0; --i) &#123;</span><br><span class="line">        var entry = this.tryEntries[i];</span><br><span class="line">        if (entry.finallyLoc === finallyLoc) &#123;</span><br><span class="line">          this.complete(entry.completion, entry.afterLoc);</span><br><span class="line">          resetTryEntry(entry);</span><br><span class="line">          return ContinueSentinel;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    &quot;catch&quot;: function(tryLoc) &#123;</span><br><span class="line">      for (var i = this.tryEntries.length - 1; i &gt;= 0; --i) &#123;</span><br><span class="line">        var entry = this.tryEntries[i];</span><br><span class="line">        if (entry.tryLoc === tryLoc) &#123;</span><br><span class="line">          var record = entry.completion;</span><br><span class="line">          if (record.type === &quot;throw&quot;) &#123;</span><br><span class="line">            var thrown = record.arg;</span><br><span class="line">            resetTryEntry(entry);</span><br><span class="line">          &#125;</span><br><span class="line">          return thrown;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // The context.catch method must only be called with a location</span><br><span class="line">      // argument that corresponds to a known catch block.</span><br><span class="line">      throw new Error(&quot;illegal catch attempt&quot;);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    delegateYield: function(iterable, resultName, nextLoc) &#123;</span><br><span class="line">      this.delegate = &#123;</span><br><span class="line">        iterator: values(iterable),</span><br><span class="line">        resultName: resultName,</span><br><span class="line">        nextLoc: nextLoc</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      if (this.method === &quot;next&quot;) &#123;</span><br><span class="line">        // Deliberately forget the last sent value so that we don&apos;t</span><br><span class="line">        // accidentally pass it on to the delegate.</span><br><span class="line">        this.arg = undefined;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      return ContinueSentinel;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)(</span><br><span class="line">  // In sloppy mode, unbound `this` refers to the global object, fallback to</span><br><span class="line">  // Function constructor if we&apos;re in global strict mode. That is sadly a form</span><br><span class="line">  // of indirect eval which violates Content Security Policy.</span><br><span class="line">  (function() &#123;</span><br><span class="line">    return this || (typeof self === &quot;object&quot; &amp;&amp; self);</span><br><span class="line">  &#125;)() || Function(&quot;return this&quot;)()</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">var _marked =</span><br><span class="line">/*#__PURE__*/</span><br><span class="line">regeneratorRuntime.mark(helloWorldGenerator);</span><br><span class="line"></span><br><span class="line">function helloWorldGenerator() &#123;</span><br><span class="line">  return regeneratorRuntime.wrap(function helloWorldGenerator$(_context) &#123;</span><br><span class="line">    while (1) &#123;</span><br><span class="line">      switch (_context.prev = _context.next) &#123;</span><br><span class="line">        case 0:</span><br><span class="line">          _context.next = 2;</span><br><span class="line">          return &apos;hello&apos;;</span><br><span class="line"></span><br><span class="line">        case 2:</span><br><span class="line">          _context.next = 4;</span><br><span class="line">          return &apos;world&apos;;</span><br><span class="line"></span><br><span class="line">        case 4:</span><br><span class="line">          return _context.abrupt(&quot;return&quot;, &apos;ending&apos;);</span><br><span class="line"></span><br><span class="line">        case 5:</span><br><span class="line">        case &quot;end&quot;:</span><br><span class="line">          return _context.stop();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, _marked, this);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var hw = helloWorldGenerator();</span><br><span class="line">console.log(hw.next()); // &#123;value: &quot;hello&quot;, done: false&#125;</span><br><span class="line"></span><br><span class="line">console.log(hw.next()); // &#123;value: &quot;world&quot;, done: false&#125;</span><br><span class="line"></span><br><span class="line">console.log(hw.next()); // &#123;value: &quot;ending&quot;, done: true&#125;</span><br><span class="line"></span><br><span class="line">console.log(hw.next()); // &#123;value: undefined, done: true&#125;</span><br></pre></td></tr></table></figure>
<p>总之编译后的代码还蛮复杂，我们可以从中抽离出大致的逻辑，至少让简单编译的那段代码能够跑起来。</p>
<h2 id="mark-函数"><a href="#mark-函数" class="headerlink" title="mark 函数"></a>mark 函数</h2><p>简单编译后的代码第一段是这样的：</p>
<pre><code>var _marked = /*#__PURE__*/ regeneratorRuntime.mark(helloWorldGenerator);
</code></pre><p>我们查看完整编译版本中 mark 函数的源码：</p>
<pre><code>runtime.mark = function(genFun) {
  genFun.__proto__ = GeneratorFunctionPrototype;
  genFun.prototype = Object.create(Gp);
  return genFun;
};
</code></pre><p>这其中又涉及了 GeneratorFunctionPrototype 和 Gp 变量，我们也查看下对应的代码：</p>
<pre><code>functionGenerator() {}
functionGeneratorFunction() {}
functionGeneratorFunctionPrototype() {}

...

var Gp = GeneratorFunctionPrototype.prototype =
  Generator.prototype = Object.create(IteratorPrototype);

GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;

GeneratorFunctionPrototype.constructor = GeneratorFunction;

GeneratorFunctionPrototype[toStringTagSymbol] =
  GeneratorFunction.displayName = &quot;GeneratorFunction&quot;;
</code></pre><p>这段代码构建了一堆看起来很复杂的关系链，其实这是参照着 <a href="https://link.juejin.im?target=https%3A%2F%2Fwww.ecma-international.org%2Fecma-262%2F6.0%2F%23sec-generatorfunction-constructor" target="_blank" rel="noopener">ES6 规范</a>构建的关系链:<br><img src="/2018/10/05/Babel-将-Generator-编译成了什么/166c52b4064a3c92.webp" alt="regenerator"><br>图中 <code>+@@toStringTag:s = &#39;Generator&#39;</code> 的就是 Gp，<code>+@@toStringTag:s = &#39;GeneratorFunction&#39;</code> 的就是 GeneratorFunctionPrototype。</p>
<p>构建关系链的目的在于判断关系的时候能够跟原生的保持一致，就比如：</p>
<pre><code>function* f() {}
var g = f();
console.log(g.__proto__ === f.prototype); // trueconsole.log(g.__proto__.__proto__ === f.__proto__.prototype); // true
</code></pre><p>为了简化起见，我们可以把 Gp 先设置为一个空对象，不过正如你在上图中看到的，next()、 throw()、return() 函数都是挂载在 Gp 对象上，实际上，在完整的编译代码中，确实有为 Gp 添加这三个函数的方法：</p>
<pre><code>// 117 行functiondefineIteratorMethods(prototype) {
  [&quot;next&quot;, &quot;throw&quot;, &quot;return&quot;].forEach(function(method) {
    prototype[method] = function(arg) {
      returnthis._invoke(method, arg);
    };
  });
}

// 406 行
defineIteratorMethods(Gp);
</code></pre><p>为了简单起见，我们将整个 mark 函数简化为：</p>
<pre><code>runtime.mark = function(genFun) {
  var generator = Object.create({
    next: function(arg) {
      returnthis._invoke(&apos;next&apos;, arg)
    }
  });
  genFun.prototype = generator;
  return genFun;
};
</code></pre><h2 id="wrap-函数"><a href="#wrap-函数" class="headerlink" title="wrap 函数"></a>wrap 函数</h2><p>除了设置关系链之外，mark 函数的返回值 genFun 还作为了 wrap 函数的第二个参数传入：</p>
<pre><code>functionhelloWorldGenerator() {
  return regeneratorRuntime.wrap(
    functionhelloWorldGenerator$(_context) {
      ...
    },
    _marked,
    this
  );
}
</code></pre><p>我们再看下 wrap 函数：</p>
<pre><code>functionwrap(innerFn, outerFn, self) {
  var generator = Object.create(outerFn.prototype);
  var context = new Context([]);
  generator._invoke = makeInvokeMethod(innerFn, self, context);

  return generator;
}
</code></pre><p>所以当执行 <code>var hw = helloWorldGenerator();</code> 的时候，其实执行的是 wrap 函数，wrap 函数返回了 generator，generator 是一个对象，原型是 <code>outerFn.prototype</code>, <code>outerFn.prototype</code> 其实就是 <code>genFun.prototype</code>， <code>genFun.prototype</code> 是一个空对象，原型上有 next() 方法。</p>
<p>所以当你执行 <code>hw.next()</code> 的时候，执行的其实是 hw 原型的原型上的 next 函数，next 函数执行的又是 hw 的 _invoke 函数：</p>
<pre><code>generator._invoke = makeInvokeMethod(innerFn, self, context);
</code></pre><p>innerFn 就是 wrap 包裹的那个函数，其实就是 helloWordGenerato$ 函数，呐，就是这个函数：</p>
<pre><code>functionhelloWorldGenerator$(_context) {
  while (1) {
    switch ((_context.prev = _context.next)) {
      case0:
        _context.next = 2;
        return&quot;hello&quot;;

      case2:
        _context.next = 4;
        return&quot;world&quot;;

      case4:
        return _context.abrupt(&quot;return&quot;, &quot;ending&quot;);

      case5:
      case&quot;end&quot;:
        return _context.stop();
    }
  }
}
</code></pre><p>而 context 你可以直接理解为这样一个全局对象：</p>
<pre><code>var ContinueSentinel = {};

var context = {
  done: false,
  method: &quot;next&quot;,
  next: 0,
  prev: 0,
  abrupt: function(type, arg) {
    var record = {};
    record.type = type;
    record.arg = arg;

    returnthis.complete(record);
  },
  complete: function(record, afterLoc) {
    if (record.type === &quot;return&quot;) {
      this.rval = this.arg = record.arg;
      this.method = &quot;return&quot;;
      this.next = &quot;end&quot;;
    }

    return ContinueSentinel;
  },
  stop: function() {
    this.done = true;
    returnthis.rval;
  }
};
</code></pre><p>每次 <code>hw.next</code> 的时候，就会修改 next 和 prev 属性的值，当在 generator 函数中 return 的时候会执行 abrupt，abrupt 中又会执行 complete，执行完 complete，因为 <code>this.next = end</code> 的缘故，再执行就会执行 stop 函数。</p>
<p>我们来看下 makeInvokeMethod 函数：</p>
<pre><code>var ContinueSentinel = {};

functionmakeInvokeMethod(innerFn, self, context) {
  var state = &apos;start&apos;;

  returnfunctioninvoke(method, arg) {

    if (state === &apos;completed&apos;) {
      return { value: undefined, done: true };
    }

    context.method = method;
    context.arg = arg;

    while (true) {

      state = &apos;executing&apos;;

      var record = {
        type: &apos;normal&apos;,
        arg: innerFn.call(self, context)
      };
      if (record.type === &quot;normal&quot;) {

        state = context.done
          ? &apos;completed&apos;
          : &apos;yield&apos;;

        if (record.arg === ContinueSentinel) {
          continue;
        }

        return {
          value: record.arg,
          done: context.done
        };

      }
    }
  };
}
</code></pre><p>基本的执行过程就不分析了，我们重点看第三次执行 <code>hw.next()</code> 的时候:</p>
<p>第三次执行 <code>hw.next()</code> 的时候，其实执行了</p>
<pre><code>this._invoke(&quot;next&quot;, undefined);
</code></pre><p>我们在 invoke 函数中构建了一个 record 对象：</p>
<pre><code>var record = {
  type: &quot;normal&quot;,
  arg: innerFn.call(self, context)
};
</code></pre><p>而在 <code>innerFn.call(self, context)</code> 中，因为 _context.next 为 4 的缘故，其实执行了:</p>
<pre><code>_context.abrupt(&quot;return&quot;, &apos;ending&apos;);
</code></pre><p>而在 abrupt 中，我们又构建了一个 record 对象：</p>
<pre><code>var record = {};
record.type = &apos;return&apos;;
record.arg = &apos;ending&apos;;
</code></pre><p>然后执行了 <code>this.complete(record)</code>，</p>
<p>在 complete 中，因为 <code>record.type === &quot;return&quot;</code></p>
<pre><code>this.rval = &apos;ending&apos;;
this.method = &quot;return&quot;;
this.next = &quot;end&quot;;
</code></pre><p>然后返回了全局对象 ContinueSentinel，其实就是一个全局空对象。</p>
<p>然后在 invoke 函数中，因为 <code>record.arg === ContinueSentinel</code> 的缘故，没有执行后面的 return 语句，就直接进入下一个循环。</p>
<p>于是又执行了一遍 <code>innerFn.call(self, context)</code>，此时 <code>_context.next</code> 为 end, 执行了 <code>_context.stop()</code>, 在 stop 函数中：</p>
<pre><code>this.done = true;
returnthis.rval; // this.rval 其实就是 `ending`
</code></pre><p>所以最终返回的值为:</p>
<pre><code>{
  value: &apos;ending&apos;,
  done: true
};
</code></pre><p>之后，我们再执行 hw.next() 的时候，因为 state 已经是 ‘completed’ 的缘故，直接就返回 <code>{ value: undefined, done: true}</code></p>
<h2 id="不完整但可用的源码"><a href="#不完整但可用的源码" class="headerlink" title="不完整但可用的源码"></a>不完整但可用的源码</h2><p>当然这个过程，看文字理解起来可能有些难度，不完整但可用的代码如下，你可以断点调试查看具体的过程：</p>
<pre><code>(function() {
  var ContinueSentinel = {};

  var mark = function(genFun) {
    var generator = Object.create({
      next: function(arg) {
        returnthis._invoke(&quot;next&quot;, arg);
      }
    });
    genFun.prototype = generator;
    return genFun;
  };

  functionwrap(innerFn, outerFn, self) {
    var generator = Object.create(outerFn.prototype);

    var context = {
      done: false,
      method: &quot;next&quot;,
      next: 0,
      prev: 0,
      abrupt: function(type, arg) {
        var record = {};
        record.type = type;
        record.arg = arg;

        returnthis.complete(record);
      },
      complete: function(record, afterLoc) {
        if (record.type === &quot;return&quot;) {
          this.rval = this.arg = record.arg;
          this.method = &quot;return&quot;;
          this.next = &quot;end&quot;;
        }

        return ContinueSentinel;
      },
      stop: function() {
        this.done = true;
        returnthis.rval;
      }
    };

    generator._invoke = makeInvokeMethod(innerFn, context);

    return generator;
  }

  functionmakeInvokeMethod(innerFn, context) {
    var state = &quot;start&quot;;

    returnfunctioninvoke(method, arg) {
      if (state === &quot;completed&quot;) {
        return { value: undefined, done: true };
      }

      context.method = method;
      context.arg = arg;

      while (true) {
        state = &quot;executing&quot;;

        var record = {
          type: &quot;normal&quot;,
          arg: innerFn.call(self, context)
        };

        if (record.type === &quot;normal&quot;) {
          state = context.done ? &quot;completed&quot; : &quot;yield&quot;;

          if (record.arg === ContinueSentinel) {
            continue;
          }

          return {
            value: record.arg,
            done: context.done
          };
        }
      }
    };
  }

  window.regeneratorRuntime = {};

  regeneratorRuntime.wrap = wrap;
  regeneratorRuntime.mark = mark;
})();

var _marked = regeneratorRuntime.mark(helloWorldGenerator);

functionhelloWorldGenerator() {
  return regeneratorRuntime.wrap(
    functionhelloWorldGenerator$(_context) {
      while (1) {
        switch ((_context.prev = _context.next)) {
          case0:
            _context.next = 2;
            return&quot;hello&quot;;

          case2:
            _context.next = 4;
            return&quot;world&quot;;

          case4:
            return _context.abrupt(&quot;return&quot;, &quot;ending&quot;);

          case5:
          case&quot;end&quot;:
            return _context.stop();
        }
      }
    },
    _marked,
    this
  );
}

var hw = helloWorldGenerator();

console.log(hw.next());
console.log(hw.next());
console.log(hw.next());
console.log(hw.next());
</code></pre>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Generator/" rel="tag"># Generator</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/10/04/简单理解async、await语法实现原理/" rel="next" title="简单理解async、await语法实现原理">
                <i class="fa fa-chevron-left"></i> 简单理解async、await语法实现原理
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/10/08/基于IntersectionObserver的图片懒加载实现/" rel="prev" title="基于IntersectionObserver的图片懒加载实现">
                基于IntersectionObserver的图片懒加载实现 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/tx.jpg" alt="李斌">
            
              <p class="site-author-name" itemprop="name">李斌</p>
              <p class="site-description motion-element" itemprop="description">人生如逆旅     我亦是行人</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">181</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">121</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/libin1991" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://juejin.im/user/57e737f6c4c971005f6bcd8d" target="_blank" title="juejin">
                      
                        <i class="fa fa-fw fa-spinner"></i>juejin</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Generator"><span class="nav-number">2.</span> <span class="nav-text">Generator</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Babel"><span class="nav-number">3.</span> <span class="nav-text">Babel</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#regenerator"><span class="nav-number">4.</span> <span class="nav-text">regenerator</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mark-函数"><span class="nav-number">5.</span> <span class="nav-text">mark 函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#wrap-函数"><span class="nav-number">6.</span> <span class="nav-text">wrap 函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#不完整但可用的源码"><span class="nav-number">7.</span> <span class="nav-text">不完整但可用的源码</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">李斌</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

  
  <!--
  	描述：点击红心
  -->
  <script type="text/javascript" src="/js/src/clicklove.js"></script>
  <!--
  	描述：复制代码
  -->
  <script type="text/javascript" src="/js/src/clipboard.min.js"></script>
  <script type="text/javascript" src="/js/src/clipboard-use.js"></script>
</body>
</html>


